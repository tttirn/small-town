!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()}(this,(function(){"use strict";!function(e){if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};p.prototype.append=function(e,t){e=h(e),t=d(t);var n=this.map[e];this.map[e]=n?n+","+t:t},p.prototype.delete=function(e){delete this.map[h(e)]},p.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},p.prototype.set=function(e,t){this.map[h(e)]=d(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),f(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),f(e)},n&&(p.prototype[Symbol.iterator]=p.prototype.entries);var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},v.call(w.prototype),v.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},T.error=function(){var e=new T(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];T.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new T(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=w,e.Response=T,e.fetch=function(e,t){return new Promise((function(n,i){var s=new w(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,r={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;n(new T(i,r))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&r&&(o.responseType="blob"),s.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),o.send(void 0===s._bodyInit?null:s._bodyInit)}))},e.fetch.polyfill=!0}function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function y(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function _(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(r&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&r&&a(e))this._bodyArrayBuffer=_(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=_(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=m(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function w(e,t){var n=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=function(e){var t=e.toUpperCase();return u.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function T(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){var t={exports:{}};return e(t,t.exports),t.exports}var n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")(),i=function(e){try{return!!e()}catch(e){return!0}},s=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),o={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,c={f:a&&!o.call({1:2},1)?function(e){var t=a(this,e);return!!t&&t.enumerable}:o},u=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},l={}.toString,h=function(e){return l.call(e).slice(8,-1)},d="".split,f=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==h(e)?d.call(e,""):Object(e)}:Object,p=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},g=function(e){return f(p(e))},m=function(e){return"object"==typeof e?null!==e:"function"==typeof e},y=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},_=function(e){return Object(p(e))},v={}.hasOwnProperty,w=Object.hasOwn||function(e,t){return v.call(_(e),t)},b=r.document,T=m(b)&&m(b.createElement),I=function(e){return T?b.createElement(e):{}},E=!s&&!i((function(){return 7!=Object.defineProperty(I("div"),"a",{get:function(){return 7}}).a})),S=Object.getOwnPropertyDescriptor,k={f:s?S:function(e,t){if(e=g(e),t=y(t,!0),E)try{return S(e,t)}catch(e){}if(w(e,t))return u(!c.f.call(e,t),e[t])}},C=function(e){if(!m(e))throw TypeError(String(e)+" is not an object");return e},R=Object.defineProperty,A={f:s?R:function(e,t,n){if(C(e),t=y(t,!0),C(n),E)try{return R(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},N=s?function(e,t,n){return A.f(e,t,u(1,n))}:function(e,t,n){return e[t]=n,e},P=function(e,t){try{N(r,e,t)}catch(n){r[e]=t}return t},x="__core-js_shared__",D=r[x]||P(x,{}),O=Function.toString;"function"!=typeof D.inspectSource&&(D.inspectSource=function(e){return O.call(e)});var M,L,F,U=D.inspectSource,q=r.WeakMap,j="function"==typeof q&&/native code/.test(U(q)),V=!1,B=t((function(e){(e.exports=function(e,t){return D[e]||(D[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.15.1",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})})),$=0,W=Math.random(),K=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++$+W).toString(36)},z=B("keys"),H=function(e){return z[e]||(z[e]=K(e))},G={},Q="Object already initialized",Y=r.WeakMap;if(j||D.state){var J=D.state||(D.state=new Y),X=J.get,Z=J.has,ee=J.set;M=function(e,t){if(Z.call(J,e))throw new TypeError(Q);return t.facade=e,ee.call(J,e,t),t},L=function(e){return X.call(J,e)||{}},F=function(e){return Z.call(J,e)}}else{var te=H("state");G[te]=!0,M=function(e,t){if(w(e,te))throw new TypeError(Q);return t.facade=e,N(e,te,t),t},L=function(e){return w(e,te)?e[te]:{}},F=function(e){return w(e,te)}}var ne,re={set:M,get:L,has:F,enforce:function(e){return F(e)?L(e):M(e,{})},getterFor:function(e){return function(t){var n;if(!m(t)||(n=L(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},ie=t((function(e){var t=re.get,n=re.enforce,i=String(String).split("String");(e.exports=function(e,t,s,o){var a,c=!!o&&!!o.unsafe,u=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof s&&("string"!=typeof t||w(s,"name")||N(s,"name",t),(a=n(s)).source||(a.source=i.join("string"==typeof t?t:""))),e!==r?(c?!l&&e[t]&&(u=!0):delete e[t],u?e[t]=s:N(e,t,s)):u?e[t]=s:P(t,s)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||U(this)}))})),se=r,oe=function(e){return"function"==typeof e?e:void 0},ae=function(e,t){return arguments.length<2?oe(se[e])||oe(r[e]):se[e]&&se[e][t]||r[e]&&r[e][t]},ce=Math.ceil,ue=Math.floor,le=function(e){return isNaN(e=+e)?0:(e>0?ue:ce)(e)},he=Math.min,de=function(e){return e>0?he(le(e),9007199254740991):0},fe=Math.max,pe=Math.min,ge=function(e){return function(t,n,r){var i,s=g(t),o=de(s.length),a=function(e,t){var n=le(e);return n<0?fe(n+t,0):pe(n,t)}(r,o);if(e&&n!=n){for(;o>a;)if((i=s[a++])!=i)return!0}else for(;o>a;a++)if((e||a in s)&&s[a]===n)return e||a||0;return!e&&-1}},me={includes:ge(!0),indexOf:ge(!1)}.indexOf,ye=function(e,t){var n,r=g(e),i=0,s=[];for(n in r)!w(G,n)&&w(r,n)&&s.push(n);for(;t.length>i;)w(r,n=t[i++])&&(~me(s,n)||s.push(n));return s},_e=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ve=_e.concat("length","prototype"),we={f:Object.getOwnPropertyNames||function(e){return ye(e,ve)}},be={f:Object.getOwnPropertySymbols},Te=ae("Reflect","ownKeys")||function(e){var t=we.f(C(e)),n=be.f;return n?t.concat(n(e)):t},Ie=function(e,t){for(var n=Te(t),r=A.f,i=k.f,s=0;s<n.length;s++){var o=n[s];w(e,o)||r(e,o,i(t,o))}},Ee=/#|\.prototype\./,Se=function(e,t){var n=Ce[ke(e)];return n==Ae||n!=Re&&("function"==typeof t?i(t):!!t)},ke=Se.normalize=function(e){return String(e).replace(Ee,".").toLowerCase()},Ce=Se.data={},Re=Se.NATIVE="N",Ae=Se.POLYFILL="P",Ne=Se,Pe=k.f,xe=function(e,t){var n,i,s,o,a,c=e.target,u=e.global,l=e.stat;if(n=u?r:l?r[c]||P(c,{}):(r[c]||{}).prototype)for(i in t){if(o=t[i],s=e.noTargetGet?(a=Pe(n,i))&&a.value:n[i],!Ne(u?i:c+(l?".":"#")+i,e.forced)&&void 0!==s){if(typeof o==typeof s)continue;Ie(o,s)}(e.sham||s&&s.sham)&&N(o,"sham",!0),ie(n,i,o,e)}},De=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Oe=H("IE_PROTO"),Me=Object.prototype,Le=De?Object.getPrototypeOf:function(e){return e=_(e),w(e,Oe)?e[Oe]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Me:null},Fe=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return C(n),function(e){if(!m(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),Ue=Object.keys||function(e){return ye(e,_e)},qe=s?Object.defineProperties:function(e,t){C(e);for(var n,r=Ue(t),i=r.length,s=0;i>s;)A.f(e,n=r[s++],t[n]);return e},je=ae("document","documentElement"),Ve=H("IE_PROTO"),Be=function(){},$e=function(e){return"<script>"+e+"</"+"script>"},We=function(){try{ne=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;We=ne?function(e){e.write($e("")),e.close();var t=e.parentWindow.Object;return e=null,t}(ne):((t=I("iframe")).style.display="none",je.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write($e("document.F=Object")),e.close(),e.F);for(var n=_e.length;n--;)delete We.prototype[_e[n]];return We()};G[Ve]=!0;var Ke,ze,He=Object.create||function(e,t){var n;return null!==e?(Be.prototype=C(e),n=new Be,Be.prototype=null,n[Ve]=e):n=We(),void 0===t?n:qe(n,t)},Ge=ae("navigator","userAgent")||"",Qe=r.process,Ye=Qe&&Qe.versions,Je=Ye&&Ye.v8;Je?ze=(Ke=Je.split("."))[0]<4?1:Ke[0]+Ke[1]:Ge&&(!(Ke=Ge.match(/Edge\/(\d+)/))||Ke[1]>=74)&&(Ke=Ge.match(/Chrome\/(\d+)/))&&(ze=Ke[1]);var Xe=ze&&+ze,Ze=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Xe&&Xe<41})),et=Ze&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,tt=B("wks"),nt=r.Symbol,rt=et?nt:nt&&nt.withoutSetter||K,it=function(e){return w(tt,e)&&(Ze||"string"==typeof tt[e])||(Ze&&w(nt,e)?tt[e]=nt[e]:tt[e]=rt("Symbol."+e)),tt[e]},st={},ot=it("iterator"),at=Array.prototype,ct=function(e){return void 0!==e&&(st.Array===e||at[ot]===e)},ut=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},lt=function(e,t,n){if(ut(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},ht={};ht[it("toStringTag")]="z";var dt="[object z]"===String(ht),ft=it("toStringTag"),pt="Arguments"==h(function(){return arguments}()),gt=dt?h:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),ft))?n:pt?h(t):"Object"==(r=h(t))&&"function"==typeof t.callee?"Arguments":r},mt=it("iterator"),yt=function(e){if(null!=e)return e[mt]||e["@@iterator"]||st[gt(e)]},_t=function(e){var t=e.return;if(void 0!==t)return C(t.call(e)).value},vt=function(e,t){this.stopped=e,this.result=t},wt=function(e,t,n){var r,i,s,o,a,c,u,l=n&&n.that,h=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),p=lt(t,l,1+h+f),g=function(e){return r&&_t(r),new vt(!0,e)},m=function(e){return h?(C(e),f?p(e[0],e[1],g):p(e[0],e[1])):f?p(e,g):p(e)};if(d)r=e;else{if("function"!=typeof(i=yt(e)))throw TypeError("Target is not iterable");if(ct(i)){for(s=0,o=de(e.length);o>s;s++)if((a=m(e[s]))&&a instanceof vt)return a;return new vt(!1)}r=i.call(e)}for(c=r.next;!(u=c.call(r)).done;){try{a=m(u.value)}catch(e){throw _t(r),e}if("object"==typeof a&&a&&a instanceof vt)return a}return new vt(!1)},bt=function(e,t){var n=this;if(!(n instanceof bt))return new bt(e,t);Fe&&(n=Fe(new Error(void 0),Le(n))),void 0!==t&&N(n,"message",String(t));var r=[];return wt(e,r.push,{that:r}),N(n,"errors",r),n};bt.prototype=He(Error.prototype,{constructor:u(5,bt),message:u(5,""),name:u(5,"AggregateError")}),xe({global:!0},{AggregateError:bt});var Tt=dt?{}.toString:function(){return"[object "+gt(this)+"]"};dt||ie(Object.prototype,"toString",Tt,{unsafe:!0});var It=r.Promise,Et=function(e,t,n){for(var r in t)ie(e,r,t[r],n);return e},St=A.f,kt=it("toStringTag"),Ct=function(e,t,n){e&&!w(e=n?e:e.prototype,kt)&&St(e,kt,{configurable:!0,value:t})},Rt=it("species"),At=function(e){var t=ae(e),n=A.f;s&&t&&!t[Rt]&&n(t,Rt,{configurable:!0,get:function(){return this}})},Nt=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Pt=it("iterator"),xt=!1;try{var Dt=0,Ot={next:function(){return{done:!!Dt++}},return:function(){xt=!0}};Ot[Pt]=function(){return this},Array.from(Ot,(function(){throw 2}))}catch(Nb){}var Mt,Lt,Ft,Ut=function(e,t){if(!t&&!xt)return!1;var n=!1;try{var r={};r[Pt]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},qt=it("species"),jt=function(e,t){var n,r=C(e).constructor;return void 0===r||null==(n=C(r)[qt])?t:ut(n)},Vt=/(?:iphone|ipod|ipad).*applewebkit/i.test(Ge),Bt="process"==h(r.process),$t=r.location,Wt=r.setImmediate,Kt=r.clearImmediate,zt=r.process,Ht=r.MessageChannel,Gt=r.Dispatch,Qt=0,Yt={},Jt="onreadystatechange",Xt=function(e){if(Yt.hasOwnProperty(e)){var t=Yt[e];delete Yt[e],t()}},Zt=function(e){return function(){Xt(e)}},en=function(e){Xt(e.data)},tn=function(e){r.postMessage(e+"",$t.protocol+"//"+$t.host)};Wt&&Kt||(Wt=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Yt[++Qt]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Mt(Qt),Qt},Kt=function(e){delete Yt[e]},Bt?Mt=function(e){zt.nextTick(Zt(e))}:Gt&&Gt.now?Mt=function(e){Gt.now(Zt(e))}:Ht&&!Vt?(Ft=(Lt=new Ht).port2,Lt.port1.onmessage=en,Mt=lt(Ft.postMessage,Ft,1)):r.addEventListener&&"function"==typeof postMessage&&!r.importScripts&&$t&&"file:"!==$t.protocol&&!i(tn)?(Mt=tn,r.addEventListener("message",en,!1)):Mt=Jt in I("script")?function(e){je.appendChild(I("script")).onreadystatechange=function(){je.removeChild(this),Xt(e)}}:function(e){setTimeout(Zt(e),0)});var nn,rn,sn,on,an,cn,un,ln,hn={set:Wt,clear:Kt},dn=/web0s(?!.*chrome)/i.test(Ge),fn=k.f,pn=hn.set,gn=r.MutationObserver||r.WebKitMutationObserver,mn=r.document,yn=r.process,_n=r.Promise,vn=fn(r,"queueMicrotask"),wn=vn&&vn.value;wn||(nn=function(){var e,t;for(Bt&&(e=yn.domain)&&e.exit();rn;){t=rn.fn,rn=rn.next;try{t()}catch(e){throw rn?on():sn=void 0,e}}sn=void 0,e&&e.enter()},Vt||Bt||dn||!gn||!mn?_n&&_n.resolve?((un=_n.resolve(void 0)).constructor=_n,ln=un.then,on=function(){ln.call(un,nn)}):on=Bt?function(){yn.nextTick(nn)}:function(){pn.call(r,nn)}:(an=!0,cn=mn.createTextNode(""),new gn(nn).observe(cn,{characterData:!0}),on=function(){cn.data=an=!an}));var bn,Tn,In,En,Sn=wn||function(e){var t={fn:e,next:void 0};sn&&(sn.next=t),rn||(rn=t,on()),sn=t},kn=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=ut(t),this.reject=ut(n)},Cn={f:function(e){return new kn(e)}},Rn=function(e,t){if(C(e),m(t)&&t.constructor===e)return t;var n=Cn.f(e);return(0,n.resolve)(t),n.promise},An=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Nn="object"==typeof window,Pn=hn.set,xn=it("species"),Dn="Promise",On=re.get,Mn=re.set,Ln=re.getterFor(Dn),Fn=It&&It.prototype,Un=It,qn=Fn,jn=r.TypeError,Vn=r.document,Bn=r.process,$n=Cn.f,Wn=$n,Kn=!!(Vn&&Vn.createEvent&&r.dispatchEvent),zn="function"==typeof PromiseRejectionEvent,Hn="unhandledrejection",Gn=!1,Qn=Ne(Dn,(function(){var e=U(Un)!==String(Un);if(!e&&66===Xe)return!0;if(Xe>=51&&/native code/.test(Un))return!1;var t=new Un((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(t.constructor={})[xn]=n,!(Gn=t.then((function(){}))instanceof n)||!e&&Nn&&!zn})),Yn=Qn||!Ut((function(e){Un.all(e).catch((function(){}))})),Jn=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},Xn=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;Sn((function(){for(var r=e.value,i=1==e.state,s=0;n.length>s;){var o,a,c,u=n[s++],l=i?u.ok:u.fail,h=u.resolve,d=u.reject,f=u.domain;try{l?(i||(2===e.rejection&&nr(e),e.rejection=1),!0===l?o=r:(f&&f.enter(),o=l(r),f&&(f.exit(),c=!0)),o===u.promise?d(jn("Promise-chain cycle")):(a=Jn(o))?a.call(o,h,d):h(o)):d(r)}catch(e){f&&!c&&f.exit(),d(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&er(e)}))}},Zn=function(e,t,n){var i,s;Kn?((i=Vn.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),r.dispatchEvent(i)):i={promise:t,reason:n},!zn&&(s=r["on"+e])?s(i):e===Hn&&function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},er=function(e){Pn.call(r,(function(){var t,n=e.facade,r=e.value;if(tr(e)&&(t=An((function(){Bt?Bn.emit("unhandledRejection",r,n):Zn(Hn,n,r)})),e.rejection=Bt||tr(e)?2:1,t.error))throw t.value}))},tr=function(e){return 1!==e.rejection&&!e.parent},nr=function(e){Pn.call(r,(function(){var t=e.facade;Bt?Bn.emit("rejectionHandled",t):Zn("rejectionhandled",t,e.value)}))},rr=function(e,t,n){return function(r){e(t,r,n)}},ir=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Xn(e,!0))},sr=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw jn("Promise can't be resolved itself");var r=Jn(t);r?Sn((function(){var n={done:!1};try{r.call(t,rr(sr,n,e),rr(ir,n,e))}catch(t){ir(n,t,e)}})):(e.value=t,e.state=1,Xn(e,!1))}catch(t){ir({done:!1},t,e)}}};if(Qn&&(qn=(Un=function(e){Nt(this,Un,Dn),ut(e),bn.call(this);var t=On(this);try{e(rr(sr,t),rr(ir,t))}catch(e){ir(t,e)}}).prototype,(bn=function(e){Mn(this,{type:Dn,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Et(qn,{then:function(e,t){var n=Ln(this),r=$n(jt(this,Un));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Bt?Bn.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&Xn(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Tn=function(){var e=new bn,t=On(e);this.promise=e,this.resolve=rr(sr,t),this.reject=rr(ir,t)},Cn.f=$n=function(e){return e===Un||e===In?new Tn(e):Wn(e)},"function"==typeof It&&Fn!==Object.prototype)){En=Fn.then,Gn||(ie(Fn,"then",(function(e,t){var n=this;return new Un((function(e,t){En.call(n,e,t)})).then(e,t)}),{unsafe:!0}),ie(Fn,"catch",qn.catch,{unsafe:!0}));try{delete Fn.constructor}catch(Nb){}Fe&&Fe(Fn,qn)}xe({global:!0,wrap:!0,forced:Qn},{Promise:Un}),Ct(Un,Dn,!1),At(Dn),In=ae(Dn),xe({target:Dn,stat:!0,forced:Qn},{reject:function(e){var t=$n(this);return t.reject.call(void 0,e),t.promise}}),xe({target:Dn,stat:!0,forced:Qn},{resolve:function(e){return Rn(this,e)}}),xe({target:Dn,stat:!0,forced:Yn},{all:function(e){var t=this,n=$n(t),r=n.resolve,i=n.reject,s=An((function(){var n=ut(t.resolve),s=[],o=0,a=1;wt(e,(function(e){var c=o++,u=!1;s.push(void 0),a++,n.call(t,e).then((function(e){u||(u=!0,s[c]=e,--a||r(s))}),i)})),--a||r(s)}));return s.error&&i(s.value),n.promise},race:function(e){var t=this,n=$n(t),r=n.reject,i=An((function(){var i=ut(t.resolve);wt(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}}),xe({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=Cn.f(t),r=n.resolve,i=n.reject,s=An((function(){var n=ut(t.resolve),i=[],s=0,o=1;wt(e,(function(e){var a=s++,c=!1;i.push(void 0),o++,n.call(t,e).then((function(e){c||(c=!0,i[a]={status:"fulfilled",value:e},--o||r(i))}),(function(e){c||(c=!0,i[a]={status:"rejected",reason:e},--o||r(i))}))})),--o||r(i)}));return s.error&&i(s.value),n.promise}});var or="No one promise resolved";xe({target:"Promise",stat:!0},{any:function(e){var t=this,n=Cn.f(t),r=n.resolve,i=n.reject,s=An((function(){var n=ut(t.resolve),s=[],o=0,a=1,c=!1;wt(e,(function(e){var u=o++,l=!1;s.push(void 0),a++,n.call(t,e).then((function(e){l||c||(c=!0,r(e))}),(function(e){l||c||(l=!0,s[u]=e,--a||i(new(ae("AggregateError"))(s,or)))}))})),--a||i(new(ae("AggregateError"))(s,or))}));return s.error&&i(s.value),n.promise}});var ar=!!It&&i((function(){It.prototype.finally.call({then:function(){}},(function(){}))}));if(xe({target:"Promise",proto:!0,real:!0,forced:ar},{finally:function(e){var t=jt(this,ae("Promise")),n="function"==typeof e;return this.then(n?function(n){return Rn(t,e()).then((function(){return n}))}:e,n?function(n){return Rn(t,e()).then((function(){throw n}))}:e)}}),"function"==typeof It){var cr=ae("Promise").prototype.finally;It.prototype.finally!==cr&&ie(It.prototype,"finally",cr,{unsafe:!0})}var ur,lr,hr,dr=function(e){return function(t,n){var r,i,s=String(p(t)),o=le(n),a=s.length;return o<0||o>=a?e?"":void 0:(r=s.charCodeAt(o))<55296||r>56319||o+1===a||(i=s.charCodeAt(o+1))<56320||i>57343?e?s.charAt(o):r:e?s.slice(o,o+2):i-56320+(r-55296<<10)+65536}},fr={codeAt:dr(!1),charAt:dr(!0)},pr=it("iterator"),gr=!1;[].keys&&("next"in(hr=[].keys())?(lr=Le(Le(hr)))!==Object.prototype&&(ur=lr):gr=!0),(null==ur||i((function(){var e={};return ur[pr].call(e)!==e})))&&(ur={}),w(ur,pr)||N(ur,pr,(function(){return this}));var mr={IteratorPrototype:ur,BUGGY_SAFARI_ITERATORS:gr},yr=mr.IteratorPrototype,_r=function(){return this},vr=mr.IteratorPrototype,wr=mr.BUGGY_SAFARI_ITERATORS,br=it("iterator"),Tr="keys",Ir="values",Er="entries",Sr=function(){return this},kr=function(e,t,n,r,i,s,o){!function(e,t,n){var r=t+" Iterator";e.prototype=He(yr,{next:u(1,n)}),Ct(e,r,!1),st[r]=_r}(n,t,r);var a,c,l,h=function(e){if(e===i&&m)return m;if(!wr&&e in p)return p[e];switch(e){case Tr:case Ir:case Er:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",f=!1,p=e.prototype,g=p[br]||p["@@iterator"]||i&&p[i],m=!wr&&g||h(i),y="Array"==t&&p.entries||g;if(y&&(a=Le(y.call(new e)),vr!==Object.prototype&&a.next&&(Le(a)!==vr&&(Fe?Fe(a,vr):"function"!=typeof a[br]&&N(a,br,Sr)),Ct(a,d,!0))),i==Ir&&g&&g.name!==Ir&&(f=!0,m=function(){return g.call(this)}),p[br]!==m&&N(p,br,m),st[t]=m,i)if(c={values:h(Ir),keys:s?m:h(Tr),entries:h(Er)},o)for(l in c)(wr||f||!(l in p))&&ie(p,l,c[l]);else xe({target:t,proto:!0,forced:wr||f},c);return c},Cr=fr.charAt,Rr="String Iterator",Ar=re.set,Nr=re.getterFor(Rr);kr(String,"String",(function(e){Ar(this,{type:Rr,string:String(e),index:0})}),(function(){var e,t=Nr(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=Cr(n,r),t.index+=e.length,{value:e,done:!1})}));var Pr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},xr=it("unscopables"),Dr=Array.prototype;null==Dr[xr]&&A.f(Dr,xr,{configurable:!0,value:He(null)});var Or=function(e){Dr[xr][e]=!0},Mr="Array Iterator",Lr=re.set,Fr=re.getterFor(Mr),Ur=kr(Array,"Array",(function(e,t){Lr(this,{type:Mr,target:g(e),index:0,kind:t})}),(function(){var e=Fr(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");st.Arguments=st.Array,Or("keys"),Or("values"),Or("entries");var qr=it("iterator"),jr=it("toStringTag"),Vr=Ur.values;for(var Br in Pr){var $r=r[Br],Wr=$r&&$r.prototype;if(Wr){if(Wr[qr]!==Vr)try{N(Wr,qr,Vr)}catch(Nb){Wr[qr]=Vr}if(Wr[jr]||N(Wr,jr,Br),Pr[Br])for(var Kr in Ur)if(Wr[Kr]!==Ur[Kr])try{N(Wr,Kr,Ur[Kr])}catch(Nb){Wr[Kr]=Ur[Kr]}}}se.Promise,xe({target:"Promise",stat:!0},{try:function(e){var t=Cn.f(this),n=An(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var zr=Array.isArray||function(e){return"Array"==h(e)},Hr=it("species"),Gr=function(e,t){var n;return zr(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!zr(n.prototype)?m(n)&&null===(n=n[Hr])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Qr=[].push,Yr=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,o=7==e,a=5==e||s;return function(c,u,l,h){for(var d,p,g=_(c),m=f(g),y=lt(u,l,3),v=de(m.length),w=0,b=h||Gr,T=t?b(c,v):n||o?b(c,0):void 0;v>w;w++)if((a||w in m)&&(p=y(d=m[w],w,g),e))if(t)T[w]=p;else if(p)switch(e){case 3:return!0;case 5:return d;case 6:return w;case 2:Qr.call(T,d)}else switch(e){case 4:return!1;case 7:Qr.call(T,d)}return s?-1:r||i?i:T}},Jr={forEach:Yr(0),map:Yr(1),filter:Yr(2),some:Yr(3),every:Yr(4),find:Yr(5),findIndex:Yr(6),filterOut:Yr(7)},Xr=Jr.find,Zr="find",ei=!0;Zr in[]&&Array(1).find((function(){ei=!1})),xe({target:"Array",proto:!0,forced:ei},{find:function(e){return Xr(this,e,arguments.length>1?arguments[1]:void 0)}}),Or(Zr);var ti=Function.call,ni=function(e,t,n){return lt(ti,r[e].prototype[t],n)};ni("Array","find");var ri=Jr.findIndex,ii="findIndex",si=!0;ii in[]&&Array(1).findIndex((function(){si=!1})),xe({target:"Array",proto:!0,forced:si},{findIndex:function(e){return ri(this,e,arguments.length>1?arguments[1]:void 0)}}),Or(ii),ni("Array","findIndex");var oi=function(e,t,n,r){try{return r?t(C(n)[0],n[1]):t(n)}catch(t){throw _t(e),t}},ai=function(e,t,n){var r=y(t);r in e?A.f(e,r,u(0,n)):e[r]=n},ci=!Ut((function(e){Array.from(e)}));xe({target:"Array",stat:!0,forced:ci},{from:function(e){var t,n,r,i,s,o,a=_(e),c="function"==typeof this?this:Array,u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,d=yt(a),f=0;if(h&&(l=lt(l,u>2?arguments[2]:void 0,2)),null==d||c==Array&&ct(d))for(n=new c(t=de(a.length));t>f;f++)o=h?l(a[f],f):a[f],ai(n,f,o);else for(s=(i=d.call(a)).next,n=new c;!(r=s.call(i)).done;f++)o=h?oi(i,l,[r.value,f],!0):r.value,ai(n,f,o);return n.length=f,n}}),se.Array.from;var ui=Jr.some,li=function(e,t){var n=[][e];return!!n&&i((function(){n.call(null,t||function(){throw 1},1)}))}("some");xe({target:"Array",proto:!0,forced:!li},{some:function(e){return ui(this,e,arguments.length>1?arguments[1]:void 0)}}),ni("Array","some");var hi,di="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,fi=A.f,pi=r.Int8Array,gi=pi&&pi.prototype,mi=r.Uint8ClampedArray,yi=mi&&mi.prototype,_i=pi&&Le(pi),vi=gi&&Le(gi),wi=Object.prototype,bi=(wi.isPrototypeOf,it("toStringTag")),Ti=K("TYPED_ARRAY_TAG"),Ii=di&&!!Fe&&"Opera"!==gt(r.opera),Ei={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Si={BigInt64Array:8,BigUint64Array:8},ki=function(e){if(!m(e))return!1;var t=gt(e);return w(Ei,t)||w(Si,t)};for(hi in Ei)r[hi]||(Ii=!1);if((!Ii||"function"!=typeof _i||_i===Function.prototype)&&(_i=function(){throw TypeError("Incorrect invocation")},Ii))for(hi in Ei)r[hi]&&Fe(r[hi],_i);if((!Ii||!vi||vi===wi)&&(vi=_i.prototype,Ii))for(hi in Ei)r[hi]&&Fe(r[hi].prototype,vi);if(Ii&&Le(yi)!==vi&&Fe(yi,vi),s&&!w(vi,bi))for(hi in!0,fi(vi,bi,{get:function(){return m(this)?this[Ti]:void 0}}),Ei)r[hi]&&N(r[hi],Ti,hi);var Ci=function(e){if(ki(e))return e;throw TypeError("Target is not a typed array")},Ri=function(e,t,n){if(s){if(n)for(var i in Ei){var o=r[i];if(o&&w(o.prototype,e))try{delete o.prototype[e]}catch(e){}}vi[e]&&!n||ie(vi,e,n?t:Ii&&gi[e]||t)}},Ai=it("iterator"),Ni=r.Uint8Array,Pi=Ur.values,xi=Ur.keys,Di=Ur.entries,Oi=Ci,Mi=Ri,Li=Ni&&Ni.prototype[Ai],Fi=!!Li&&("values"==Li.name||null==Li.name),Ui=function(){return Pi.call(Oi(this))};Mi("entries",(function(){return Di.call(Oi(this))})),Mi("keys",(function(){return xi.call(Oi(this))})),Mi("values",Ui,!Fi),Mi(Ai,Ui,!Fi);var qi=Object.assign,ji=Object.defineProperty,Vi=!qi||i((function(){if(s&&1!==qi({b:1},qi(ji({},"a",{enumerable:!0,get:function(){ji(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=qi({},e)[n]||Ue(qi({},t)).join("")!=r}))?function(e,t){for(var n=_(e),r=arguments.length,i=1,o=be.f,a=c.f;r>i;)for(var u,l=f(arguments[i++]),h=o?Ue(l).concat(o(l)):Ue(l),d=h.length,p=0;d>p;)u=h[p++],s&&!a.call(l,u)||(n[u]=l[u]);return n}:qi;xe({target:"Object",stat:!0,forced:Object.assign!==Vi},{assign:Vi}),se.Object.assign;var Bi=c.f,$i=function(e){return function(t){for(var n,r=g(t),i=Ue(r),o=i.length,a=0,c=[];o>a;)n=i[a++],s&&!Bi.call(r,n)||c.push(e?[n,r[n]]:r[n]);return c}},Wi={entries:$i(!0),values:$i(!1)},Ki=Wi.entries;xe({target:"Object",stat:!0},{entries:function(e){return Ki(e)}}),se.Object.entries;var zi=Wi.values;xe({target:"Object",stat:!0},{values:function(e){return zi(e)}}),se.Object.values;var Hi=it("match"),Gi=function(e){if(function(e){var t;return m(e)&&(void 0!==(t=e[Hi])?!!t:"RegExp"==h(e))}(e))throw TypeError("The method doesn't accept regular expressions");return e},Qi=it("match"),Yi=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Qi]=!1,"/./"[e](t)}catch(e){}}return!1};xe({target:"String",proto:!0,forced:!Yi("includes")},{includes:function(e){return!!~String(p(this)).indexOf(Gi(e),arguments.length>1?arguments[1]:void 0)}}),ni("String","includes");var Ji,Xi=k.f,Zi="".startsWith,es=Math.min,ts=Yi("startsWith"),ns=!(ts||(Ji=Xi(String.prototype,"startsWith"),!Ji||Ji.writable));xe({target:"String",proto:!0,forced:!ns&&!ts},{startsWith:function(e){var t=String(p(this));Gi(e);var n=de(es(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return Zi?Zi.call(t,r,n):t.slice(n,n+r.length)===r}}),ni("String","startsWith");xe({target:"String",proto:!0},{repeat:function(e){var t=String(p(this)),n="",r=le(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}}),ni("String","repeat");var rs=it("species"),is=it("isConcatSpreadable"),ss=9007199254740991,os="Maximum allowed index exceeded",as=Xe>=51||!i((function(){var e=[];return e[is]=!1,e.concat()[0]!==e})),cs=function(e){return Xe>=51||!i((function(){var t=[];return(t.constructor={})[rs]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}("concat"),us=function(e){if(!m(e))return!1;var t=e[is];return void 0!==t?!!t:zr(e)};xe({target:"Array",proto:!0,forced:!as||!cs},{concat:function(e){var t,n,r,i,s,o=_(this),a=Gr(o,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(us(s=-1===t?o:arguments[t])){if(c+(i=de(s.length))>ss)throw TypeError(os);for(n=0;n<i;n++,c++)n in s&&ai(a,c,s[n])}else{if(c>=ss)throw TypeError(os);ai(a,c++,s)}return a.length=c,a}});var ls=we.f,hs={}.toString,ds="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],fs={f:function(e){return ds&&"[object Window]"==hs.call(e)?function(e){try{return ls(e)}catch(e){return ds.slice()}}(e):ls(g(e))}},ps={f:it},gs=A.f,ms=function(e){var t=se.Symbol||(se.Symbol={});w(t,e)||gs(t,e,{value:ps.f(e)})},ys=Jr.forEach,_s=H("hidden"),vs="Symbol",ws=it("toPrimitive"),bs=re.set,Ts=re.getterFor(vs),Is=Object.prototype,Es=r.Symbol,Ss=ae("JSON","stringify"),ks=k.f,Cs=A.f,Rs=fs.f,As=c.f,Ns=B("symbols"),Ps=B("op-symbols"),xs=B("string-to-symbol-registry"),Ds=B("symbol-to-string-registry"),Os=B("wks"),Ms=r.QObject,Ls=!Ms||!Ms.prototype||!Ms.prototype.findChild,Fs=s&&i((function(){return 7!=He(Cs({},"a",{get:function(){return Cs(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=ks(Is,t);r&&delete Is[t],Cs(e,t,n),r&&e!==Is&&Cs(Is,t,r)}:Cs,Us=function(e,t){var n=Ns[e]=He(Es.prototype);return bs(n,{type:vs,tag:e,description:t}),s||(n.description=t),n},qs=et?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Es},js=function(e,t,n){e===Is&&js(Ps,t,n),C(e);var r=y(t,!0);return C(n),w(Ns,r)?(n.enumerable?(w(e,_s)&&e[_s][r]&&(e[_s][r]=!1),n=He(n,{enumerable:u(0,!1)})):(w(e,_s)||Cs(e,_s,u(1,{})),e[_s][r]=!0),Fs(e,r,n)):Cs(e,r,n)},Vs=function(e,t){C(e);var n=g(t),r=Ue(n).concat(Ks(n));return ys(r,(function(t){s&&!Bs.call(n,t)||js(e,t,n[t])})),e},Bs=function(e){var t=y(e,!0),n=As.call(this,t);return!(this===Is&&w(Ns,t)&&!w(Ps,t))&&(!(n||!w(this,t)||!w(Ns,t)||w(this,_s)&&this[_s][t])||n)},$s=function(e,t){var n=g(e),r=y(t,!0);if(n!==Is||!w(Ns,r)||w(Ps,r)){var i=ks(n,r);return!i||!w(Ns,r)||w(n,_s)&&n[_s][r]||(i.enumerable=!0),i}},Ws=function(e){var t=Rs(g(e)),n=[];return ys(t,(function(e){w(Ns,e)||w(G,e)||n.push(e)})),n},Ks=function(e){var t=e===Is,n=Rs(t?Ps:g(e)),r=[];return ys(n,(function(e){!w(Ns,e)||t&&!w(Is,e)||r.push(Ns[e])})),r};if(Ze||(ie((Es=function(){if(this instanceof Es)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=K(e),n=function(e){this===Is&&n.call(Ps,e),w(this,_s)&&w(this[_s],t)&&(this[_s][t]=!1),Fs(this,t,u(1,e))};return s&&Ls&&Fs(Is,t,{configurable:!0,set:n}),Us(t,e)}).prototype,"toString",(function(){return Ts(this).tag})),ie(Es,"withoutSetter",(function(e){return Us(K(e),e)})),c.f=Bs,A.f=js,k.f=$s,we.f=fs.f=Ws,be.f=Ks,ps.f=function(e){return Us(it(e),e)},s&&(Cs(Es.prototype,"description",{configurable:!0,get:function(){return Ts(this).description}}),ie(Is,"propertyIsEnumerable",Bs,{unsafe:!0}))),xe({global:!0,wrap:!0,forced:!Ze,sham:!Ze},{Symbol:Es}),ys(Ue(Os),(function(e){ms(e)})),xe({target:vs,stat:!0,forced:!Ze},{for:function(e){var t=String(e);if(w(xs,t))return xs[t];var n=Es(t);return xs[t]=n,Ds[n]=t,n},keyFor:function(e){if(!qs(e))throw TypeError(e+" is not a symbol");if(w(Ds,e))return Ds[e]},useSetter:function(){Ls=!0},useSimple:function(){Ls=!1}}),xe({target:"Object",stat:!0,forced:!Ze,sham:!s},{create:function(e,t){return void 0===t?He(e):Vs(He(e),t)},defineProperty:js,defineProperties:Vs,getOwnPropertyDescriptor:$s}),xe({target:"Object",stat:!0,forced:!Ze},{getOwnPropertyNames:Ws,getOwnPropertySymbols:Ks}),xe({target:"Object",stat:!0,forced:i((function(){be.f(1)}))},{getOwnPropertySymbols:function(e){return be.f(_(e))}}),Ss){var zs=!Ze||i((function(){var e=Es();return"[null]"!=Ss([e])||"{}"!=Ss({a:e})||"{}"!=Ss(Object(e))}));xe({target:"JSON",stat:!0,forced:zs},{stringify:function(e,t,n){for(var r,i=[e],s=1;arguments.length>s;)i.push(arguments[s++]);if(r=t,(m(t)||void 0!==e)&&!qs(e))return zr(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!qs(t))return t}),i[1]=t,Ss.apply(null,i)}})}Es.prototype[ws]||N(Es.prototype,ws,Es.prototype.valueOf),Ct(Es,vs),G[_s]=!0,ms("asyncIterator");var Hs=A.f,Gs=r.Symbol;if(s&&"function"==typeof Gs&&(!("description"in Gs.prototype)||void 0!==Gs().description)){var Qs={},Ys=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Ys?new Gs(e):void 0===e?Gs():Gs(e);return""===e&&(Qs[t]=!0),t};Ie(Ys,Gs);var Js=Ys.prototype=Gs.prototype;Js.constructor=Ys;var Xs=Js.toString,Zs="Symbol(test)"==String(Gs("test")),eo=/^Symbol\((.*)\)[^)]+$/;Hs(Js,"description",{configurable:!0,get:function(){var e=m(this)?this.valueOf():this,t=Xs.call(e);if(w(Qs,e))return"";var n=Zs?t.slice(7,-1):t.replace(eo,"$1");return""===n?void 0:n}}),xe({global:!0,forced:!0},{Symbol:Ys})}ms("hasInstance"),ms("isConcatSpreadable"),ms("iterator"),ms("match"),ms("matchAll"),ms("replace"),ms("search"),ms("species"),ms("split"),ms("toPrimitive"),ms("toStringTag"),ms("unscopables"),Ct(r.JSON,"JSON",!0),Ct(Math,"Math",!0),xe({global:!0},{Reflect:{}}),Ct(r.Reflect,"Reflect",!0),se.Symbol,ms("asyncDispose"),ms("dispose"),ms("matcher"),ms("metadata"),ms("observable"),ms("patternMatch"),ms("replaceAll"),ps.f("iterator");var to=!i((function(){return Object.isExtensible(Object.preventExtensions({}))})),no=t((function(e){var t=A.f,n=K("meta"),r=0,i=Object.isExtensible||function(){return!0},s=function(e){t(e,n,{value:{objectID:"O"+ ++r,weakData:{}}})},o=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!m(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!w(e,n)){if(!i(e))return"F";if(!t)return"E";s(e)}return e[n].objectID},getWeakData:function(e,t){if(!w(e,n)){if(!i(e))return!0;if(!t)return!1;s(e)}return e[n].weakData},onFreeze:function(e){return to&&o.REQUIRED&&i(e)&&!w(e,n)&&s(e),e}};G[n]=!0})),ro=function(e,t,n){var s=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=s?"set":"add",c=r[e],u=c&&c.prototype,l=c,h={},d=function(e){var t=u[e];ie(u,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!m(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!m(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!m(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(Ne(e,"function"!=typeof c||!(o||u.forEach&&!i((function(){(new c).entries().next()})))))l=n.getConstructor(t,e,s,a),no.REQUIRED=!0;else if(Ne(e,!0)){var f=new l,p=f[a](o?{}:-0,1)!=f,g=i((function(){f.has(1)})),y=Ut((function(e){new c(e)})),_=!o&&i((function(){for(var e=new c,t=5;t--;)e[a](t,t);return!e.has(-0)}));y||((l=t((function(t,n){Nt(t,l,e);var r=function(e,t,n){var r,i;return Fe&&"function"==typeof(r=t.constructor)&&r!==n&&m(i=r.prototype)&&i!==n.prototype&&Fe(e,i),e}(new c,t,l);return null!=n&&wt(n,r[a],{that:r,AS_ENTRIES:s}),r}))).prototype=u,u.constructor=l),(g||_)&&(d("delete"),d("has"),s&&d("get")),(_||p)&&d(a),o&&u.clear&&delete u.clear}return h[e]=l,xe({global:!0,forced:l!=c},h),Ct(l,e),o||n.setStrong(l,e,s),l},io=A.f,so=no.fastKey,oo=re.set,ao=re.getterFor,co={getConstructor:function(e,t,n,r){var i=e((function(e,o){Nt(e,i,t),oo(e,{type:t,index:He(null),first:void 0,last:void 0,size:0}),s||(e.size=0),null!=o&&wt(o,e[r],{that:e,AS_ENTRIES:n})})),o=ao(t),a=function(e,t,n){var r,i,a=o(e),u=c(e,t);return u?u.value=n:(a.last=u={index:i=so(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=u),r&&(r.next=u),s?a.size++:e.size++,"F"!==i&&(a.index[i]=u)),e},c=function(e,t){var n,r=o(e),i=so(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return Et(i.prototype,{clear:function(){for(var e=o(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,s?e.size=0:this.size=0},delete:function(e){var t=this,n=o(t),r=c(t,e);if(r){var i=r.next,a=r.previous;delete n.index[r.index],r.removed=!0,a&&(a.next=i),i&&(i.previous=a),n.first==r&&(n.first=i),n.last==r&&(n.last=a),s?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=o(this),r=lt(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),Et(i.prototype,n?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),s&&io(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",i=ao(t),s=ao(r);kr(e,t,(function(e,t){oo(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=s(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),At(t)}};ro("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),co),se.Map;var uo=function(e){var t,n,r,i,s=arguments.length,o=s>1?arguments[1]:void 0;return ut(this),(t=void 0!==o)&&ut(o),null==e?new this:(n=[],t?(r=0,i=lt(o,s>2?arguments[2]:void 0,2),wt(e,(function(e){n.push(i(e,r++))}))):wt(e,n.push,{that:n}),new this(n))};xe({target:"Map",stat:!0},{from:uo});var lo=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)};xe({target:"Map",stat:!0},{of:lo});var ho=function(){for(var e,t=C(this),n=ut(t.delete),r=!0,i=0,s=arguments.length;i<s;i++)e=n.call(t,arguments[i]),r=r&&e;return!!r};xe({target:"Map",proto:!0,real:!0,forced:V},{deleteAll:function(){return ho.apply(this,arguments)}});xe({target:"Map",proto:!0,real:!0,forced:V},{emplace:function(e,t){var n=C(this),r=n.has(e)&&"update"in t?t.update(n.get(e),e,n):t.insert(e,n);return n.set(e,r),r}});var fo=function(e){return Map.prototype.entries.call(e)};xe({target:"Map",proto:!0,real:!0,forced:V},{every:function(e){var t=C(this),n=fo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3);return!wt(n,(function(e,n,i){if(!r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xe({target:"Map",proto:!0,real:!0,forced:V},{filter:function(e){var t=C(this),n=fo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3),i=new(jt(t,ae("Map"))),s=ut(i.set);return wt(n,(function(e,n){r(n,e,t)&&s.call(i,e,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),xe({target:"Map",proto:!0,real:!0,forced:V},{find:function(e){var t=C(this),n=fo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3);return wt(n,(function(e,n,i){if(r(n,e,t))return i(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xe({target:"Map",proto:!0,real:!0,forced:V},{findKey:function(e){var t=C(this),n=fo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3);return wt(n,(function(e,n,i){if(r(n,e,t))return i(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xe({target:"Map",stat:!0},{groupBy:function(e,t){var n=new this;ut(t);var r=ut(n.has),i=ut(n.get),s=ut(n.set);return wt(e,(function(e){var o=t(e);r.call(n,o)?i.call(n,o).push(e):s.call(n,o,[e])})),n}});xe({target:"Map",proto:!0,real:!0,forced:V},{includes:function(e){return wt(fo(C(this)),(function(t,n,r){if(function(e,t){return e===t||e!=e&&t!=t}(n,e))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xe({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;ut(t);var r=ut(n.set);return wt(e,(function(e){r.call(n,t(e),e)})),n}}),xe({target:"Map",proto:!0,real:!0,forced:V},{keyOf:function(e){return wt(fo(C(this)),(function(t,n,r){if(n===e)return r(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xe({target:"Map",proto:!0,real:!0,forced:V},{mapKeys:function(e){var t=C(this),n=fo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3),i=new(jt(t,ae("Map"))),s=ut(i.set);return wt(n,(function(e,n){s.call(i,r(n,e,t),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),xe({target:"Map",proto:!0,real:!0,forced:V},{mapValues:function(e){var t=C(this),n=fo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3),i=new(jt(t,ae("Map"))),s=ut(i.set);return wt(n,(function(e,n){s.call(i,e,r(n,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),xe({target:"Map",proto:!0,real:!0,forced:V},{merge:function(e){for(var t=C(this),n=ut(t.set),r=0;r<arguments.length;)wt(arguments[r++],n,{that:t,AS_ENTRIES:!0});return t}}),xe({target:"Map",proto:!0,real:!0,forced:V},{reduce:function(e){var t=C(this),n=fo(t),r=arguments.length<2,i=r?void 0:arguments[1];if(ut(e),wt(n,(function(n,s){r?(r=!1,i=s):i=e(i,s,n,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty map with no initial value");return i}}),xe({target:"Map",proto:!0,real:!0,forced:V},{some:function(e){var t=C(this),n=fo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3);return wt(n,(function(e,n,i){if(r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xe({target:"Map",proto:!0,real:!0,forced:V},{update:function(e,t){var n=C(this),r=arguments.length;ut(t);var i=n.has(e);if(!i&&r<3)throw TypeError("Updating absent value");var s=i?n.get(e):ut(r>2?arguments[2]:void 0)(e,n);return n.set(e,t(s,e,n)),n}});var po=function(e,t){var n,r=C(this),i=arguments.length>2?arguments[2]:void 0;if("function"!=typeof t&&"function"!=typeof i)throw TypeError("At least one callback required");return r.has(e)?(n=r.get(e),"function"==typeof t&&(n=t(n),r.set(e,n))):"function"==typeof i&&(n=i(),r.set(e,n)),n};xe({target:"Map",proto:!0,real:!0,forced:V},{upsert:po}),xe({target:"Map",proto:!0,real:!0,forced:V},{updateOrInsert:po}),ro("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),co),se.Set,xe({target:"Set",stat:!0},{from:uo}),xe({target:"Set",stat:!0},{of:lo});var go=function(){for(var e=C(this),t=ut(e.add),n=0,r=arguments.length;n<r;n++)t.call(e,arguments[n]);return e};xe({target:"Set",proto:!0,real:!0,forced:V},{addAll:function(){return go.apply(this,arguments)}}),xe({target:"Set",proto:!0,real:!0,forced:V},{deleteAll:function(){return ho.apply(this,arguments)}});var mo=function(e){return Set.prototype.values.call(e)};xe({target:"Set",proto:!0,real:!0,forced:V},{every:function(e){var t=C(this),n=mo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3);return!wt(n,(function(e,n){if(!r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xe({target:"Set",proto:!0,real:!0,forced:V},{difference:function(e){var t=C(this),n=new(jt(t,ae("Set")))(t),r=ut(n.delete);return wt(e,(function(e){r.call(n,e)})),n}}),xe({target:"Set",proto:!0,real:!0,forced:V},{filter:function(e){var t=C(this),n=mo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3),i=new(jt(t,ae("Set"))),s=ut(i.add);return wt(n,(function(e){r(e,e,t)&&s.call(i,e)}),{IS_ITERATOR:!0}),i}}),xe({target:"Set",proto:!0,real:!0,forced:V},{find:function(e){var t=C(this),n=mo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3);return wt(n,(function(e,n){if(r(e,e,t))return n(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xe({target:"Set",proto:!0,real:!0,forced:V},{intersection:function(e){var t=C(this),n=new(jt(t,ae("Set"))),r=ut(t.has),i=ut(n.add);return wt(e,(function(e){r.call(t,e)&&i.call(n,e)})),n}}),xe({target:"Set",proto:!0,real:!0,forced:V},{isDisjointFrom:function(e){var t=C(this),n=ut(t.has);return!wt(e,(function(e,r){if(!0===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}}),xe({target:"Set",proto:!0,real:!0,forced:V},{isSubsetOf:function(e){var t=function(e){var t=yt(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return C(t.call(e))}(this),n=C(e),r=n.has;return"function"!=typeof r&&(n=new(ae("Set"))(e),r=ut(n.has)),!wt(t,(function(e,t){if(!1===r.call(n,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xe({target:"Set",proto:!0,real:!0,forced:V},{isSupersetOf:function(e){var t=C(this),n=ut(t.has);return!wt(e,(function(e,r){if(!1===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}}),xe({target:"Set",proto:!0,real:!0,forced:V},{join:function(e){var t=C(this),n=mo(t),r=void 0===e?",":String(e),i=[];return wt(n,i.push,{that:i,IS_ITERATOR:!0}),i.join(r)}}),xe({target:"Set",proto:!0,real:!0,forced:V},{map:function(e){var t=C(this),n=mo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3),i=new(jt(t,ae("Set"))),s=ut(i.add);return wt(n,(function(e){s.call(i,r(e,e,t))}),{IS_ITERATOR:!0}),i}}),xe({target:"Set",proto:!0,real:!0,forced:V},{reduce:function(e){var t=C(this),n=mo(t),r=arguments.length<2,i=r?void 0:arguments[1];if(ut(e),wt(n,(function(n){r?(r=!1,i=n):i=e(i,n,n,t)}),{IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty set with no initial value");return i}}),xe({target:"Set",proto:!0,real:!0,forced:V},{some:function(e){var t=C(this),n=mo(t),r=lt(e,arguments.length>1?arguments[1]:void 0,3);return wt(n,(function(e,n){if(r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xe({target:"Set",proto:!0,real:!0,forced:V},{symmetricDifference:function(e){var t=C(this),n=new(jt(t,ae("Set")))(t),r=ut(n.delete),i=ut(n.add);return wt(e,(function(e){r.call(n,e)||i.call(n,e)})),n}}),xe({target:"Set",proto:!0,real:!0,forced:V},{union:function(e){var t=C(this),n=new(jt(t,ae("Set")))(t);return wt(e,ut(n.add),{that:n}),n}});var yo=Math.floor;xe({target:"Number",stat:!0},{isInteger:function(e){return!m(e)&&isFinite(e)&&yo(e)===e}}),se.Number.isInteger,xe({target:"Number",stat:!0},{isNaN:function(e){return e!=e}}),se.Number.isNaN;
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var _o=function(e,t){return(_o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var vo=function(){return(vo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function wo(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function bo(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function To(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function Io(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Eo(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function So(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ko=!1,Co="${JSCORE_VERSION}",Ro=function(e,t){if(!e)throw Ao(t)},Ao=function(e){return new Error("Firebase Database ("+Co+") INTERNAL ASSERT FAILED: "+e)},No=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Po={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var s=e[i],o=i+1<e.length,a=o?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,l=s>>2,h=(3&s)<<4|a>>4,d=(15&a)<<2|u>>6,f=63&u;c||(f=64,o||(d=64)),r.push(n[l],n[h],n[d],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(No(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(s=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{s=e[n++];var a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var s=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,c=++i<e.length?n[e.charAt(i)]:64;if(++i,null==s||null==o||null==a||null==c)throw Error();var u=s<<2|o>>4;if(r.push(u),64!==a){var l=o<<4&240|a>>2;if(r.push(l),64!==c){var h=a<<6&192|c;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},xo=function(e){var t=No(e);return Po.encodeByteArray(t,!0)},Do=function(e){try{return Po.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Oo(e){return Mo(void 0,e)}function Mo(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Mo(e[n],t[n]));return e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var Lo=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Fo(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=vo({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Po.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Po.encodeString(JSON.stringify(s),!1),""].join(".")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Uo(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function qo(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Uo())}function jo(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function Vo(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function Bo(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function $o(){var e=Uo();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Wo(){return!0===ko}function Ko(){return"indexedDB"in self&&null!=indexedDB}function zo(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function Ho(){return!(!navigator||!navigator.cookieEnabled)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var Go=function(e){function t(n,r,i){var s=e.call(this,r)||this;return s.code=n,s.customData=i,s.name="FirebaseError",Object.setPrototypeOf(s,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,Qo.prototype.create),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}_o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error),Qo=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,s=this.errors[e],o=s?Yo(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").",c=new Go(i,a,r);return c},e}();function Yo(e,t){return e.replace(Jo,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var Jo=/\{\$([^}]+)}/g;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Xo(e){return JSON.parse(e)}function Zo(e){return JSON.stringify(e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ea=function(e){var t={},n={},r={},i="";try{var s=e.split(".");t=Xo(Do(s[0])||""),n=Xo(Do(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},ta=function(e){var t=ea(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},na=function(e){var t=ea(e).claims;return"object"==typeof t&&!0===t.admin};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function ra(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ia(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function sa(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function oa(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function aa(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var s=i[r];n(s[0],s[1])}return t.length?"&"+t.join("&"):""}function ca(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("="),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function ua(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var la=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var s,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(s=l^c&(u^l),o=1518500249):(s=c^u^l,o=1859775393):r<60?(s=c&u|l&(c|u),o=2400959708):(s=c^u^l,o=3395469782);i=(a<<5|a>>>27)+s+h+o+n[r]&4294967295;h=l,l=u,u=4294967295&(c<<30|c>>>2),c=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,s=this.inbuf_;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++r,++s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++r,++s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function ha(e,t){var n=new da(e,t);return n.subscribe.bind(n)}var da=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=fa),void 0===r.error&&(r.error=fa),void 0===r.complete&&(r.complete=fa);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),s},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function fa(){}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var pa=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function ga(e,t){return e+" failed: "+t+" argument "}function ma(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(ga(e,t)+"must be a valid function.")}function ya(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(ga(e,t)+"must be a valid context object.")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var _a=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;r++,Ro(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},va=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function wa(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=2);var r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ba(e){return e&&e._delegate?e._delegate:e}var Ta=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),Ia="[DEFAULT]",Ea=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Lo;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e))try{this.getOrInitializeService({instanceIdentifier:Ia})}catch(e){}try{for(var r=Io(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var s=Eo(i.value,2),o=s[0],a=s[1],c=this.normalizeInstanceIdentifier(o);try{var u=this.getOrInitializeService({instanceIdentifier:c});a.resolve(u)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=Ia),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return bo(this,void 0,void 0,(function(){var e;return To(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(So(So([],Eo(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),Eo(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=Ia),this.instances.has(e)},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.options,i=void 0===r?{}:r,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var o=this.getOrInitializeService({instanceIdentifier:s,options:i});try{for(var a=Io(this.instancesDeferred.entries()),c=a.next();!c.done;c=a.next()){var u=Eo(c.value,2),l=u[0],h=u[1];s===this.normalizeInstanceIdentifier(l)&&h.resolve(o)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var s=Io(i),o=s.next();!o.done;o=s.next()){var a=o.value;try{a(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Ia?void 0:t),options:i}),this.instances.set(n,s),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=Ia),this.component?this.component.multipleInstances?e:Ia:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Sa,ka,Ca=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Ea(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}(),Ra=[];
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ka||(ka={}));var Aa={debug:ka.DEBUG,verbose:ka.VERBOSE,info:ka.INFO,warn:ka.WARN,error:ka.ERROR,silent:ka.SILENT},Na=ka.INFO,Pa=((Sa={})[ka.DEBUG]="log",Sa[ka.VERBOSE]="log",Sa[ka.INFO]="info",Sa[ka.WARN]="warn",Sa[ka.ERROR]="error",Sa),xa=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),s=Pa[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[s].apply(console,So(["["+i+"]  "+e.name+":"],n))}},Da=function(){function e(e){this.name=e,this._logLevel=Na,this._logHandler=xa,this._userLogHandler=null,Ra.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in ka))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?Aa[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,So([this,ka.DEBUG],e)),this._logHandler.apply(this,So([this,ka.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,So([this,ka.VERBOSE],e)),this._logHandler.apply(this,So([this,ka.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,So([this,ka.INFO],e)),this._logHandler.apply(this,So([this,ka.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,So([this,ka.WARN],e)),this._logHandler.apply(this,So([this,ka.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,So([this,ka.ERROR],e)),this._logHandler.apply(this,So([this,ka.ERROR],e))},e}();
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Oa{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Ma="@firebase/app-exp",La=new Da("@firebase/app"),Fa="[DEFAULT]",Ua={[Ma]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics-exp":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check-exp":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth-exp":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions-exp":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations-exp":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging-exp":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance-exp":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config-exp":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js","firebase-exp":"fire-js-all"},qa=new Map,ja=new Map;function Va(e,t){try{e.container.addComponent(t)}catch(n){La.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ba(e,t){e.container.addOrOverwriteComponent(t)}function $a(e){const t=e.name;if(ja.has(t))return La.debug(`There were multiple attempts to register component ${t}.`),!1;ja.set(t,e);for(const t of qa.values())Va(t,e);return!0}function Wa(e,t){return e.container.getProvider(t)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Ka=new Qo("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class za{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ta("app-exp",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ka.create("app-deleted",{appName:this._name})}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Ha="9.0.0-beta.7";function Ga(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:Fa,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Ka.create("bad-app-name",{appName:String(r)});if(qa.has(r))throw Ka.create("duplicate-app",{appName:r});const i=new Ca(r);for(const e of ja.values())i.addComponent(e);const s=new za(e,n,i);return qa.set(r,s),s}function Qa(e="[DEFAULT]"){const t=qa.get(e);if(!t)throw Ka.create("no-app",{appName:e});return t}async function Ya(e){const t=e.name;qa.has(t)&&(qa.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function Ja(e,t,n){var r;let i=null!==(r=Ua[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void La.warn(e.join(" "))}$a(new Ta(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function Xa(e,t){if(null!==e&&"function"!=typeof e)throw Ka.create("invalid-log-argument");!function(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=Aa[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var o=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:ka[n].toLowerCase(),message:o,args:i,type:t.name})}},r=0,i=Ra;r<i.length;r++)n(i[r])}(e,t)}function Za(e){var t;t=e,Ra.forEach((function(e){e.setLogLevel(t)}))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ec;$a(new Ta("platform-logger",(e=>new Oa(e)),"PRIVATE")),Ja(Ma,"0.0.900-exp.6ef484a04",ec),Ja("fire-js","");var tc=Object.freeze({__proto__:null,SDK_VERSION:Ha,_DEFAULT_ENTRY_NAME:Fa,_addComponent:Va,_addOrOverwriteComponent:Ba,_apps:qa,_clearComponents:function(){ja.clear()},_components:ja,_getProvider:Wa,_registerComponent:$a,_removeServiceInstance:function(e,t,n="[DEFAULT]"){Wa(e,t).clearInstance(n)},deleteApp:Ya,getApp:Qa,getApps:function(){return Array.from(qa.values())},initializeApp:Ga,onLog:Xa,registerVersion:Ja,setLogLevel:Za});
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nc{constructor(e,t){this._delegate=e,this.firebase=t,Va(e,new Ta("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),Ya(this._delegate))))}_getService(e,t="[DEFAULT]"){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t="[DEFAULT]"){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Va(this._delegate,e)}_addOrOverwriteComponent(e){Ba(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const rc=new Qo("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const ic=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function e(){const t=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){const t={},n={__esModule:!0,initializeApp:function(r,i={}){const s=Ga(r,i),o=new e(s,n);return t[s.name]=o,o},app:r,registerVersion:Ja,setLogLevel:Za,onLog:Xa,apps:null,SDK_VERSION:Ha,INTERNAL:{registerComponent:function(t){const i=t.name,s=i.replace("-compat","");if($a(t)&&"PUBLIC"===t.type){const o=(e=r())=>{if("function"!=typeof e[s])throw rc.create("invalid-app-argument",{appName:i});return e[s]()};void 0!==t.serviceProps&&Mo(o,t.serviceProps),n[s]=o,e.prototype[s]=function(...e){return this._getService.bind(this,i).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[s]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:tc}};function r(e){if(!ra(t,e=e||Fa))throw rc.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),r.App=e,n}(nc);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Mo(t,e)},createSubscribe:ha,ErrorFactory:Qo,deepExtend:Mo}),t}(),sc=new Da("@firebase/app-compat");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){sc.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&sc.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const oc=ic;!
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){Ja("@firebase/app-compat","0.0.900-exp.6ef484a04",e)}();
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
oc.registerVersion("firebase-exp","9.0.0-beta.7","app-compat");function ac(e){return Array.prototype.slice.call(e)}function cc(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function uc(e,t,n){var r,i=new Promise((function(i,s){cc(r=e[t].apply(e,n)).then(i,s)}));return i.request=r,i}function lc(e,t,n){var r=uc(e,t,n);return r.then((function(e){if(e)return new mc(e,r.request)}))}function hc(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function dc(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return uc(this[t],r,arguments)})}))}function fc(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function pc(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return lc(this[t],r,arguments)})}))}function gc(e){this._index=e}function mc(e,t){this._cursor=e,this._request=t}function yc(e){this._store=e}function _c(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function vc(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new _c(n)}function wc(e){this._db=e}function bc(e,t,n){var r=uc(indexedDB,"open",[e,t]),i=r.request;return i&&(i.onupgradeneeded=function(e){n&&n(new vc(i.result,e.oldVersion,i.transaction))}),r.then((function(e){return new wc(e)}))}function Tc(e){return uc(indexedDB,"deleteDatabase",[e])}hc(gc,"_index",["name","keyPath","multiEntry","unique"]),dc(gc,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),pc(gc,"_index",IDBIndex,["openCursor","openKeyCursor"]),hc(mc,"_cursor",["direction","key","primaryKey","value"]),dc(mc,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(mc.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,n),cc(t._request).then((function(e){if(e)return new mc(e,t._request)}))}))})})),yc.prototype.createIndex=function(){return new gc(this._store.createIndex.apply(this._store,arguments))},yc.prototype.index=function(){return new gc(this._store.index.apply(this._store,arguments))},hc(yc,"_store",["name","keyPath","indexNames","autoIncrement"]),dc(yc,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),pc(yc,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),fc(yc,"_store",IDBObjectStore,["deleteIndex"]),_c.prototype.objectStore=function(){return new yc(this._tx.objectStore.apply(this._tx,arguments))},hc(_c,"_tx",["objectStoreNames","mode"]),fc(_c,"_tx",IDBTransaction,["abort"]),vc.prototype.createObjectStore=function(){return new yc(this._db.createObjectStore.apply(this._db,arguments))},hc(vc,"_db",["name","version","objectStoreNames"]),fc(vc,"_db",IDBDatabase,["deleteObjectStore","close"]),wc.prototype.transaction=function(){return new _c(this._db.transaction.apply(this._db,arguments))},hc(wc,"_db",["name","version","objectStoreNames"]),fc(wc,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[yc,gc].forEach((function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t=ac(arguments),n=t[t.length-1],r=this._store||this._index,i=r[e].apply(r,t.slice(0,-1));i.onsuccess=function(){n(i.result)}})}))})),[gc,yc].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})}));const Ic="0.0.900-exp.6ef484a04",Ec=1e4,Sc=`w:${Ic}`,kc="FIS_v2",Cc=36e5,Rc=new Qo("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Ac(e){return e instanceof Go&&e.code.includes("request-failed")}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Nc({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Pc(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function xc(e,t){const n=(await t.json()).error;return Rc.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Dc({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Oc(e,{refreshToken:t}){const n=Dc(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t)),n}async function Mc(e){const t=await e();return t.status>=500&&t.status<600?e():t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Lc(e){return new Promise((t=>{setTimeout(t,e)}))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Fc=/^[cdef][\w-]{21}$/;function Uc(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e);return Fc.test(t)?t:""}catch(e){return""}}function qc(e){return`${e.appName}!${e.appId}`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const jc=new Map;function Vc(e,t){const n=qc(e);Bc(n,t),function(e,t){const n=function(){!$c&&"BroadcastChannel"in self&&($c=new BroadcastChannel("[Firebase] FID Change"),$c.onmessage=e=>{Bc(e.data.key,e.data.fid)});return $c}();n&&n.postMessage({key:e,fid:t});0===jc.size&&$c&&($c.close(),$c=null)}(n,t)}function Bc(e,t){const n=jc.get(e);if(n)for(const e of n)e(t)}let $c=null;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Wc="firebase-installations-store";let Kc=null;function zc(){return Kc||(Kc=bc("firebase-installations-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(Wc)}}))),Kc}async function Hc(e,t){const n=qc(e),r=(await zc()).transaction(Wc,"readwrite"),i=r.objectStore(Wc),s=await i.get(n);return await i.put(t,n),await r.complete,s&&s.fid===t.fid||Vc(e,t.fid),t}async function Gc(e){const t=qc(e),n=(await zc()).transaction(Wc,"readwrite");await n.objectStore(Wc).delete(t),await n.complete}async function Qc(e,t){const n=qc(e),r=(await zc()).transaction(Wc,"readwrite"),i=r.objectStore(Wc),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.complete,!o||s&&s.fid===o.fid||Vc(e,o.fid),o}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Yc(e){let t;const n=await Qc(e,(n=>{const r=function(e){return Zc(e||{fid:Uc(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Rc.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:async function(e,t){try{return Hc(e,await async function(e,{fid:t}){const n=Nc(e),r=Dc(e),i={fid:t,authVersion:kc,appId:e.appId,sdkVersion:Sc},s={method:"POST",headers:r,body:JSON.stringify(i)},o=await Mc((()=>fetch(n,s)));if(o.ok){const e=await o.json();return{fid:e.fid||t,registrationStatus:2,refreshToken:e.refreshToken,authToken:Pc(e.authToken)}}throw await xc("Create Installation",o)}(e,t))}catch(n){throw Ac(n)&&409===n.customData.serverCode?await Gc(e):await Hc(e,{fid:t.fid,registrationStatus:0}),n}}(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Jc(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Jc(e){let t=await Xc(e);for(;1===t.registrationStatus;)await Lc(100),t=await Xc(e);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Yc(e);return n||t}return t}function Xc(e){return Qc(e,(e=>{if(!e)throw Rc.create("installation-not-found");return Zc(e)}))}function Zc(e){return 1===(t=e).registrationStatus&&t.registrationTime+Ec<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}async function eu({appConfig:e,platformLoggerProvider:t},n){const r=function(e,{fid:t}){return`${Nc(e)}/${t}/authTokens:generate`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,n),i=Oc(e,n),s=t.getImmediate({optional:!0});s&&i.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:Sc}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Mc((()=>fetch(r,a)));if(c.ok){return Pc(await c.json())}throw await xc("Generate Auth Token",c)}async function tu(e,t=!1){let n;const r=await Qc(e.appConfig,(r=>{if(!ru(r))throw Rc.create("not-registered");const i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Cc}(e)}(i))return r;if(1===i.requestStatus)return n=async function(e,t){let n=await nu(e.appConfig);for(;1===n.authToken.requestStatus;)await Lc(100),n=await nu(e.appConfig);const r=n.authToken;return 0===r.requestStatus?tu(e,t):r}(e,t),r;{if(!navigator.onLine)throw Rc.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await eu(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await Hc(e.appConfig,r),n}catch(n){if(!Ac(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Hc(e.appConfig,n)}else await Gc(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function nu(e){return Qc(e,(e=>{if(!ru(e))throw Rc.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Ec<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}))}function ru(e){return void 0!==e&&2===e.registrationStatus}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function iu(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await Yc(e);t&&await t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n.appConfig);return(await tu(n,t)).token}function su(e){return Rc.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ou="installations-exp",au=e=>{const t=Wa(e.getProvider("app-exp").getImmediate(),ou).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Yc(t.appConfig);return r?r.catch(console.error):tu(t).catch(console.error),n.fid}(t),getToken:e=>iu(t,e)}};$a(new Ta(ou,(e=>{const t=e.getProvider("app-exp").getImmediate();return{app:t,appConfig:function(e){if(!e||!e.options)throw su("App Configuration");if(!e.name)throw su("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw su(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:Wa(t,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),$a(new Ta("installations-exp-internal",au,"PRIVATE")),Ja("@firebase/installations-exp",Ic);
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const cu="analytics-exp",uu="https://www.googletagmanager.com/gtag/js",lu=new Da("@firebase/analytics");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function hu(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function du(e,t,n,r){return async function(i,s,o){try{"event"===i?await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await hu(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){lu.error(e)}}(e,t,n,s,o):"config"===i?await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await hu(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){lu.error(e)}e("config",i,s)}(e,t,n,r,s,o):e("set",s)}catch(e){lu.error(e)}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const fu=new Qo("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"Firebase Analytics has already been initialized. initializeAnalytics() must only be called once. getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'});const pu=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function gu(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function mu(e,t=pu,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw fu.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw fu.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new _u;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),yu({appId:r,apiKey:i,measurementId:s},o,a,t)}async function yu(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=pu){const{appId:s,measurementId:o}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(fu.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(o)return lu.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:s,measurementId:o};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:gu(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw fu.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(s),t}catch(t){if(!function(e){if(!(e instanceof Go&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(s),o)return lu.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:s,measurementId:o};throw t}const a=503===Number(t.customData.httpStatus)?wa(n,i.intervalMillis,30):wa(n,i.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return i.setThrottleMetadata(s,c),lu.debug(`Calling attemptFetch again in ${a} millis`),yu(e,c,r,i)}}class _u{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function vu(e,t,n,r,i,s,o){var a;const c=mu(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&lu.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>lu.error(e))),t.push(c);const u=async function(){if(!Ko())return lu.warn(fu.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await zo()}catch(e){return lu.warn(fu.create("indexeddb-unavailable",{errorInfo:e}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[l,h]=await Promise.all([c,u]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(uu))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${uu}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,l.measurementId),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d.firebase_id=h),i("config",l.measurementId,d),l.measurementId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wu{constructor(e){this.app=e}_delete(){return delete bu[this.app.options.appId],Promise.resolve()}}let bu={},Tu=[];const Iu={};let Eu,Su,ku="dataLayer",Cu="gtag",Ru=!1;function Au(e){if(Ru)throw fu.create("already-initialized");e.dataLayerName&&(ku=e.dataLayerName),e.gtagName&&(Cu=e.gtagName)}function Nu(e,t,n){!function(){const e=[];if(Vo()&&e.push("This is a browser extension environment."),Ho()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=fu.create("invalid-analytics-context",{errorInfo:t});lu.warn(n.message)}}();const r=e.options.appId;if(!r)throw fu.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw fu.create("no-api-key");lu.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=bu[r])throw fu.create("already-exists",{id:r});if(!Ru){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(ku);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=du(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(bu,Tu,Iu,ku,Cu);Su=e,Eu=t,Ru=!0}bu[r]=vu(e,Tu,Iu,t,Eu,ku,n);return new wu(e)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Pu(){if(Vo())return!1;if(!Ho())return!1;if(!Ko())return!1;try{return await zo()}catch(e){return!1}}function xu(e,t,n){e=ba(e),async function(e,t,n,r){if(r&&r.global)return e("set",{screen_name:n}),Promise.resolve();e("config",await t,{update:!0,screen_name:n})}(Su,bu[e.app.options.appId],t,n).catch((e=>lu.error(e)))}function Du(e,t,n){e=ba(e),async function(e,t,n,r){if(r&&r.global)return e("set",{user_id:n}),Promise.resolve();e("config",await t,{update:!0,user_id:n})}(Su,bu[e.app.options.appId],t,n).catch((e=>lu.error(e)))}function Ou(e,t,n){e=ba(e),async function(e,t,n,r){if(r&&r.global){const t={};for(const e of Object.keys(n))t[`user_properties.${e}`]=n[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}(Su,bu[e.app.options.appId],t,n).catch((e=>lu.error(e)))}function Mu(e,t){e=ba(e),async function(e,t){const n=await e;window[`ga-disable-${n}`]=!t}(bu[e.app.options.appId],t).catch((e=>lu.error(e)))}function Lu(e,t,n,r){e=ba(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Su,bu[e.app.options.appId],t,n,r).catch((e=>lu.error(e)))}$a(new Ta(cu,((e,{options:t})=>Nu(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate(),t)),"PUBLIC")),$a(new Ta("analytics-internal",(function(e){try{const t=e.getProvider(cu).getImmediate();return{logEvent:(e,n,r)=>Lu(t,e,n,r)}}catch(e){throw fu.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Ja("@firebase/analytics-exp","0.0.900-exp.6ef484a04");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Fu{constructor(e,t){this.app=e,this._delegate=t}logEvent(e,t,n){Lu(this._delegate,e,t,n)}setCurrentScreen(e,t){xu(this._delegate,e,t)}setUserId(e,t){Du(this._delegate,e,t)}setUserProperties(e,t){Ou(this._delegate,e,t)}setAnalyticsCollectionEnabled(e){Mu(this._delegate,e)}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Uu;!function(e){e.ADD_SHIPPING_INFO="add_shipping_info",e.ADD_PAYMENT_INFO="add_payment_info",e.ADD_TO_CART="add_to_cart",e.ADD_TO_WISHLIST="add_to_wishlist",e.BEGIN_CHECKOUT="begin_checkout",e.CHECKOUT_PROGRESS="checkout_progress",e.EXCEPTION="exception",e.GENERATE_LEAD="generate_lead",e.LOGIN="login",e.PAGE_VIEW="page_view",e.PURCHASE="purchase",e.REFUND="refund",e.REMOVE_FROM_CART="remove_from_cart",e.SCREEN_VIEW="screen_view",e.SEARCH="search",e.SELECT_CONTENT="select_content",e.SELECT_ITEM="select_item",e.SELECT_PROMOTION="select_promotion",e.SET_CHECKOUT_OPTION="set_checkout_option",e.SHARE="share",e.SIGN_UP="sign_up",e.TIMING_COMPLETE="timing_complete",e.VIEW_CART="view_cart",e.VIEW_ITEM="view_item",e.VIEW_ITEM_LIST="view_item_list",e.VIEW_PROMOTION="view_promotion",e.VIEW_SEARCH_RESULTS="view_search_results"}(Uu||(Uu={}));
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const qu=e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("analytics-exp").getImmediate();return new Fu(t,n)};!function(){const e={Analytics:Fu,settings:Au,isSupported:Pu,EventName:Uu};oc.INTERNAL.registerComponent(new Ta("analytics-compat",qu,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),oc.registerVersion("@firebase/analytics-compat","0.0.900-exp.6ef484a04");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const ju=new Map,Vu={activated:!1,tokenObservers:[]},Bu={enabled:!1};function $u(e){return ju.get(e)||Vu}function Wu(e,t){ju.set(e,t)}function Ku(){return Bu}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const zu="https://content-firebaseappcheck.googleapis.com/v1beta",Hu=3e4,Gu=96e4;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Qu{constructor(e,t,n,r,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((()=>{}))}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Lo,await function(e){return new Promise((t=>{setTimeout(t,e)}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Lo,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch((()=>{}))}catch(e){this.retryPolicy(e)?this.process(!1).catch((()=>{})):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const Yu=new Qo("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName}, initializeAppCheck() can only be called once.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error."});
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Ju(){return self.grecaptcha}function Xu(e){if(!$u(e).activated)throw Yu.create("use-before-activation",{appName:e.name})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Zu({url:e,body:t},n){const r={"Content-Type":"application/json"},i=n.getImmediate({optional:!0});i&&(r["X-Firebase-Client"]=i.getPlatformInfoString());const s={method:"POST",body:JSON.stringify(t),headers:r};let o,a;try{o=await fetch(e,s)}catch(e){throw Yu.create("fetch-network-error",{originalErrorMessage:e.message})}if(200!==o.status)throw Yu.create("fetch-status-error",{httpStatus:o.status});try{a=await o.json()}catch(e){throw Yu.create("fetch-parse-error",{originalErrorMessage:e.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw Yu.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const u=1e3*Number(c[1]),l=Date.now();return{token:a.attestationToken,expireTimeMillis:l+u,issuedAtTimeMillis:l}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const el="firebase-app-check-store",tl="debug-token";let nl=null;function rl(){return nl||(nl=new Promise(((e,t)=>{try{const n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=t=>{e(t.target.result)},n.onerror=e=>{var n;t(Yu.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=e=>{const t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(el,{keyPath:"compositeKey"})}}}catch(e){t(Yu.create("storage-open",{originalErrorMessage:e.message}))}})),nl)}async function il(e,t){const n=(await rl()).transaction(el,"readwrite"),r=n.objectStore(el).put({compositeKey:e,value:t});return new Promise(((e,t)=>{r.onsuccess=t=>{e()},n.onerror=e=>{var n;t(Yu.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}))}async function sl(e){const t=(await rl()).transaction(el,"readonly"),n=t.objectStore(el).get(e);return new Promise(((e,r)=>{n.onsuccess=t=>{const n=t.target.result;e(n?n.value:void 0)},t.onerror=e=>{var t;r(Yu.create("storage-get",{originalErrorMessage:null===(t=e.target.error)||void 0===t?void 0:t.message}))}}))}function ol(e){return`${e.options.appId}-${e.name}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const al=new Da("@firebase/app-check");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function cl(e){if(Ko()){let t;try{t=await function(e){return sl(ol(e))}(e)}catch(e){al.warn(`Failed to read token from IndexedDB. Error: ${e}`)}return t}}function ul(e,t){return Ko()?function(e,t){return il(ol(e),t)}(e,t).catch((e=>{al.warn(`Failed to write token to IndexedDB. Error: ${e}`)})):Promise.resolve()}async function ll(){let e;try{e=await sl(tl)}catch(e){}if(e)return e;{const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return(t=e,il(tl,t)).catch((e=>al.warn(`Failed to persist debug token to IndexedDB. Error: ${e}`))),console.log(`App Check debug token: ${e}. You will need to add it to your app's App Check settings in the Firebase console for it to work`),e}var t}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const hl={error:"UNKNOWN_ERROR"};function dl(e){return Po.encodeString(JSON.stringify(e),!1)}async function fl(e,t=!1){const n=e.app;Xu(n);const r=$u(n);let i,s,o=r.token;if(!o){const e=await cl(n);e&&yl(e)&&(o=e,Wu(n,Object.assign(Object.assign({},r),{token:o})),ml(n,{token:o.token}))}if(!t&&o&&yl(o))return{token:o.token};if(Ku().enabled){const t=await Zu(function(e,t){const{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${zu}/projects/${n}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:t}}}(n,await async function(){const e=Ku();if(e.enabled&&e.token)return e.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}()),e.platformLoggerProvider);return await ul(n,t),Wu(n,Object.assign(Object.assign({},r),{token:t})),{token:t.token}}try{o=await r.provider.getToken()}catch(e){al.error(e),i=e}return o?(s={token:o.token},Wu(n,Object.assign(Object.assign({},r),{token:o})),await ul(n,o)):s=function(e){return{token:dl(hl),error:e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(i),ml(n,s),s}function pl(e,t,n,r){const{app:i}=e,s=$u(i),o={next:n,error:r,type:t},a=Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,o]});if(!a.tokenRefresher){const t=function(e){const{app:t}=e;return new Qu((async()=>{let n;if(n=$u(t).token?await fl(e,!0):await fl(e),n.error)throw n.error}),(()=>!0),(()=>{const e=$u(t);if(e.token){let t=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;const n=e.token.expireTimeMillis-3e5;return t=Math.min(t,n),Math.max(0,t-Date.now())}return 0}),Hu,Gu)}(e);a.tokenRefresher=t}if(!a.tokenRefresher.isRunning()&&s.isTokenAutoRefreshEnabled&&a.tokenRefresher.start(),s.token&&yl(s.token)){const e=s.token;Promise.resolve().then((()=>n({token:e.token}))).catch((()=>{}))}Wu(i,a)}function gl(e,t){const n=$u(e),r=n.tokenObservers.filter((e=>e.next!==t));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),Wu(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function ml(e,t){const n=$u(e).tokenObservers;for(const e of n)try{"EXTERNAL"===e.type&&null!=t.error?e.error(t.error):e.next(t)}catch(e){}}function yl(e){return e.expireTimeMillis-Date.now()>0}class _l{constructor(e,t){this.app=e,this.platformLoggerProvider=t}_delete(){const{tokenObservers:e}=$u(this.app);for(const t of e)gl(this.app,t.next);return Promise.resolve()}}const vl="https://www.google.com/recaptcha/api.js";function wl(e,t){const n=$u(e),r=new Lo;Wu(e,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:r}}));const i=`fire_app_check_${e.name}`,s=document.createElement("div");s.id=i,s.style.display="none",document.body.appendChild(s);const o=Ju();return o?o.ready((()=>{bl(e,t,o,i),r.resolve(o)})):function(e){const t=document.createElement("script");t.src=`${vl}`,t.onload=e,document.head.appendChild(t)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */((()=>{const n=Ju();if(!n)throw new Error("no recaptcha");n.ready((()=>{bl(e,t,n,i),r.resolve(n)}))})),r.promise}function bl(e,t,n,r){const i=n.render(r,{sitekey:t,size:"invisible"}),s=$u(e);Wu(e,Object.assign(Object.assign({},s),{reCAPTCHAState:Object.assign(Object.assign({},s.reCAPTCHAState),{widgetId:i})}))}class Tl{constructor(e){this._siteKey=e}async getToken(){if(!this._app||!this._platformLoggerProvider)throw Yu.create("use-before-activation",{appName:""});const e=await async function(e){Xu(e);const t=$u(e).reCAPTCHAState,n=await t.initialized.promise;return new Promise(((t,r)=>{const i=$u(e).reCAPTCHAState;n.ready((()=>{t(n.execute(i.widgetId,{action:"fire_app_check"}))}))}))}(this._app).catch((e=>{throw Yu.create("recaptcha-error")}));return Zu(function(e,t){const{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${zu}/projects/${n}/apps/${r}:exchangeRecaptchaToken?key=${i}`,body:{recaptcha_token:t}}}(this._app,e),this._platformLoggerProvider)}initialize(e){this._app=e,this._platformLoggerProvider=Wa(e,"platform-logger"),wl(e,this._siteKey).catch((()=>{}))}}class Il{constructor(e){this._customProviderOptions=e}async getToken(){if(!this._app)throw Yu.create("use-before-activation",{appName:""});const e=await this._customProviderOptions.getToken(),t=(n=e.token,"object"==typeof(r=ea(n).claims)&&r.hasOwnProperty("iat")?r.iat:null);var n,r;const i=null!==t&&t<Date.now()&&t>0?1e3*t:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:i})}initialize(e){this._app=e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function El(e=Qa(),t){const n=Wa(e=ba(e),"app-check-exp");if(n.isInitialized())throw Yu.create("already-initialized",{appName:e.name});const r=n.initialize({options:t});return function(e,t,n){const r=$u(e),i=Object.assign(Object.assign({},r),{activated:!0});i.provider=t,i.isTokenAutoRefreshEnabled=void 0===n?e.automaticDataCollectionEnabled:n,Wu(e,i),i.provider.initialize(e)}(e,t.provider,t.isTokenAutoRefreshEnabled),r}const Sl="app-check-internal";$a(new Ta("app-check-exp",(e=>function(e,t){return new _l(e,t)}(e.getProvider("app-exp").getImmediate(),e.getProvider("platform-logger"))),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider(Sl).initialize()}))),$a(new Ta(Sl,(e=>function(e){return{getToken:t=>fl(e,t),addTokenListener:t=>pl(e,"INTERNAL",t),removeTokenListener:t=>gl(e.app,t)}}(e.getProvider("app-check-exp").getImmediate())),"PUBLIC").setInstantiationMode("EXPLICIT")),Ja("@firebase/app-check-exp","0.0.900-exp.6ef484a04"),function(){const e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}();if("string"!=typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN&&!0!==e.FIREBASE_APPCHECK_DEBUG_TOKEN)return;const t=Ku();t.enabled=!0;const n=new Lo;t.token=n,"string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(e.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(ll())}();const kl=new Qo("appCheck","AppCheck",{"use-before-activation":"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."});
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Cl{constructor(e){this.app=e}activate(e,t){let n;n="string"==typeof e?new Tl(e):new Il({getToken:e.getToken}),this._delegate=El(this.app,{provider:n,isTokenAutoRefreshEnabled:t})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw kl.create("use-before-activation",{appName:this.app.name});!function(e,t){const n=e.app,r=$u(n);r.tokenRefresher&&(!0===t?r.tokenRefresher.start():r.tokenRefresher.stop()),Wu(n,Object.assign(Object.assign({},r),{isTokenAutoRefreshEnabled:t}))}(this._delegate,e)}getToken(e){if(!this._delegate)throw kl.create("use-before-activation",{appName:this.app.name});return async function(e,t){const n=await fl(e,t);if(n.error)throw n.error;return{token:n.token}}(this._delegate,e)}onTokenChanged(e,t,n){if(!this._delegate)throw kl.create("use-before-activation",{appName:this.app.name});return function(e,t,n,r){let i=()=>{},s=()=>{};return i=null!=t.next?t.next.bind(t):t,null!=t.error?s=t.error.bind(t):n&&(s=n),pl(e,"EXTERNAL",i,s),()=>gl(e.app,i)}(this._delegate,e,t)}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Rl=e=>{const t=e.getProvider("app-compat").getImmediate();return new Cl(t)};oc.INTERNAL.registerComponent(new Ta("appCheck-compat",Rl,"PUBLIC")),oc.registerVersion("@firebase/app-check-compat","0.0.900-exp.6ef484a04");const Al=
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"Auth can only be initialized once per app."}},Nl=new Qo("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Pl=new Da("@firebase/auth-exp");function xl(e,...t){Pl.logLevel<=ka.ERROR&&Pl.error(`Auth (9.0.0-beta.7): ${e}`,...t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Dl(e,...t){throw Ml(e,...t)}function Ol(e,...t){return Ml(e,...t)}function Ml(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Nl.create(e,...t)}function Ll(e,t,...n){if(!e)throw Ml(t,...n)}function Fl(e){const t="INTERNAL ASSERTION FAILED: "+e;throw xl(t),new Error(t)}function Ul(e,t){e||Fl(t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ql=new Map;function jl(e){Ul(e instanceof Function,"Expected a class definition");let t=ql.get(e);return t?(Ul(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ql.set(e,t),t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Vl(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Bl(){return"http:"===$l()||"https:"===$l()}function $l(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Wl{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ul(t>e,"Short delay should be less than long delay!"),this.isMobile=qo()||Bo()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Bl()||Vo()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Kl(e,t){Ul(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zl{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Fl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Fl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Fl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Hl={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded"},Gl=new Wl(3e4,6e4);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Ql(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Yl(e,t,n,r,i={}){return Jl(e,i,(()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=aa(Object.assign({key:e.config.apiKey},s)).slice(1),a=new(zl.headers());return a.set("Content-Type","application/json"),a.set("X-Client-Version",e._getSdkClientVersion()),e.languageCode&&a.set("X-Firebase-Locale",e.languageCode),zl.fetch()(Zl(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Jl(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Hl),t);try{const t=new eh(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw th(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=(i.ok?s.errorMessage:s.error.message).split(" : ")[0];if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw th(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw th(e,"email-already-in-use",s);Dl(e,r[t]||t.toLowerCase().replace(/[_\s]+/g,"-"))}}catch(t){if(t instanceof Go)throw t;Dl(e,"network-request-failed")}}async function Xl(e,t,n,r,i={}){const s=await Yl(e,t,n,r,i);return"mfaPendingCredential"in s&&Dl(e,"multi-factor-auth-required",{serverResponse:s}),s}function Zl(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Kl(e.config,i):`${e.config.apiScheme}://${i}`}class eh{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Ol(this.auth,"timeout"))),Gl.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function th(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Ol(e,t,r);return i.customData._tokenResponse=n,i}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function nh(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function rh(e){return 1e3*Number(e)}function ih(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return xl("JWT malformed, contained fewer than 3 sections"),null;try{const e=Do(n);return e?JSON.parse(e):(xl("Failed to decode base64 JWT payload"),null)}catch(e){return xl("Caught error parsing JWT payload as JSON",e),null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function sh(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof Go&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class oh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ah{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nh(this.lastLoginAt),this.creationTime=nh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function ch(e){var t;const n=e.auth,r=await e.getIdToken(),i=await sh(e,async function(e,t){return Yl(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));Ll(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=wo(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ah(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class uh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ll(e.idToken,"internal-error"),Ll(void 0!==e.idToken,"internal-error"),Ll(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=ih(e);return Ll(t,"internal-error"),Ll(void 0!==t.exp,"internal-error"),Ll(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Ll(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){const n=await Jl(e,{},(()=>{const n=aa({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Zl(e,r,"/v1/token",`key=${i}`);return zl.fetch()(s,{method:"POST",headers:{"X-Client-Version":e._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new uh;return n&&(Ll("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Ll("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Ll("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uh,this.toJSON())}_performRefresh(){return Fl("not implemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function lh(e,t){Ll("string"==typeof e||void 0===e,"internal-error",{appName:t})}class hh{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=wo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new oh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new ah(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await sh(this,this.stsTokenManager.getToken(this.auth,e));return Ll(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=ba(e),r=await n.getIdToken(t),i=ih(r);Ll(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:nh(rh(i.auth_time)),issuedAtTime:nh(rh(i.iat)),expirationTime:nh(rh(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=ba(e);await ch(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Ll(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new hh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){Ll(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ch(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await sh(this,async function(e,t){return Yl(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:_,emailVerified:v,isAnonymous:w,providerData:b,stsTokenManager:T}=t;Ll(_&&T,e,"internal-error");const I=uh.fromJSON(this.name,T);Ll("string"==typeof _,e,"internal-error"),lh(l,e.name),lh(h,e.name),Ll("boolean"==typeof v,e,"internal-error"),Ll("boolean"==typeof w,e,"internal-error"),lh(d,e.name),lh(f,e.name),lh(p,e.name),lh(g,e.name),lh(m,e.name),lh(y,e.name);const E=new hh({uid:_,auth:e,email:h,emailVerified:v,displayName:l,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t,n=!1){const r=new uh;r.updateFromServerResponse(t);const i=new hh({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ch(i),i}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class dh{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}dh.type="NONE";const fh=dh;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ph(e,t,n){return`firebase:${e}:${t}:${n}`}class gh{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ph(this.userKey,r.apiKey,i),this.fullPersistenceKey=ph("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?hh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new gh(jl(fh),e,n);let r=jl(fh);for(const e of t)if(await e._isAvailable()){r=e;break}let i=null;const s=ph(n,e.config.apiKey,e.name);for(const n of t)try{const t=await n._get(s);if(t){const s=hh._fromJSON(e,t);n!==r&&(i=s);break}}catch(e){}return i&&await r._set(s,i.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new gh(r,e,n)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function mh(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(wh(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(yh(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Th(t))return"Blackberry";if(Ih(t))return"Webos";if(_h(t))return"Safari";if((t.includes("chrome/")||vh(t))&&!t.includes("edge/"))return"Chrome";if(bh(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function yh(e=Uo()){return/firefox\//i.test(e)}function _h(e=Uo()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function vh(e=Uo()){return/crios\//i.test(e)}function wh(e=Uo()){return/iemobile/i.test(e)}function bh(e=Uo()){return/android/i.test(e)}function Th(e=Uo()){return/blackberry/i.test(e)}function Ih(e=Uo()){return/webos/i.test(e)}function Eh(e=Uo()){return/iphone|ipad|ipod/i.test(e)}function Sh(e=Uo()){return Eh(e)||bh(e)||Ih(e)||Th(e)||/windows phone/i.test(e)||wh(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function kh(e,t=[]){let n;switch(e){case"Browser":n=mh(Uo());break;case"Worker":n=`${mh(Uo())}-${e}`;break;default:n=e}return`${n}/JsCore/9.0.0-beta.7/${t.length?t.join(","):"FirebaseCore-web"}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ch{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ah(this),this.idTokenSubscription=new Ah(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.redirectInitializerError=null,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Nl,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=jl(t)),this._initializationPromise=this.queue((async()=>{var n;this._deleted||(this.persistenceManager=await gh.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this._deleted||(this._isInitialized=!0)))})),this._initializationPromise.then((()=>{if(this.redirectInitializerError)throw this.redirectInitializerError}))}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(Ll(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){this.redirectInitializerError=e,await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ch(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?ba(e):null;return t&&Ll(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&Ll(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(jl(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Qo("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&jl(e)||this._popupRedirectResolver;Ll(t,this,"argument-error"),this.redirectPersistenceManager=await gh.create(this,[jl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Ll(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ll(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kh(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function Rh(e){return ba(e)}class Ah{constructor(e){this.auth=e,this.observer=null,this.addObserver=ha((e=>this.observer=e))}get next(){return Ll(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Nh(e,t,n){const r=Rh(e);Ll(r._canInitEmulator,r,"emulator-config-failed"),Ll(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=Ph(t),{host:o,port:a}=function(e){const t=Ph(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:xh(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:xh(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),function(e){function t(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"==typeof window||"undefined"==typeof document||e||("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(i)}function Ph(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function xh(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Dh{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fl("not implemented")}_getIdTokenResponse(e){return Fl("not implemented")}_linkToIdToken(e,t){return Fl("not implemented")}_getReauthenticationResolver(e){return Fl("not implemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Oh(e,t){return Yl(e,"POST","/v1/accounts:resetPassword",Ql(e,t))}async function Mh(e,t){return Yl(e,"POST","/v1/accounts:update",t)}async function Lh(e,t){return Yl(e,"POST","/v1/accounts:sendOobCode",Ql(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Fh extends Dh{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Fh(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Fh(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e,t){return Xl(e,"POST","/v1/accounts:signInWithPassword",Ql(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e,t){return Xl(e,"POST","/v1/accounts:signInWithEmailLink",Ql(e,t))}(e,{email:this._email,oobCode:this._password});default:Dl(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Mh(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Xl(e,"POST","/v1/accounts:signInWithEmailLink",Ql(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Dl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Uh(e,t){return Xl(e,"POST","/v1/accounts:signInWithIdp",Ql(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qh extends Dh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Dl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=wo(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new qh(n,r);return Object.assign(s,i),s}_getIdTokenResponse(e){return Uh(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Uh(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Uh(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=aa(t)}return e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const jh={USER_NOT_FOUND:"user-not-found"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Vh extends Dh{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Vh({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Vh({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Xl(e,"POST","/v1/accounts:signInWithPhoneNumber",Ql(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Xl(e,"POST","/v1/accounts:signInWithPhoneNumber",Ql(e,t));if(n.temporaryProof)throw th(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Xl(e,"POST","/v1/accounts:signInWithPhoneNumber",Ql(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),jh)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Vh({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Bh{constructor(e){var t,n,r,i,s,o;const a=ca(ua(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Ll(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=ca(ua(e)).link,n=t?ca(ua(t)).deep_link_id:null,r=ca(ua(e)).deep_link_id;return(r?ca(ua(r)).link:null)||r||n||t||e}(e);try{return new Bh(t)}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $h{constructor(){this.providerId=$h.PROVIDER_ID}static credential(e,t){return Fh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Bh.parseLink(t);return Ll(n,"argument-error"),Fh._fromEmailAndCode(e,n.code,n.tenantId)}}$h.PROVIDER_ID="password",$h.EMAIL_PASSWORD_SIGN_IN_METHOD="password",$h.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Wh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Kh extends Wh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class zh extends Kh{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return Ll("providerId"in t&&"signInMethod"in t,"argument-error"),qh._fromParams(t)}credential(e){return this._credential(e)}_credential(e){return Ll(e.idToken||e.accessToken,"argument-error"),qh._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return zh.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return zh.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new zh(o)._credential({idToken:t,accessToken:n,rawNonce:s,pendingToken:i})}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Hh extends Kh{constructor(){super("facebook.com")}static credential(e){return qh._fromParams({providerId:Hh.PROVIDER_ID,signInMethod:Hh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hh.credentialFromTaggedObject(e)}static credentialFromError(e){return Hh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Hh.credential(e.oauthAccessToken)}catch(e){return null}}}Hh.FACEBOOK_SIGN_IN_METHOD="facebook.com",Hh.PROVIDER_ID="facebook.com";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Gh extends Kh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qh._fromParams({providerId:Gh.PROVIDER_ID,signInMethod:Gh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Gh.credentialFromTaggedObject(e)}static credentialFromError(e){return Gh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Gh.credential(t,n)}catch(e){return null}}}Gh.GOOGLE_SIGN_IN_METHOD="google.com",Gh.PROVIDER_ID="google.com";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Qh extends Kh{constructor(){super("github.com")}static credential(e){return qh._fromParams({providerId:Qh.PROVIDER_ID,signInMethod:Qh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qh.credentialFromTaggedObject(e)}static credentialFromError(e){return Qh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Qh.credential(e.oauthAccessToken)}catch(e){return null}}}Qh.GITHUB_SIGN_IN_METHOD="github.com",Qh.PROVIDER_ID="github.com";class Yh extends Dh{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Uh(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Uh(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Uh(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new Yh(n,i):null}static _create(e,t){return new Yh(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Jh extends Kh{constructor(){super("twitter.com")}static credential(e,t){return qh._fromParams({providerId:Jh.PROVIDER_ID,signInMethod:Jh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Jh.credentialFromTaggedObject(e)}static credentialFromError(e){return Jh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Jh.credential(t,n)}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Xh(e,t){return Xl(e,"POST","/v1/accounts:signUp",Ql(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Jh.TWITTER_SIGN_IN_METHOD="twitter.com",Jh.PROVIDER_ID="twitter.com";class Zh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await hh._fromIdTokenResponse(e,n,r),s=ed(n);return new Zh({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ed(n);return new Zh({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ed(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class td extends Go{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,this.name="FirebaseError",Object.setPrototypeOf(this,td.prototype),this.appName=e.name,this.code=t.code,this.tenantId=null!==(i=e.tenantId)&&void 0!==i?i:void 0,this.serverResponse=t.customData.serverResponse}static _fromErrorAndOperation(e,t,n,r){return new td(e,t,n,r)}}function nd(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw td._fromErrorAndOperation(e,n,t,r);throw n}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function rd(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function id(e,t){const n=ba(e);await od(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return Yl(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=rd(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function sd(e,t,n=!1){const r=await sh(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Zh._forOperation(e,"link",r)}async function od(e,t,n){await ch(t);const r=!1===e?"provider-already-linked":"no-such-provider";Ll(rd(t.providerData).has(n)===e,t.auth,r)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function ad(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await sh(e,nd(r,i,t,e),n);Ll(s.idToken,r,"internal-error");const o=ih(s.idToken);Ll(o,r,"internal-error");const{sub:a}=o;return Ll(e.uid===a,r,"user-mismatch"),Zh._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Dl(r,"user-mismatch"),e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function cd(e,t,n=!1){const r="signIn",i=await nd(e,r,t),s=await Zh._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function ud(e,t){return cd(Rh(e),t)}async function ld(e,t){const n=ba(e);return await od(!1,n,t.providerId),sd(n,t)}async function hd(e,t){return ad(ba(e),t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function dd(e,t){const n=Rh(e),r=await async function(e,t){return Xl(e,"POST","/v1/accounts:signInWithCustomToken",Ql(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Zh._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class fd{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?pd._fromServerResponse(e,t):Dl(e,"internal-error")}}class pd extends fd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new pd(t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function gd(e,t,n){var r;Ll((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Ll(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Ll(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iosBundleId=n.iOS.bundleId),n.android&&(Ll(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function md(e,t,n){const r=ba(e),i={requestType:"PASSWORD_RESET",email:t};n&&gd(r,i,n),await async function(e,t){return Lh(e,t)}(r,i)}async function yd(e,t){await async function(e,t){return Yl(e,"POST","/v1/accounts:update",Ql(e,t))}(ba(e),{oobCode:t})}async function _d(e,t){const n=ba(e),r=await Oh(n,{oobCode:t}),i=r.requestType;switch(Ll(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ll(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ll(r.mfaInfo,n,"internal-error");default:Ll(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=fd._fromServerResponse(Rh(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function vd(e,t,n){const r=ba(e),i={requestType:"EMAIL_SIGNIN",email:t};Ll(n.handleCodeInApp,r,"argument-error"),n&&gd(r,i,n),await async function(e,t){return Lh(e,t)}(r,i)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function wd(e,t){const n={identifier:t,continueUri:Bl()?Vl():"http://localhost"},{signinMethods:r}=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){return Yl(e,"POST","/v1/accounts:createAuthUri",Ql(e,t))}(ba(e),n);return r||[]}async function bd(e,t){const n=ba(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&gd(n.auth,r,t);const{email:i}=await async function(e,t){return Lh(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function Td(e,t,n){const r=ba(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&gd(r.auth,i,n);const{email:s}=await async function(e,t){return Lh(e,t)}(r.auth,i);s!==e.email&&await e.reload()}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Id(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=ba(e),i={idToken:await r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=await sh(r,async function(e,t){return Yl(e,"POST","/v1/accounts:update",t)}(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find((({providerId:e})=>"password"===e));o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}async function Ed(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await sh(e,Mh(r,i));await e._updateTokensIfNecessary(s,!0)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Sd{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class kd extends Sd{constructor(e,t,n,r){super(e,t,n),this.username=r}}class Cd extends Sd{constructor(e,t){super(e,"facebook.com",t)}}class Rd extends kd{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class Ad extends Sd{constructor(e,t){super(e,"google.com",t)}}class Nd extends kd{constructor(e,t,n){super(e,"twitter.com",t,n)}}function Pd(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=ih(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new Sd(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new Cd(s,i);case"github.com":return new Rd(s,i);case"google.com":return new Ad(s,i);case"twitter.com":return new Nd(s,i,e.screenName||null);case"custom":case"anonymous":return new Sd(s,null);default:return new Sd(s,r,i)}}(n)}class xd{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new xd("enroll",e)}static _fromMfaPendingCredential(e){return new xd("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return xd._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return xd._fromIdtoken(e.multiFactorSession.idToken)}return null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Dd{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Rh(e),r=(t.serverResponse.mfaInfo||[]).map((e=>fd._fromServerResponse(n,e)));Ll(t.serverResponse.mfaPendingCredential,n,"internal-error");const i=xd._fromMfaPendingCredential(t.serverResponse.mfaPendingCredential);return new Dd(i,r,(async e=>{const r=await e._process(n,i);delete t.serverResponse.mfaInfo,delete t.serverResponse.mfaPendingCredential;const s=Object.assign(Object.assign({},t.serverResponse),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Zh._fromIdTokenResponse(n,t.operationType,s);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return Ll(t.user,n,"internal-error"),Zh._forOperation(t.user,t.operationType,s);default:Dl(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class Od{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>fd._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new Od(e)}async getSession(){return xd._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,r=await this.getSession(),i=await sh(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken(),r=await sh(this.user,(i=this.user.auth,s={idToken:n,mfaEnrollmentId:t},Yl(i,"POST","/v2/accounts/mfaEnrollment:withdraw",Object.assign({tenantId:i.tenantId},s))));var i,s;this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(r);try{await this.user.reload()}catch(e){if("auth/user-token-expired"!==e.code)throw e}}}const Md=new WeakMap;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Ld{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ll(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Fd="__sak";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ud{constructor(e,t){this.storage=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fd,"1"),this.storage.removeItem(Fd),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qd extends Ud{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Uo();return _h(e)||Eh(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Sh(),this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);$o()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qd.type="LOCAL";const jd=qd;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Vd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Vd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Bd(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Vd.receivers=[];class $d{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Bd("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Wd(){return window}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Kd(){return void 0!==Wd().WorkerGlobalScope&&"function"==typeof Wd().importScripts}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const zd="firebaseLocalStorageDb",Hd="firebaseLocalStorage",Gd="fbase_key";class Qd{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Yd(e,t){return e.transaction([Hd],t?"readwrite":"readonly").objectStore(Hd)}function Jd(){const e=indexedDB.open(zd,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Hd,{keyPath:Gd})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Hd)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(zd);return new Qd(e).toPromise()}(),t(await Jd()))}))}))}async function Xd(e,t,n){const r=Yd(e,!0).put({[Gd]:t,value:n});return new Qd(r).toPromise()}function Zd(e,t){const n=Yd(e,!0).delete(t);return new Qd(n).toPromise()}class ef{constructor(){this.type="LOCAL",this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Jd()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Kd()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vd._getInstance(Kd()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new $d(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jd();return await Xd(e,Fd,"1"),await Zd(e,Fd),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Xd(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Yd(e,!1).get(t),r=await new Qd(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Zd(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Yd(e,!1).getAll();return new Qd(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ef.type="LOCAL";const tf=ef;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nf{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sf(e);default:return!1}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!sf(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Ol(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rf(e))}saveEventToCache(e){this.cachedEventUids.add(rf(e)),this.lastProcessedEventTime=Date.now()}}function rf(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function sf({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function of(e,t={}){return Yl(e,"GET","/v1/projects",t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const af=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cf=/^https?/;function uf(e){const t=Vl(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!cf.test(n))return!1;if(af.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function lf(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Ol("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function hf(e){return`__${e}${Math.floor(1e6*Math.random())}`}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const df=new Wl(3e4,6e4);function ff(){const e=Wd().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let pf=null;function gf(e){return pf=pf||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){ff(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ff(),n(Ol(e,"network-request-failed"))},timeout:df.get()})}if(null===(i=null===(r=Wd().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Wd().gapi)||void 0===s?void 0:s.load)){const t=hf("iframefcb");return Wd()[t]=()=>{gapi.load?o():n(Ol(e,"network-request-failed"))},lf(`https://apis.google.com/js/api.js?onload=${t}`)}o()}})).catch((e=>{throw pf=null,e}))}(e),pf}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const mf=new Wl(5e3,15e3),yf={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},_f=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vf(e){const t=e.config;Ll(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Kl(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ha},i=_f.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${aa(r).slice(1)}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class wf extends Ud{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}wf.type="SESSION";const bf=wf,Tf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class If{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Ef(e,t,n,r=500,i=600){const s=Math.min((window.screen.availHeight-i)/2,0).toString(),o=Math.min((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Tf),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Uo().toLowerCase();n&&(a=vh(u)?"_blank":n),yh(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=Uo()){var t;return Eh(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t||"",a),new If(null);const h=window.open(t||"",a,l);Ll(h,e,"popup-blocked");try{h.focus()}catch(e){}return new If(h)}function Sf(e,t){return t?jl(t):(Ll(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class kf extends Dh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Uh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Uh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Cf(e){return cd(e.auth,new kf(e),e.bypassAuthState)}function Rf(e){const{auth:t,user:n}=e;return Ll(n,t,"internal-error"),ad(n,new kf(e),e.bypassAuthState)}async function Af(e){const{auth:t,user:n}=e;return Ll(n,t,"internal-error"),sd(n,new kf(e),e.bypassAuthState)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Nf{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Cf;case"linkViaPopup":case"linkViaRedirect":return Af;case"reauthViaPopup":case"reauthViaRedirect":return Rf;default:Dl(this.auth,"internal-error")}}resolve(e){Ul(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ul(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Pf=new Map;class xf extends Nf{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Pf.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Mf(t),r="true"===await Of(e)._get(n);return await Of(e)._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Pf.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Df(e,t){return Of(e)._set(Mf(t),"true")}function Of(e){return jl(e._redirectPersistence)}function Mf(e){return ph("pendingRedirect",e.config.apiKey,e.name)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Lf(e,t,n){return async function(e,t,n){const r=Rh(e);Ll(t instanceof Wh,e,"argument-error");const i=Sf(r,n);return await Df(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function Ff(e,t,n){return async function(e,t,n){const r=ba(e);Ll(t instanceof Wh,r.auth,"argument-error");const i=Sf(r.auth,n);await Df(i,r.auth);const s=await jf(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function Uf(e,t,n){return async function(e,t,n){const r=ba(e);Ll(t instanceof Wh,r.auth,"argument-error");const i=Sf(r.auth,n);await od(!1,r,t.providerId),await Df(i,r.auth);const s=await jf(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function qf(e,t,n=!1){const r=Rh(e),i=Sf(r,t),s=new xf(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function jf(e){const t=Bd(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Vf="__/auth/handler",Bf="emulator/auth/handler";function $f(e,t,n,r,i,s){Ll(e.config.authDomain,e,"auth-domain-config-required"),Ll(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ha,eventId:i};if(t instanceof Wh){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",sa(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Kh){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${Vf}`;return Kl(e,Bf)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}?${aa(a).slice(1)}`}const Wf="webStorageSupport";const Kf=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=bf,this._completeRedirectFn=qf}async _openPopup(e,t,n,r){var i;Ul(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Ef(e,$f(e,t,n,Vl(),r),Bd())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=$f(e,t,n,Vl(),r),Wd().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ul(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await async function(e){const t=await gf(e),n=Wd().gapi;return Ll(n,e,"internal-error"),t.open({where:document.body,url:vf(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yf,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Ol(e,"network-request-failed"),s=Wd().setTimeout((()=>{r(i)}),mf.get());function o(){Wd().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new nf(e);return t.register("authEvent",(t=>{Ll(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Wf,{type:Wf},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),Dl(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await of(e);for(const e of t)try{if(uf(e))return}catch(e){}Dl(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sh()||_h()||Eh()}},zf="facebook.com",Hf="github.com",Gf="google.com",Qf="password",Yf="twitter.com",Jf="EMAIL_SIGNIN",Xf="PASSWORD_RESET",Zf="RECOVER_EMAIL",ep="REVERT_SECOND_FACTOR_ADDITION",tp="VERIFY_AND_CHANGE_EMAIL",np="VERIFY_EMAIL";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const rp=1e12;class ip{constructor(e){this.auth=e,this.counter=rp,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new sp(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||rp;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||rp;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||rp;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class sp{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;Ll(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const op=hf("rcb"),ap=new Wl(3e4,6e4);class cp{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Wd().grecaptcha}load(e,t=""){return Ll(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(Wd().grecaptcha):new Promise(((n,r)=>{const i=Wd().setTimeout((()=>{r(Ol(e,"network-request-failed"))}),ap.get());Wd()[op]=()=>{Wd().clearTimeout(i),delete Wd()[op];const s=Wd().grecaptcha;if(!s)return void r(Ol(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};lf(`https://www.google.com/recaptcha/api.js??${aa({onload:op,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(Ol(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Wd().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class up{async load(e){return new ip(e)}clearedOneInstance(){}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const lp="recaptcha",hp={theme:"light",type:"image"};class dp{constructor(e,t=Object.assign({},hp),n){this.parameters=t,this.type=lp,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Rh(n),this.isInvisible="invisible"===this.parameters.size,Ll("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof e?document.getElementById(e):e;Ll(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new up:new cp,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){Ll(!this.parameters.sitekey,this.auth,"argument-error"),Ll(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ll("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=Wd()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){Ll(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Ll(Bl()&&!Kd(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e){return(await Yl(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);Ll(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Ll(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class fp{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Vh._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function pp(e,t,n){var r;const i=await n.verify();try{let s;if(Ll("string"==typeof i,e,"argument-error"),Ll(n.type===lp,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Ll("enroll"===t.type,e,"internal-error");return(await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e,t){return Yl(e,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo}{Ll("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Ll(n,e,"missing-multi-factor-info");return(await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e,t){return Yl(e,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Yl(e,"POST","/v1/accounts:sendVerificationCode",Ql(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class gp{constructor(e){this.providerId=gp.PROVIDER_ID,this.auth=Rh(e)}verifyPhoneNumber(e,t){return pp(this.auth,e,ba(t))}static credential(e,t){return Vh._fromVerification(e,t)}static credentialFromResult(e){const t=e;return gp.credentialFromTaggedObject(t)}static credentialFromError(e){return gp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Vh._fromTokenResponse(t,n):null}}gp.PROVIDER_ID="phone",gp.PHONE_SIGN_IN_METHOD="phone";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const mp=new Wl(2e3,1e4);class yp extends Nf{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,yp.currentPopupAction&&yp.currentPopupAction.cancel(),yp.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ll(e,this.auth,"internal-error"),e}async onExecution(){Ul(1===this.filter.length,"Popup operations only handle one event");const e=Bd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Ol(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Ol(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yp.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Ol(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,mp.get())};e()}}yp.currentPopupAction=null;class _p extends class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Fl("unexpected MultiFactorSessionType")}}}{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new _p(e)}_finalizeEnroll(e,t,n){return function(e,t){return Yl(e,"POST","/v2/accounts/mfaEnrollment:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return Yl(e,"POST","/v2/accounts/mfaSignIn:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class vp{constructor(){}static assertion(e){return _p._fromCredential(e)}}var wp;
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function bp(){return window}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */wp="Browser",$a(new Ta("auth-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(e=>{Ll(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),Ll(!(null==i?void 0:i.includes(":")),"argument-error",{appName:e.name});const n={apiKey:r,authDomain:i,clientPlatform:wp,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kh(wp)},s=new Ch(e,n);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(jl);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(s,t),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),$a(new Ta("auth-internal",(e=>(e=>new Ld(e))(Rh(e.getProvider("auth-exp").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Ja("@firebase/auth-exp","0.0.900-exp.6ef484a04",function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(wp));async function Tp(e,t,n){var r;const{BuildInfo:i}=bp();Ul(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(Ul(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return Eh()?o.ibi=i.packageName:bh()?o.apn=i.packageName:Dl(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,$f(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function Ip(e){const{cordova:t}=bp();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(e=Uo()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}class Ep extends nf{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function Sp(e){const t=await Rp()._get(Ap(e));return t&&await Rp()._remove(Ap(e)),t}function kp(e,t){var n,r;const i=function(e){const t=Np(e),n=t.link?decodeURIComponent(t.link):void 0,r=Np(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Np(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=Np(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null==s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?Ol(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Cp(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}function Rp(){return jl(jd)}function Ap(e){return ph("authEvent",e.config.apiKey,e.name)}function Np(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return ca(n.join("?"))}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Pp=class{constructor(){this._redirectPersistence=bf,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=qf}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Ep(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){Dl(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,c,u,l;const h=bp();Ll("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Ll(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Ll("function"==typeof(null===(s=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ll("function"==typeof(null===(c=null===(a=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===c?void 0:c.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ll("function"==typeof(null===(l=null===(u=null==h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Pf.clear(),await this._originValidation(e);const s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:Cp(),postBody:null,tenantId:e.tenantId,error:Ol(e,"no-auth-event")}}(e,n,r);await function(e,t){return Rp()._set(Ap(e),t)}(e,s);const o=await Tp(e,s,t);return async function(e,t,n){const{cordova:r}=bp();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function c(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout((()=>{o(Ol(e,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(c),document.addEventListener("resume",u,!1),bh()&&document.addEventListener("visibilitychange",l,!1),i=()=>{t.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",l,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await Ip(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=bp(),n={};Eh()?n.iosBundleId=t.packageName:bh()?n.androidPackageName=t.packageName:Dl(e,"operation-not-supported-in-this-environment"),await of(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=bp(),s=setTimeout((async()=>{await Sp(e),t.onEvent(xp())}),500),o=async n=>{clearTimeout(s);const r=await Sp(e);let i=null;r&&(null==n?void 0:n.url)&&(i=kp(r,n.url)),t.onEvent(i||xp())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,o);const a=r,c=`${i.packageName.toLowerCase()}://`;bp().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"==typeof a)try{a(e)}catch(e){console.error(e)}}}};function xp(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ol("no-auth-event")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Dp(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Op(e=Uo()){return!("file:"!==Dp()&&"ionic:"!==Dp()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Mp(e=Uo()){return $o()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=Uo()){return/Edge\/\d+/.test(e)}(e)}function Lp(){try{const e=self.localStorage,t=Bd();if(e)return e.setItem(t,"1"),e.removeItem(t),!Mp()||Ko()}catch(e){return Fp()&&Ko()}return!1}function Fp(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function Up(){return("http:"===Dp()||"https:"===Dp()||Vo()||Op())&&!(Bo()||jo())&&Lp()&&!Fp()}function qp(){return Op()&&"undefined"!=typeof document}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const jp={LOCAL:"local",NONE:"none",SESSION:"session"},Vp=Ll,Bp="persistence";async function $p(e){await e._initializationPromise;const t=Wp(),n=ph(Bp,e.config.apiKey,e.name);(null==t?void 0:t.sessionStorage)&&t.sessionStorage.setItem(n,e._getPersistence())}function Wp(){return"undefined"!=typeof window?window:null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Kp=Ll,zp=jl(Kf),Hp=jl(Pp);class Gp{constructor(){this.underlyingResolver=null,this._redirectPersistence=bf,this._completeRedirectFn=qf}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return qp()||zp._shouldInitProactively}get assertedUnderlyingResolver(){return Kp(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!qp()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?Hp:zp}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Qp(e){return e.unwrap()}function Yp(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===t.code){t.resolver=new eg(e,function(e,t){var n;const r=ba(e),i=t;return Ll(t.operationType,r,"argument-error"),Ll(null===(n=i.serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Dd._fromError(r,i)}(e,t))}else if(r){const e=Jp(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}function Jp(e){const{_tokenResponse:t}=e instanceof Go?e.customData:e;if(!t)return null;if(!(e instanceof Go)&&"temporaryProof"in t&&"phoneNumber"in t)return gp.credentialFromResult(e);const n=t.providerId;if(!n||n===Qf)return null;let r;switch(n){case Gf:r=Gh;break;case zf:r=Hh;break;case Hf:r=Qh;break;case Yf:r=Jh;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?Yh._create(n,o):qh._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new zh(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof Go?r.credentialFromError(e):r.credentialFromResult(e)}async function Xp(e,t){let n;try{n=await t}catch(t){throw t instanceof Go&&Yp(e,t),t}const{operationType:r,user:i}=n;return{operationType:r,credential:(s=n,Jp(s)),additionalUserInfo:Pd(n),user:tg.getOrCreate(i)};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var s}async function Zp(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>Xp(e,n.confirm(t))}}class eg{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Xp(Qp(this.auth),this.resolver.resolveSignIn(e))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class tg{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=ba(e);return Md.has(t)||Md.set(t,Od._fromUser(t)),Md.get(t)}(e)}static getOrCreate(e){return tg.USER_MAP.has(e)||tg.USER_MAP.set(e,new tg(e)),tg.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Xp(this.auth,ld(this._delegate,e))}async linkWithPhoneNumber(e,t){return Zp(this.auth,async function(e,t,n){const r=ba(e);await od(!1,r,"phone");const i=await pp(r.auth,t,ba(n));return new fp(i,(e=>ld(r,e)))}(this._delegate,e,t))}async linkWithPopup(e){return Xp(this.auth,async function(e,t,n){const r=ba(e);Ll(t instanceof Wh,r.auth,"argument-error");const i=Sf(r.auth,n);return new yp(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Gp))}async linkWithRedirect(e){return await $p(Rh(this.auth)),Uf(this._delegate,e,Gp)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Xp(this.auth,hd(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Zp(this.auth,async function(e,t,n){const r=ba(e),i=await pp(r.auth,t,ba(n));return new fp(i,(e=>hd(r,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return Xp(this.auth,async function(e,t,n){const r=ba(e);Ll(t instanceof Wh,r.auth,"argument-error");const i=Sf(r.auth,n);return new yp(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Gp))}async reauthenticateWithRedirect(e){return await $p(Rh(this.auth)),Ff(this._delegate,e,Gp)}sendEmailVerification(e){return bd(this._delegate,e)}async unlink(e){return await id(this._delegate,e),this}updateEmail(e){return function(e,t){return Ed(ba(e),t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return Ed(ba(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){await sd(ba(e),t)}(this._delegate,e)}updateProfile(e){return Id(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Td(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}tg.USER_MAP=new WeakMap;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const ng=Ll;class rg{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;ng(n,"invalid-api-key",{appName:e.name});let r=[fh];if("undefined"!=typeof window){r=function(e,t){const n=Wp();if(!(null==n?void 0:n.sessionStorage))return[];const r=ph(Bp,e,t);switch(n.sessionStorage.getItem(r)){case jp.NONE:return[fh];case jp.LOCAL:return[tf,bf];case jp.SESSION:return[bf];default:return[]}}(n,e.name);for(const e of[tf,jd])r.includes(e)||r.push(e)}ng(n,"invalid-api-key",{appName:e.name});const i="undefined"!=typeof window?Gp:void 0;this._delegate=t.initialize({options:{persistence:r,popupRedirectResolver:i}}),this._delegate._updateErrorMap(Al),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?tg.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){Nh(this._delegate,e,t)}applyActionCode(e){return yd(this._delegate,e)}checkActionCode(e){return _d(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await Oh(ba(e),{oobCode:t,newPassword:n})}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Xp(this._delegate,async function(e,t,n){const r=Rh(e),i=await Xh(r,{returnSecureToken:!0,email:t,password:n}),s=await Zh._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return wd(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=Bh.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){ng(Up(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await Rh(e)._initializationPromise,qf(e,t,!1)}(this._delegate,Gp);return e?Xp(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){Rh(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=ig(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=ig(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return vd(this._delegate,e,t)}sendPasswordResetEmail(e,t){return md(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){Vp(Object.values(jp).includes(t),e,"invalid-persistence-type"),Bo()?Vp(t!==jp.SESSION,e,"unsupported-persistence-type"):jo()?Vp(t===jp.NONE,e,"unsupported-persistence-type"):Fp()?Vp(t===jp.NONE||t===jp.LOCAL&&Ko(),e,"unsupported-persistence-type"):Vp(t===jp.NONE||Lp(),e,"unsupported-persistence-type")}(this._delegate,e),e){case jp.SESSION:t=bf;break;case jp.LOCAL:t=await jl(tf)._isAvailable()?tf:jd;break;case jp.NONE:t=fh;break;default:return Dl("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Xp(this._delegate,async function(e){var t;const n=Rh(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Zh({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Xh(n,{returnSecureToken:!0}),i=await Zh._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return Xp(this._delegate,ud(this._delegate,e))}signInWithCustomToken(e){return Xp(this._delegate,dd(this._delegate,e))}signInWithEmailAndPassword(e,t){return Xp(this._delegate,function(e,t,n){return ud(ba(e),$h.credential(t,n))}(this._delegate,e,t))}signInWithEmailLink(e,t){return Xp(this._delegate,async function(e,t,n){const r=ba(e),i=$h.credentialWithLink(t,n||Vl());return Ll(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),ud(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Zp(this._delegate,async function(e,t,n){const r=Rh(e),i=await pp(r,t,ba(n));return new fp(i,(e=>ud(r,e)))}(this._delegate,e,t))}async signInWithPopup(e){return ng(Up(),this._delegate,"operation-not-supported-in-this-environment"),Xp(this._delegate,async function(e,t,n){const r=Rh(e);Ll(t instanceof Wh,e,"argument-error");const i=Sf(r,n);return new yp(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,Gp))}async signInWithRedirect(e){return ng(Up(),this._delegate,"operation-not-supported-in-this-environment"),await $p(this._delegate),Lf(this._delegate,e,Gp)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await _d(ba(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function ig(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&tg.getOrCreate(e)),error:t,complete:n}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class sg{constructor(){this.providerId="phone",this._delegate=new gp(Qp(oc.auth()))}static credential(e,t){return gp.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}sg.PHONE_SIGN_IN_METHOD=gp.PHONE_SIGN_IN_METHOD,sg.PROVIDER_ID=gp.PROVIDER_ID;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const og=Ll;class ag{constructor(e,t,n=oc.app()){var r;og(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new dp(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var cg;(cg=oc).INTERNAL.registerComponent(new Ta("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth-exp");return new rg(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Jf,PASSWORD_RESET:Xf,RECOVER_EMAIL:Zf,REVERT_SECOND_FACTOR_ADDITION:ep,VERIFY_AND_CHANGE_EMAIL:tp,VERIFY_EMAIL:np}},EmailAuthProvider:$h,FacebookAuthProvider:Hh,GithubAuthProvider:Qh,GoogleAuthProvider:Gh,OAuthProvider:zh,PhoneAuthProvider:sg,PhoneMultiFactorGenerator:vp,RecaptchaVerifier:ag,TwitterAuthProvider:Jh,Auth:{Persistence:jp},AuthCredential:Dh}).setInstantiationMode("LAZY").setMultipleInstances(!1)),cg.registerVersion("@firebase/auth-compat","0.0.900-exp.6ef484a04");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let ug="";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class lg{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Zo(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Xo(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hg{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ra(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const dg=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new lg(t)}}catch(e){}return new hg},fg=dg("localStorage"),pg=dg("sessionStorage"),gg=new Da("@firebase/database"),mg=function(){let e=1;return function(){return e++}}(),yg=function(e){const t=_a(e),n=new la;n.update(t);const r=n.digest();return Po.encodeByteArray(r)},_g=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=_g.apply(null,r):t+="object"==typeof r?Zo(r):r,t+=" "}return t};let vg=null,wg=!0;const bg=function(e,t){Ro(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(gg.logLevel=ka.VERBOSE,vg=gg.log.bind(gg),t&&pg.set("logging_enabled",!0)):"function"==typeof e?vg=e:(vg=null,pg.remove("logging_enabled"))},Tg=function(...e){if(!0===wg&&(wg=!1,null===vg&&!0===pg.get("logging_enabled")&&bg(!0)),vg){const t=_g.apply(null,e);vg(t)}},Ig=function(e){return function(...t){Tg(e,...t)}},Eg=function(...e){const t="FIREBASE INTERNAL ERROR: "+_g(...e);gg.error(t)},Sg=function(...e){const t=`FIREBASE FATAL ERROR: ${_g(...e)}`;throw gg.error(t),new Error(t)},kg=function(...e){const t="FIREBASE WARNING: "+_g(...e);gg.warn(t)},Cg=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Rg="[MIN_NAME]",Ag="[MAX_NAME]",Ng=function(e,t){if(e===t)return 0;if(e===Rg||t===Ag)return-1;if(t===Rg||e===Ag)return 1;{const n=jg(e),r=jg(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Pg=function(e,t){return e===t?0:e<t?-1:1},xg=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Zo(t))},Dg=function(e){if("object"!=typeof e||null===e)return Zo(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=Zo(t[r]),n+=":",n+=Dg(e[t[r]]);return n+="}",n},Og=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Mg(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Lg=function(e){Ro(!Cg(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const Fg=new RegExp("^-?(0*)\\d{1,10}$"),Ug=-2147483648,qg=2147483647,jg=function(e){if(Fg.test(e)){const t=Number(e);if(t>=Ug&&t<=qg)return t}return null},Vg=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw kg("Exception was thrown by user callback.",t),e}),Math.floor(0))}},Bg=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class $g{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){kg(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Wg{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Tg("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',kg(e)}}class Kg{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Kg.OWNER="owner";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const zg=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Hg="websocket",Gg="long_polling";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Qg{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=fg.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&fg.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Yg(e,t,n){let r;if(Ro("string"==typeof t,"typeof type must == string"),Ro("object"==typeof n,"typeof params must == object"),t===Hg)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Gg)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Mg(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Jg{constructor(){this.counters_={}}incrementCounter(e,t=1){ra(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Oo(this.counters_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Xg={},Zg={};function em(e){const t=e.toString();return Xg[t]||(Xg[t]=new Jg),Xg[t]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class tm{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Vg((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const nm="start";class rm{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ig(e),this.stats_=em(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),Yg(t,Gg,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new tm(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new im(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===nm)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&zg.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){rm.forceAllow_=!0}static forceDisallow(){rm.forceDisallow_=!0}static isAvailable(){return!!rm.forceAllow_||!(rm.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Zo(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=xo(t),r=Og(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Zo(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class im{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=mg(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=im.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Tg("frame writing exception"),e.stack&&Tg(e.stack),Tg(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Tg("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Tg("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let sm=null;"undefined"!=typeof MozWebSocket?sm=MozWebSocket:"undefined"!=typeof WebSocket&&(sm=WebSocket);class om{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ig(this.connId),this.stats_=em(t),this.connURL=om.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&zg.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),Yg(e,Hg,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,fg.set("previous_websocket_failure",!0);try{if(Wo());else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new sm(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){om.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==sm&&!om.forceDisallow_}static previouslyFailed(){return fg.isInMemoryStorage||!0===fg.get("previous_websocket_failure")}markConnectionHealthy(){fg.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Xo(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Ro(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=Zo(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Og(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}om.responsesRequiredToBeHealthy=2,om.healthyTimeout=3e4;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class am{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[rm,om]}initTransports_(e){const t=om&&om.isAvailable();let n=t&&!om.previouslyFailed();if(e.webSocketOnly&&(t||kg("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[om];else{const e=this.transports_=[];for(const t of am.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cm{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ig("c:"+this.id+":"),this.transportManager_=new am(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Bg((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=xg("t",e),n=xg("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=xg("t",e),n=xg("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=xg("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Eg("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Eg("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&kg("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Bg((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bg((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(fg.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class um{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lm{constructor(e){this.allowedEvents_=e,this.listeners_={},Ro(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){Ro(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hm extends lm{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||qo()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new hm}getInitialEvent(e){return Ro("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class dm{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function fm(){return new dm("")}function pm(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function gm(e){return e.pieces_.length-e.pieceNum_}function mm(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new dm(e.pieces_,t)}function ym(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function _m(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function vm(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new dm(t,0)}function wm(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof dm)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new dm(n,0)}function bm(e){return e.pieceNum_>=e.pieces_.length}function Tm(e,t){const n=pm(e),r=pm(t);if(null===n)return t;if(n===r)return Tm(mm(e),mm(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Im(e,t){const n=_m(e,0),r=_m(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=Ng(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function Em(e,t){if(gm(e)!==gm(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Sm(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(gm(e)>gm(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class km{constructor(e,t){this.errorPrefix_=t,this.parts_=_m(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=va(this.parts_[e]);Cm(this)}}function Cm(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Rm(e))}function Rm(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Am extends lm{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Am}getInitialEvent(e){return Ro("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Nm=1e3;class Pm extends um{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Pm.nextPersistentConnectionId_++,this.log_=Ig("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Nm,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Wo())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Am.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&hm.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Zo(i)),Ro(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Lo,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Ro(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ro(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;Pm.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&ra(e,"w")){const n=ia(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();kg(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||na(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=ta(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Ro(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Zo(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Eg("Unrecognized action received from server: "+Zo(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Ro(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Nm,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Nm,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Nm),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Pm.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){Ro(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?Tg("getToken() completed but was canceled"):(Tg("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new cm(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{kg(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&kg(e),a())}}}interrupt(e){Tg("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Tg("Resuming connection for reason: "+e),delete this.interruptReasons_[e],sa(this.interruptReasons_)&&(this.reconnectDelay_=Nm,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Dg(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new dm(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Tg("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Tg("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+ug.replace(/\./g,"-")]=1,qo()?e["framework.cordova"]=1:Bo()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=hm.getInstance().currentlyOnline();return sa(this.interruptReasons_)&&e}}Pm.nextPersistentConnectionId_=0,Pm.nextConnectionId_=0;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class xm{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new xm(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Dm{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new xm(Rg,e),r=new xm(Rg,t);return 0!==this.compare(n,r)}minPost(){return xm.MIN}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Om;class Mm extends Dm{static get __EMPTY_NODE(){return Om}static set __EMPTY_NODE(e){Om=e}compare(e,t){return Ng(e.name,t.name)}isDefinedOn(e){throw Ao("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return xm.MIN}maxPost(){return new xm(Ag,Om)}makePost(e,t){return Ro("string"==typeof e,"KeyIndex indexValue must always be a string."),new xm(e,Om)}toString(){return".key"}}const Lm=new Mm;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Fm{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Um{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Um.RED,this.left=null!=r?r:qm.EMPTY_NODE,this.right=null!=i?i:qm.EMPTY_NODE}copy(e,t,n,r,i){return new Um(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return qm.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return qm.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Um.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Um.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Um.RED=!0,Um.BLACK=!1;class qm{constructor(e,t=qm.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new qm(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Um.BLACK,null,null))}remove(e){return new qm(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Um.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Fm(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Fm(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Fm(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Fm(this.root_,null,this.comparator_,!0,e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function jm(e,t){return Ng(e.name,t.name)}function Vm(e,t){return Ng(e,t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Bm;qm.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Um(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const $m=function(e){return"number"==typeof e?"number:"+Lg(e):"string:"+e},Wm=function(e){if(e.isLeafNode()){const t=e.val();Ro("string"==typeof t||"number"==typeof t||"object"==typeof t&&ra(t,".sv"),"Priority must be a string or number.")}else Ro(e===Bm||e.isEmpty(),"priority of unexpected type.");Ro(e===Bm||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Km,zm,Hm;class Gm{constructor(e,t=Gm.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Ro(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Wm(this.priorityNode_)}static set __childrenNodeConstructor(e){Km=e}static get __childrenNodeConstructor(){return Km}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Gm(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Gm.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return bm(e)?this:".priority"===pm(e)?this.priorityNode_:Gm.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Gm.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=pm(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(Ro(".priority"!==n||1===gm(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Gm.__childrenNodeConstructor.EMPTY_NODE.updateChild(mm(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+$m(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Lg(this.value_):this.value_,this.lazyHash_=yg(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Gm.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Gm.__childrenNodeConstructor?-1:(Ro(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Gm.VALUE_TYPE_ORDER.indexOf(t),i=Gm.VALUE_TYPE_ORDER.indexOf(n);return Ro(r>=0,"Unknown leaf type: "+t),Ro(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Gm.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Qm=new class extends Dm{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Ng(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return xm.MIN}maxPost(){return new xm(Ag,new Gm("[PRIORITY-POST]",Hm))}makePost(e,t){const n=zm(e);return new xm(t,new Gm("[PRIORITY-POST]",n))}toString(){return".priority"}},Ym=Math.log(2);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Jm{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Ym,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Xm=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Um(a,o.node,Um.BLACK,null,null);{const c=parseInt(s/2,10)+t,u=i(t,c),l=i(c+1,r);return o=e[c],a=n?n(o):o,new Um(a,o.node,Um.BLACK,u,l)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const u=i(s+1,a),l=e[s],h=n?n(l):l;c(new Um(h,l.node,r,null,u))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Um.BLACK):(a(r,Um.BLACK),a(r,Um.RED))}return s}(new Jm(e.length));return new qm(r||t,s)};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Zm;const ey={};class ty{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Ro(ey&&Qm,"ChildrenNode.ts has not been loaded"),Zm=Zm||new ty({".priority":ey},{".priority":Qm}),Zm}get(e){const t=ia(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof qm?t:null}hasIndex(e){return ra(this.indexSet_,e.toString())}addIndex(e,t){Ro(e!==Lm,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(xm.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?Xm(n,e.getCompare()):ey;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=s,new ty(u,c)}addToIndexes(e,t){const n=oa(this.indexes_,((n,r)=>{const i=ia(this.indexSet_,r);if(Ro(i,"Missing index implementation for "+r),n===ey){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(xm.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),Xm(n,i.getCompare())}return ey}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new xm(e.name,r))),i.insert(e,e.node)}}));return new ty(n,this.indexSet_)}removeFromIndexes(e,t){const n=oa(this.indexes_,(n=>{if(n===ey)return n;{const r=t.get(e.name);return r?n.remove(new xm(e.name,r)):n}}));return new ty(n,this.indexSet_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let ny;class ry{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Wm(this.priorityNode_),this.children_.isEmpty()&&Ro(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ny||(ny=new ry(new qm(Vm),null,ty.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ny}updatePriority(e){return this.children_.isEmpty()?this:new ry(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?ny:t}}getChild(e){const t=pm(e);return null===t?this:this.getImmediateChild(t).getChild(mm(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Ro(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new xm(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?ny:this.priorityNode_;return new ry(r,s,i)}}updateChild(e,t){const n=pm(e);if(null===n)return t;{Ro(".priority"!==pm(e)||1===gm(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(mm(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(Qm,((s,o)=>{t[s]=o.val(e),n++,i&&ry.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+$m(this.getPriority().val())+":"),this.forEachChild(Qm,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":yg(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new xm(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new xm(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new xm(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,xm.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,xm.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===iy?-1:0}withIndex(e){if(e===Lm||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ry(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Lm||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Qm),n=t.getIterator(Qm);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Lm?null:this.indexMap_.get(e.toString())}}ry.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const iy=new class extends ry{constructor(){super(new qm(Vm),ry.EMPTY_NODE,ty.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ry.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(xm,{MIN:{value:new xm(Rg,ry.EMPTY_NODE)},MAX:{value:new xm(Ag,iy)}}),Mm.__EMPTY_NODE=ry.EMPTY_NODE,Gm.__childrenNodeConstructor=ry,Bm=iy,function(e){Hm=e}(iy);function sy(e,t=null){if(null===e)return ry.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Ro(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new Gm(e,sy(t))}if(e instanceof Array){let n=ry.EMPTY_NODE;return Mg(e,((t,r)=>{if(ra(e,t)&&"."!==t.substring(0,1)){const e=sy(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(sy(t))}{const n=[];let r=!1;if(Mg(e,((e,t)=>{if("."!==e.substring(0,1)){const i=sy(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new xm(e,i)))}})),0===n.length)return ry.EMPTY_NODE;const i=Xm(n,jm,(e=>e.name),Vm);if(r){const e=Xm(n,Qm.getCompare());return new ry(i,sy(t),new ty({".priority":e},{".priority":Qm}))}return new ry(i,sy(t),ty.Default)}}!function(e){zm=e}(sy);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class oy extends Dm{constructor(e){super(),this.indexPath_=e,Ro(!bm(e)&&".priority"!==pm(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Ng(e.name,t.name):i}makePost(e,t){const n=sy(e),r=ry.EMPTY_NODE.updateChild(this.indexPath_,n);return new xm(t,r)}maxPost(){const e=ry.EMPTY_NODE.updateChild(this.indexPath_,iy);return new xm(Ag,e)}toString(){return _m(this.indexPath_,0).join("/")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ay=new class extends Dm{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Ng(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return xm.MIN}maxPost(){return xm.MAX}makePost(e,t){const n=sy(e);return new xm(t,n)}toString(){return".value"}},cy="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",uy=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=cy.charAt(n%64),n=Math.floor(n/64);Ro(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=cy.charAt(t[i]);return Ro(20===o.length,"nextPushId: Length should be 20."),o}}(),ly=function(e){if("2147483647"===e)return"-";const t=jg(e);if(null!=t)return""+(t+1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);if(n.length<786)return n.push("-"),n.join("");let r=n.length-1;for(;r>=0&&"z"===n[r];)r--;if(-1===r)return Ag;const i=n[r],s=cy.charAt(cy.indexOf(i)+1);return n[r]=s,n.slice(0,r+1).join("")},hy=function(e){if("-2147483648"===e)return Rg;const t=jg(e);if(null!=t)return""+(t-1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=cy.charAt(cy.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function dy(e){return{type:"value",snapshotNode:e}}function fy(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function py(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function gy(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class my{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){Ro(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(py(t,o)):Ro(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(fy(t,n)):s.trackChildChange(gy(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Qm,((e,r)=>{t.hasChild(e)||n.trackChildChange(py(e,r))})),t.isLeafNode()||t.forEachChild(Qm,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(gy(t,r,i))}else n.trackChildChange(fy(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ry.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yy{constructor(e){this.indexedFilter_=new my(e.getIndex()),this.index_=e.getIndex(),this.startPost_=yy.getStartPost_(e),this.endPost_=yy.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,s){return this.matches(new xm(t,n))||(n=ry.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=ry.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(ry.EMPTY_NODE);const i=this;return t.forEachChild(Qm,((e,t)=>{i.matches(new xm(e,t))||(r=r.updateImmediateChild(e,ry.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _y{constructor(e){this.rangedFilter_=new yy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new xm(t,n))||(n=ry.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=ry.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=ry.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let i;if(i=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!i)break;r=r.updateImmediateChild(t.name,t.node),n++}}else{let e,n,i,s;if(r=t.withIndex(this.index_),r=r.updatePriority(ry.EMPTY_NODE),this.reverse_){s=r.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();i=(e,n)=>t(n,e)}else s=r.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),i=this.index_.getCompare();let o=0,a=!1;for(;s.hasNext();){const t=s.getNext();!a&&i(e,t)<=0&&(a=!0);a&&o<this.limit_&&i(t,n)<=0?o++:r=r.updateImmediateChild(t.name,ry.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;Ro(o.numChildren()===this.limit_,"");const a=new xm(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let l=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=l&&(l.name===t||o.hasChild(l.name));)l=r.getChildAfterChild(this.index_,l,this.reverse_);const h=null==l?1:s(l,a);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(gy(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(py(t,e));const n=o.updateImmediateChild(t,ry.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=i&&i.trackChildChange(fy(l.name,l.node)),n.updateImmediateChild(l.name,l.node)):n}}return n.isEmpty()?e:u&&s(c,a)>=0?(null!=i&&(i.trackChildChange(py(c.name,c.node)),i.trackChildChange(fy(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,ry.EMPTY_NODE)):e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vy{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Qm}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Ro(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Ro(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Rg}hasEnd(){return this.endSet_}getIndexEndValue(){return Ro(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Ro(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ag}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Ro(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Qm}copy(){const e=new vy;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function wy(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function by(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Ty(e,t){const n=e.copy();return n.index_=t,n}function Iy(e){const t={};if(e.isDefault())return t;let n;return e.index_===Qm?n="$priority":e.index_===ay?n="$value":e.index_===Lm?n="$key":(Ro(e.index_ instanceof oy,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=Zo(n),e.startSet_&&(t.startAt=Zo(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+Zo(e.indexStartName_))),e.endSet_&&(t.endAt=Zo(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+Zo(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Ey(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Qm&&(t.i=e.index_.toString()),t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Sy extends um{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Ig("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Ro(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=Sy.getListenId_(e,n),o={};this.listens_[s]=o;const a=Iy(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),ia(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Sy.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Iy(e._queryParams),n=e._path.toString(),r=new Lo;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+aa(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=Xo(o.responseText)}catch(e){kg("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&kg("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ky{constructor(){this.rootNode_=ry.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Cy(){return{value:null,children:new Map}}function Ry(e,t,n){if(bm(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=pm(t);e.children.has(r)||e.children.set(r,Cy());Ry(e.children.get(r),t=mm(t),n)}}function Ay(e,t){if(bm(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(Qm,((t,n)=>{Ry(e,new dm(t),n)})),Ay(e,t)}}if(e.children.size>0){const n=pm(t);if(t=mm(t),e.children.has(n)){Ay(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function Ny(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,((e,r)=>{Ny(r,new dm(t.toString()+"/"+e),n)}))}class Py{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Mg(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xy{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Py(e);const n=1e4+2e4*Math.random();Bg(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Mg(e,((e,r)=>{r>0&&ra(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),Bg(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Dy;function Oy(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Dy||(Dy={}));class My{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Dy.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(bm(this.path)){if(null!=this.affectedTree.value)return Ro(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new dm(e));return new My(fm(),t,this.revert)}}return Ro(pm(this.path)===e,"operationForChild called for unrelated child."),new My(mm(this.path),this.affectedTree,this.revert)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ly{constructor(e,t){this.source=e,this.path=t,this.type=Dy.LISTEN_COMPLETE}operationForChild(e){return bm(this.path)?new Ly(this.source,fm()):new Ly(this.source,mm(this.path))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Fy{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Dy.OVERWRITE}operationForChild(e){return bm(this.path)?new Fy(this.source,fm(),this.snap.getImmediateChild(e)):new Fy(this.source,mm(this.path),this.snap)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Uy{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Dy.MERGE}operationForChild(e){if(bm(this.path)){const t=this.children.subtree(new dm(e));return t.isEmpty()?null:t.value?new Fy(this.source,fm(),t.value):new Uy(this.source,fm(),t)}return Ro(pm(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Uy(this.source,mm(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qy{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(bm(e))return this.isFullyInitialized()&&!this.filtered_;const t=pm(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class jy{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Vy(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Ao("Should only compare child_ events.");const r=new xm(t.childName,t.snapshotNode),i=new xm(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function By(e,t){return{eventCache:e,serverCache:t}}function $y(e,t,n,r){return By(new qy(t,n,r),e.serverCache)}function Wy(e,t,n,r){return By(e.eventCache,new qy(t,n,r))}function Ky(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function zy(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Hy;class Gy{constructor(e,t=(()=>(Hy||(Hy=new qm(Pg)),Hy))()){this.value=e,this.children=t}static fromObject(e){let t=new Gy(null);return Mg(e,((e,n)=>{t=t.set(new dm(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:fm(),value:this.value};if(bm(e))return null;{const n=pm(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(mm(e),t);if(null!=i){return{path:wm(new dm(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(bm(e))return this;{const t=pm(e),n=this.children.get(t);return null!==n?n.subtree(mm(e)):new Gy(null)}}set(e,t){if(bm(e))return new Gy(t,this.children);{const n=pm(e),r=(this.children.get(n)||new Gy(null)).set(mm(e),t),i=this.children.insert(n,r);return new Gy(this.value,i)}}remove(e){if(bm(e))return this.children.isEmpty()?new Gy(null):new Gy(null,this.children);{const t=pm(e),n=this.children.get(t);if(n){const r=n.remove(mm(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Gy(null):new Gy(this.value,i)}return this}}get(e){if(bm(e))return this.value;{const t=pm(e),n=this.children.get(t);return n?n.get(mm(e)):null}}setTree(e,t){if(bm(e))return t;{const n=pm(e),r=(this.children.get(n)||new Gy(null)).setTree(mm(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Gy(this.value,i)}}fold(e){return this.fold_(fm(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(wm(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,fm(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(bm(e))return null;{const r=pm(e),i=this.children.get(r);return i?i.findOnPath_(mm(e),wm(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,fm(),t)}foreachOnPath_(e,t,n){if(bm(e))return this;{this.value&&n(t,this.value);const r=pm(e),i=this.children.get(r);return i?i.foreachOnPath_(mm(e),wm(t,r),n):new Gy(null)}}foreach(e){this.foreach_(fm(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(wm(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Qy{constructor(e){this.writeTree_=e}static empty(){return new Qy(new Gy(null))}}function Yy(e,t,n){if(bm(t))return new Qy(new Gy(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Tm(i,t);return s=s.updateChild(o,n),new Qy(e.writeTree_.set(i,s))}{const r=new Gy(n),i=e.writeTree_.setTree(t,r);return new Qy(i)}}}function Jy(e,t,n){let r=e;return Mg(n,((e,n)=>{r=Yy(r,wm(t,e),n)})),r}function Xy(e,t){if(bm(t))return Qy.empty();{const n=e.writeTree_.setTree(t,new Gy(null));return new Qy(n)}}function Zy(e,t){return null!=e_(e,t)}function e_(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Tm(n.path,t)):null}function t_(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Qm,((e,n)=>{t.push(new xm(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new xm(e,n.value))})),t}function n_(e,t){if(bm(t))return e;{const n=e_(e,t);return new Qy(null!=n?new Gy(n):e.writeTree_.subtree(t))}}function r_(e){return e.writeTree_.isEmpty()}function i_(e,t){return s_(fm(),e.writeTree_,t)}function s_(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(Ro(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=s_(wm(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(wm(e,".priority"),r)),n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function o_(e,t){return v_(t,e)}function a_(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));Ro(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&c_(t,r.path)?i=!1:Sm(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=l_(e.allWrites,u_,fm()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=Xy(e.visibleWrites,r.path);else{Mg(r.children,(t=>{e.visibleWrites=Xy(e.visibleWrites,wm(r.path,t))}))}return!0}return!1}function c_(e,t){if(e.snap)return Sm(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Sm(wm(e.path,n),t))return!0;return!1}function u_(e){return e.visible}function l_(e,t,n){let r=Qy.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)Sm(n,e)?(t=Tm(n,e),r=Yy(r,t,s.snap)):Sm(e,n)&&(t=Tm(e,n),r=Yy(r,fm(),s.snap.getChild(t)));else{if(!s.children)throw Ao("WriteRecord should have .snap or .children");if(Sm(n,e))t=Tm(n,e),r=Jy(r,t,s.children);else if(Sm(e,n))if(t=Tm(e,n),bm(t))r=Jy(r,fm(),s.children);else{const e=ia(s.children,pm(t));if(e){const n=e.getChild(mm(t));r=Yy(r,fm(),n)}}}}}return r}function h_(e,t,n,r,i){if(r||i){const s=n_(e.visibleWrites,t);if(!i&&r_(s))return n;if(i||null!=n||Zy(s,fm())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Sm(e.path,t)||Sm(t,e.path))};return i_(l_(e.allWrites,s,t),n||ry.EMPTY_NODE)}return null}{const r=e_(e.visibleWrites,t);if(null!=r)return r;{const r=n_(e.visibleWrites,t);if(r_(r))return n;if(null!=n||Zy(r,fm())){return i_(r,n||ry.EMPTY_NODE)}return null}}}function d_(e,t,n,r){return h_(e.writeTree,e.treePath,t,n,r)}function f_(e,t){return function(e,t,n){let r=ry.EMPTY_NODE;const i=e_(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Qm,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=n_(e.visibleWrites,t);return n.forEachChild(Qm,((e,t)=>{const n=i_(n_(i,new dm(e)),t);r=r.updateImmediateChild(e,n)})),t_(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return t_(n_(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function p_(e,t,n,r){return function(e,t,n,r,i){Ro(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=wm(t,n);if(Zy(e.visibleWrites,s))return null;{const t=n_(e.visibleWrites,s);return r_(t)?i.getChild(n):i_(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function g_(e,t){return function(e,t){return e_(e.visibleWrites,t)}(e.writeTree,wm(e.treePath,t))}function m_(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=n_(e.visibleWrites,t),u=e_(c,fm());if(null!=u)a=u;else{if(null==n)return[];a=i_(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function y_(e,t,n){return function(e,t,n,r){const i=wm(t,n),s=e_(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return i_(n_(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function __(e,t){return v_(wm(e.treePath,t),e.writeTree)}function v_(e,t){return{treePath:e,writeTree:t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class w_{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;Ro("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Ro(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,gy(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,py(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,fy(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ao("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,gy(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const b_=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class T_{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new qy(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return y_(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:zy(this.viewCache_),i=m_(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function I_(e,t,n,r,i){const s=new w_;let o,a;if(n.type===Dy.OVERWRITE){const c=n;c.source.fromUser?o=k_(e,t,c.path,c.snap,r,i,s):(Ro(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!bm(c.path),o=S_(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===Dy.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const u=wm(n,r);C_(t,pm(u))&&(a=k_(e,a,u,c,i,s,o))})),r.foreach(((r,c)=>{const u=wm(n,r);C_(t,pm(u))||(a=k_(e,a,u,c,i,s,o))})),a}(e,t,c.path,c.children,r,i,s):(Ro(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=A_(e,t,c.path,c.children,r,i,a,s))}else if(n.type===Dy.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=g_(r,n))return t;{const a=new T_(r,t,i),c=t.eventCache.getNode();let u;if(bm(n)||".priority"===pm(n)){let n;if(t.serverCache.isFullyInitialized())n=d_(r,zy(t));else{const e=t.serverCache.getNode();Ro(e instanceof ry,"serverChildren would be complete if leaf node"),n=f_(r,e)}n=n,u=e.filter.updateFullNode(c,n,s)}else{const i=pm(n);let l=y_(r,i,t.serverCache);null==l&&t.serverCache.isCompleteForChild(i)&&(l=c.getImmediateChild(i)),u=null!=l?e.filter.updateChild(c,i,l,mm(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,ry.EMPTY_NODE,mm(n),a,s):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=d_(r,zy(t)),o.isLeafNode()&&(u=e.filter.updateFullNode(u,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=g_(r,fm()),$y(t,u,o,e.filter.filtersNodes())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=g_(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(bm(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return S_(e,t,n,c.getNode().getChild(n),i,s,a,o);if(bm(n)){let r=new Gy(null);return c.getNode().forEachChild(Lm,((e,t)=>{r=r.set(new dm(e),t)})),A_(e,t,n,r,i,s,a,o)}return t}{let u=new Gy(null);return r.foreach(((e,t)=>{const r=wm(n,e);c.isCompleteForPath(r)&&(u=u.set(e,c.getNode().getChild(r)))})),A_(e,t,n,u,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==Dy.LISTEN_COMPLETE)throw Ao("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=Wy(t,s.getNode(),s.isFullyInitialized()||bm(n),s.isFiltered());return E_(e,o,n,r,b_,i)}(e,t,n.path,r,s)}const c=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Ky(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(dy(Ky(t)))}}(t,o,c),{viewCache:o,changes:c}}function E_(e,t,n,r,i,s){const o=t.eventCache;if(null!=g_(r,n))return t;{let a,c;if(bm(n))if(Ro(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=zy(t),i=f_(r,n instanceof ry?n:ry.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=d_(r,zy(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const u=pm(n);if(".priority"===u){Ro(1===gm(n),"Can't have a priority with additional path components");const i=o.getNode();c=t.serverCache.getNode();const s=p_(r,n,i,c);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const l=mm(n);let h;if(o.isCompleteForChild(u)){c=t.serverCache.getNode();const e=p_(r,n,o.getNode(),c);h=null!=e?o.getNode().getImmediateChild(u).updateChild(l,e):o.getNode().getImmediateChild(u)}else h=y_(r,u,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),u,h,l,i,s):o.getNode()}}return $y(t,a,o.isFullyInitialized()||bm(n),e.filter.filtersNodes())}}function S_(e,t,n,r,i,s,o,a){const c=t.serverCache;let u;const l=o?e.filter:e.filter.getIndexedFilter();if(bm(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),e,null)}else{const e=pm(n);if(!c.isCompleteForPath(n)&&gm(n)>1)return t;const i=mm(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);u=".priority"===e?l.updatePriority(c.getNode(),s):l.updateChild(c.getNode(),e,s,i,b_,null)}const h=Wy(t,u,c.isFullyInitialized()||bm(n),l.filtersNodes());return E_(e,h,n,i,new T_(i,h,s),a)}function k_(e,t,n,r,i,s,o){const a=t.eventCache;let c,u;const l=new T_(i,t,s);if(bm(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=$y(t,u,!0,e.filter.filtersNodes());else{const i=pm(n);if(".priority"===i)u=e.filter.updatePriority(t.eventCache.getNode(),r),c=$y(t,u,a.isFullyInitialized(),a.isFiltered());else{const s=mm(n),u=a.getNode().getImmediateChild(i);let h;if(bm(s))h=r;else{const e=l.getCompleteChild(i);h=null!=e?".priority"===ym(s)&&e.getChild(vm(s)).isEmpty()?e:e.updateChild(s,r):ry.EMPTY_NODE}if(u.equals(h))c=t;else{c=$y(t,e.filter.updateChild(a.getNode(),i,h,s,l,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function C_(e,t){return e.eventCache.isCompleteForChild(t)}function R_(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function A_(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,u=t;c=bm(n)?r:new Gy(null).setTree(n,r);const l=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const c=R_(0,t.serverCache.getNode().getImmediateChild(n),r);u=S_(e,u,new dm(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!c){const c=R_(0,t.serverCache.getNode().getImmediateChild(n),r);u=S_(e,u,new dm(n),c,i,s,o,a)}})),u}class N_{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new my(n.getIndex()),i=(s=n).loadsAllData()?new my(s.getIndex()):s.hasLimit()?new _y(s):new yy(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(ry.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(ry.EMPTY_NODE,a.getNode(),null),l=new qy(c,o.isFullyInitialized(),r.filtersNodes()),h=new qy(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=By(h,l),this.eventGenerator_=new jy(this.query_)}get query(){return this.query_}}function P_(e,t){const n=zy(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!bm(t)&&!n.getImmediateChild(pm(t)).isEmpty())?n.getChild(t):null}function x_(e){return 0===e.eventRegistrations_.length}function D_(e,t,n){const r=[];if(n){Ro(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function O_(e,t,n,r){t.type===Dy.MERGE&&null!==t.source.queryId&&(Ro(zy(e.viewCache_),"We should always have a full cache before handling merges"),Ro(Ky(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=I_(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,Ro(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),Ro(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),Ro(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,M_(e,s.changes,s.viewCache.eventCache.getNode(),null)}function M_(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Vy(e,i,"child_removed",t,r,n),Vy(e,i,"child_added",t,r,n),Vy(e,i,"child_moved",s,r,n),Vy(e,i,"child_changed",t,r,n),Vy(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let L_,F_;class U_{constructor(){this.views=new Map}}function q_(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return Ro(null!=s,"SyncTree gave us an op for an invalid query."),O_(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(O_(s,t,n,r));return i}}function j_(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=d_(n,i?r:null),s=!1;e?s=!0:r instanceof ry?(e=f_(n,r),s=!1):(e=ry.EMPTY_NODE,s=!1);const o=By(new qy(e,s,!1),new qy(r,i,!1));return new N_(t,o)}return o}function V_(e,t,n,r,i,s){const o=j_(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(Qm,((e,t)=>{r.push(fy(e,t))}));return n.isFullyInitialized()&&r.push(dy(n.getNode())),M_(e,r,n.getNode(),t)}(o,n)}function B_(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=H_(e);if("default"===i)for(const[t,i]of e.views.entries())o=o.concat(D_(i,n,r)),x_(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{const t=e.views.get(i);t&&(o=o.concat(D_(t,n,r)),x_(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!H_(e)&&s.push(new(Ro(L_,"Reference.ts has not been loaded"),L_)(t._repo,t._path)),{removed:s,events:o}}function $_(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function W_(e,t){let n=null;for(const r of e.views.values())n=n||P_(r,t);return n}function K_(e,t){if(t._queryParams.loadsAllData())return G_(e);{const n=t._queryIdentifier;return e.views.get(n)}}function z_(e,t){return null!=K_(e,t)}function H_(e){return null!=G_(e)}function G_(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Q_=1;class Y_{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Gy(null),this.pendingWriteTree_={visibleWrites:Qy.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function J_(e,t,n,r,i){return function(e,t,n,r,i){Ro(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Yy(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?sv(e,new Fy({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function X_(e,t,n,r){!function(e,t,n,r){Ro(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Jy(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=Gy.fromObject(n);return sv(e,new Uy({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function Z_(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(a_(e.pendingWriteTree_,t)){let t=new Gy(null);return null!=r.snap?t=t.set(fm(),!0):Mg(r.children,(e=>{t=t.set(new dm(e),!0)})),sv(e,new My(r.path,t,n))}return[]}function ev(e,t,n){return sv(e,new Fy({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function tv(e,t,n,r){const i=t._path,s=e.syncPointTree_.get(i);let o=[];if(s&&("default"===t._queryIdentifier||z_(s,t))){const a=B_(s,t,n,r);0===s.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));const c=a.removed;o=a.events;const u=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),l=e.syncPointTree_.findOnPath(i,((e,t)=>H_(t)));if(u&&!l){const t=e.syncPointTree_.subtree(i);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&H_(t)){return[G_(t)]}{let e=[];return t&&(e=$_(t)),Mg(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=cv(e,r);e.listenProvider_.startListening(pv(i),uv(e,i),s.hashFn,s.onComplete)}}}if(!l&&c.length>0&&!r)if(u){const n=null;e.listenProvider_.stopListening(pv(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(lv(t));e.listenProvider_.stopListening(pv(t),n)}));!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=lv(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return o}function nv(e,t,n){const r=t._path;let i=null,s=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=Tm(e,r);i=i||W_(t,n),s=s||H_(t)}));let o,a=e.syncPointTree_.get(r);if(a?(s=s||H_(a),i=i||W_(a,fm())):(a=new U_,e.syncPointTree_=e.syncPointTree_.set(r,a)),null!=i)o=!0;else{o=!1,i=ry.EMPTY_NODE;e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const n=W_(t,fm());n&&(i=i.updateImmediateChild(e,n))}))}const c=z_(a,t);if(!c&&!t._queryParams.loadsAllData()){const n=lv(t);Ro(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=Q_++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=V_(a,t,n,o_(e.pendingWriteTree_,r),i,o);if(!c&&!s){const n=K_(a,t);u=u.concat(function(e,t,n){const r=t._path,i=uv(e,t),s=cv(e,n),o=e.listenProvider_.startListening(pv(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)Ro(!H_(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!bm(e)&&t&&H_(t))return[G_(t).query];{let e=[];return t&&(e=e.concat($_(t).map((e=>e.query)))),Mg(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(pv(r),uv(e,r))}}return o}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,n))}return u}function rv(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=W_(n,Tm(e,t));if(r)return r}));return h_(r,t,i,n,!0)}function iv(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Tm(e,n);r=r||W_(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||W_(i,fm()):(i=new U_,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new qy(r,!0,!1):null;return function(e){return Ky(e.viewCache_)}(j_(i,t,o_(e.pendingWriteTree_,t._path),s?o.getNode():ry.EMPTY_NODE,s))}function sv(e,t){return ov(t,e.syncPointTree_,null,o_(e.pendingWriteTree_,fm()))}function ov(e,t,n,r){if(bm(e.path))return av(e,t,n,r);{const i=t.get(fm());null==n&&null!=i&&(n=W_(i,fm()));let s=[];const o=pm(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=__(r,o);s=s.concat(ov(a,c,e,t))}return i&&(s=s.concat(q_(i,e,r,n))),s}}function av(e,t,n,r){const i=t.get(fm());null==n&&null!=i&&(n=W_(i,fm()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=__(r,t),c=e.operationForChild(t);c&&(s=s.concat(av(c,i,o,a)))})),i&&(s=s.concat(q_(i,e,r,n))),s}function cv(e,t){const n=t.query,r=uv(e,n);return{hashFn:()=>(function(e){return e.viewCache_.serverCache.getNode()}(t)||ry.EMPTY_NODE).hash(),onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=hv(e,n);if(r){const n=dv(r),i=n.path,s=n.queryId,o=Tm(i,t);return fv(e,i,new Ly(Oy(s),o))}return[]}(e,n._path,r):function(e,t){return sv(e,new Ly({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return tv(e,n,null,r)}}}}function uv(e,t){const n=lv(t);return e.queryToTagMap.get(n)}function lv(e){return e._path.toString()+"$"+e._queryIdentifier}function hv(e,t){return e.tagToQueryMap.get(t)}function dv(e){const t=e.indexOf("$");return Ro(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new dm(e.substr(0,t))}}function fv(e,t,n){const r=e.syncPointTree_.get(t);Ro(r,"Missing sync point for query tag that we're tracking");return q_(r,n,o_(e.pendingWriteTree_,t),null)}function pv(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Ro(F_,"Reference.ts has not been loaded"),F_)(e._repo,e._path):e}class gv{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new gv(t)}node(){return this.node_}}class mv{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=wm(this.path_,e);return new mv(this.syncTree_,t)}node(){return rv(this.syncTree_,this.path_)}}const yv=function(e,t,n){return e&&"object"==typeof e?(Ro(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?_v(e[".sv"],t,n):"object"==typeof e[".sv"]?vv(e[".sv"],t):void Ro(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},_v=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:Ro(!1,"Unexpected server value: "+e)}},vv=function(e,t,n){e.hasOwnProperty("increment")||Ro(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&Ro(!1,"Unexpected increment value: "+r);const i=t.node();if(Ro(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},wv=function(e,t,n,r){return Tv(t,new mv(n,e),r)},bv=function(e,t,n){return Tv(e,new gv(t),n)};function Tv(e,t,n){const r=e.getPriority().val(),i=yv(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=yv(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new Gm(s,sy(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new Gm(i))),r.forEachChild(Qm,((e,r)=>{const i=Tv(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Iv{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Ev(e,t){let n=t instanceof dm?t:new dm(t),r=e,i=pm(n);for(;null!==i;){const e=ia(r.node.children,i)||{children:{},childCount:0};r=new Iv(i,r,e),n=mm(n),i=pm(n)}return r}function Sv(e){return e.node.value}function kv(e,t){e.node.value=t,Pv(e)}function Cv(e){return e.node.childCount>0}function Rv(e,t){Mg(e.node.children,((n,r)=>{t(new Iv(n,e,r))}))}function Av(e,t,n,r){n&&!r&&t(e),Rv(e,(e=>{Av(e,t,!0,r)})),n&&r&&t(e)}function Nv(e){return new dm(null===e.parent?e.name:Nv(e.parent)+"/"+e.name)}function Pv(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Sv(e)&&!Cv(e)}(n),i=ra(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Pv(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Pv(e))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.parent,e.name,e)}const xv=/[\[\].#$\/\u0000-\u001F\u007F]/,Dv=/[\[\].#$\u0000-\u001F\u007F]/,Ov=10485760,Mv=function(e){return"string"==typeof e&&0!==e.length&&!xv.test(e)},Lv=function(e){return"string"==typeof e&&0!==e.length&&!Dv.test(e)},Fv=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!Cg(e)||e&&"object"==typeof e&&ra(e,".sv")},Uv=function(e,t,n,r){r&&void 0===t||qv(ga(e,"value"),t,n)},qv=function(e,t,n){const r=n instanceof dm?new km(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Rm(r));if("function"==typeof t)throw new Error(e+"contains a function "+Rm(r)+" with contents = "+t.toString());if(Cg(t))throw new Error(e+"contains "+t.toString()+" "+Rm(r));if("string"==typeof t&&t.length>Ov/3&&va(t)>Ov)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+Rm(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(Mg(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Mv(t)))throw new Error(e+" contains an invalid key ("+t+") "+Rm(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=va(t),Cm(e)}(r,t),qv(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=va(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Rm(r)+" in addition to actual children.")}},jv=function(e,t,n,r){if(r&&void 0===t)return;const i=ga(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Mg(t,((e,t)=>{const r=new dm(e);if(qv(i,t,wm(n,r)),".priority"===ym(r)&&!Fv(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=_m(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!Mv(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Im);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&Sm(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},Vv=function(e,t,n){if(!n||void 0!==t){if(Cg(t))throw new Error(ga(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Fv(t))throw new Error(ga(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Bv=function(e,t,n,r){if(!(r&&void 0===n||Mv(n)))throw new Error(ga(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},$v=function(e,t,n,r){if(!(r&&void 0===n||Lv(n)))throw new Error(ga(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Wv=function(e,t){if(".info"===pm(t))throw new Error(e+" failed = Can't modify data under /.info/")},Kv=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Mv(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Lv(e)}(n))throw new Error(ga(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class zv{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Hv(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||Em(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function Gv(e,t,n){Hv(e,n),Yv(e,(e=>Em(e,t)))}function Qv(e,t,n){Hv(e,n),Yv(e,(e=>Sm(e,t)||Sm(t,e)))}function Yv(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(Jv(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Jv(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();vg&&Tg("event: "+n.toString()),Vg(r)}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Xv="repo_interrupt";class Zv{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new zv,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Cy(),this.transactionQueueTree_=new Iv,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ew(e,t,n){if(e.stats_=em(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Sy(e.repoInfo_,((t,n,r,i)=>{rw(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>iw(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Zo(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Pm(e.repoInfo_,t,((t,n,r,i)=>{rw(e,t,n,r,i)}),(t=>{iw(e,t)}),(t=>{!function(e,t){Mg(t,((t,n)=>{sw(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return Zg[n]||(Zg[n]=t()),Zg[n]}(e.repoInfo_,(()=>new xy(e.stats_,e.server_))),e.infoData_=new ky,e.infoSyncTree_=new Y_({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=ev(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),sw(e,"connected",!1),e.serverSyncTree_=new Y_({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);Qv(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function tw(e){const t=e.infoData_.getNode(new dm(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function nw(e){return(t=(t={timestamp:tw(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function rw(e,t,n,r,i){e.dataUpdateCount++;const s=new dm(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=oa(n,(e=>sy(e)));o=function(e,t,n,r){const i=hv(e,r);if(i){const r=dv(i),s=r.path,o=r.queryId,a=Tm(s,t),c=Gy.fromObject(n);return fv(e,s,new Uy(Oy(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=sy(n);o=function(e,t,n,r){const i=hv(e,r);if(null!=i){const r=dv(i),s=r.path,o=r.queryId,a=Tm(s,t);return fv(e,s,new Fy(Oy(o),a,n))}return[]}(e.serverSyncTree_,s,t,i)}else if(r){const t=oa(n,(e=>sy(e)));o=function(e,t,n){const r=Gy.fromObject(n);return sv(e,new Uy({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=sy(n);o=ev(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=mw(e,s)),Qv(e.eventQueue_,a,o)}function iw(e,t){sw(e,"connected",t),!1===t&&function(e){dw(e,"onDisconnectEvents");const t=nw(e),n=Cy();Ny(e.onDisconnect_,fm(),((r,i)=>{const s=wv(r,i,e.serverSyncTree_,t);Ry(n,r,s)}));let r=[];Ny(n,fm(),((t,n)=>{r=r.concat(ev(e.serverSyncTree_,t,n));const i=bw(e,t);mw(e,i)})),e.onDisconnect_=Cy(),Qv(e.eventQueue_,fm(),r)}(e)}function sw(e,t,n){const r=new dm("/.info/"+t),i=sy(n);e.infoData_.updateSnapshot(r,i);const s=ev(e.infoSyncTree_,r,i);Qv(e.eventQueue_,r,s)}function ow(e){return e.nextWriteId_++}function aw(e,t,n,r,i){dw(e,"set",{path:t.toString(),value:n,priority:r});const s=nw(e),o=sy(n,r),a=rv(e.serverSyncTree_,t),c=bv(o,a,s),u=ow(e),l=J_(e.serverSyncTree_,t,c,u,!0);Hv(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||kg("set at "+t+" failed: "+n);const o=Z_(e.serverSyncTree_,u,!s);Qv(e.eventQueue_,t,o),fw(e,i,n,r)}));const h=bw(e,t);mw(e,h),Qv(e.eventQueue_,h,[])}function cw(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&Ay(e.onDisconnect_,t),fw(e,n,r,i)}))}function uw(e,t,n,r){const i=sy(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&Ry(e.onDisconnect_,t,i),fw(e,r,n,s)}))}function lw(e,t,n){let r;r=".info"===pm(t._path)?tv(e.infoSyncTree_,t,n):tv(e.serverSyncTree_,t,n),Gv(e.eventQueue_,t._path,r)}function hw(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Xv)}function dw(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Tg(n,...t)}function fw(e,t,n,r){t&&Vg((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function pw(e,t,n){return rv(e.serverSyncTree_,t,n)||ry.EMPTY_NODE}function gw(e,t=e.transactionQueueTree_){if(t||ww(e,t),Sv(t)){const n=_w(e,t);Ro(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=pw(e,t,r);let s=i;const o=i.hash();for(let e=0;e<n.length;e++){const r=n[e];Ro(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Tm(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,(r=>{dw(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Z_(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();ww(e,Ev(e.transactionQueueTree_,t)),gw(e,e.transactionQueueTree_),Qv(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)Vg(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{kg("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}mw(e,t)}}),o)}(e,Nv(t),n)}else Cv(t)&&Rv(t,(t=>{gw(e,t)}))}function mw(e,t){const n=yw(e,t),r=Nv(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let a=0;a<t.length;a++){const c=t[a],u=Tm(n,c.path);let l,h=!1;if(Ro(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,l=c.abortReason,i=i.concat(Z_(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,l="maxretry",i=i.concat(Z_(e.serverSyncTree_,c.currentWriteId,!0));else{const n=pw(e,c.path,s);c.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){qv("transaction failed: Data returned ",r,c.path);let t=sy(r);"object"==typeof r&&null!=r&&ra(r,".priority")||(t=t.updatePriority(n.getPriority()));const o=c.currentWriteId,a=nw(e),u=bv(t,n,a);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=u,c.currentWriteId=ow(e),s.splice(s.indexOf(o),1),i=i.concat(J_(e.serverSyncTree_,c.path,u,c.currentWriteId,c.applyLocally)),i=i.concat(Z_(e.serverSyncTree_,o,!0))}else h=!0,l="nodata",i=i.concat(Z_(e.serverSyncTree_,c.currentWriteId,!0))}Qv(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,o=t[a].unwatcher,setTimeout(o,Math.floor(0)),t[a].onComplete&&("nodata"===l?r.push((()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot))):r.push((()=>t[a].onComplete(new Error(l),!1,null)))))}var o;ww(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)Vg(r[e]);gw(e,e.transactionQueueTree_)}(e,_w(e,n),r),r}function yw(e,t){let n,r=e.transactionQueueTree_;for(n=pm(t);null!==n&&void 0===Sv(r);)r=Ev(r,n),n=pm(t=mm(t));return r}function _w(e,t){const n=[];return vw(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function vw(e,t,n){const r=Sv(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Rv(t,(t=>{vw(e,t,n)}))}function ww(e,t){const n=Sv(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,kv(t,n.length>0?n:void 0)}Rv(t,(t=>{ww(e,t)}))}function bw(e,t){const n=Nv(yw(e,t)),r=Ev(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{Tw(e,t)})),Tw(e,r),Av(r,(t=>{Tw(e,t)})),n}function Tw(e,t){const n=Sv(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(Ro(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(Ro(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(Z_(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?kv(t,void 0):n.length=s+1,Qv(e.eventQueue_,Nv(t),i);for(let e=0;e<r.length;e++)Vg(r[e])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Iw=function(e,t){const n=Ew(e),r=n.namespace;"firebase.com"===n.domain&&Sg(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Sg("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&kg("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Qg(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new dm(n.pathString)}},Ew=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let u=e.indexOf("//");u>=0&&(a=e.substring(0,u-1),e=e.substring(u+2));let l=e.indexOf("/");-1===l&&(l=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(l,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):kg(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));u=t.indexOf(":"),u>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(u+1),10)):u=t.length;const f=t.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Sw{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Zo(this.snapshot.exportVal())}}class kw{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Cw{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Ro(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Rw{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Lo;return cw(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){Wv("OnDisconnect.remove",this._path);const e=new Lo;return uw(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){Wv("OnDisconnect.set",this._path),Uv("OnDisconnect.set",e,this._path,!1);const t=new Lo;return uw(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){Wv("OnDisconnect.setWithPriority",this._path),Uv("OnDisconnect.setWithPriority",e,this._path,!1),Vv("OnDisconnect.setWithPriority",t,!1);const n=new Lo;return function(e,t,n,r,i){const s=sy(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&Ry(e.onDisconnect_,t,s),fw(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){Wv("OnDisconnect.update",this._path),jv("OnDisconnect.update",e,this._path,!1);const t=new Lo;return function(e,t,n,r){if(sa(n))return Tg("onDisconnect().update() called with empty data.  Don't do anything."),void fw(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&Mg(n,((n,r)=>{const i=sy(r);Ry(e.onDisconnect_,wm(t,n),i)})),fw(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Aw{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return bm(this._path)?null:ym(this._path)}get ref(){return new Dw(this._repo,this._path)}get _queryIdentifier(){const e=Ey(this._queryParams),t=Dg(e);return"{}"===t?"default":t}get _queryObject(){return Ey(this._queryParams)}isEqual(e){if(!((e=ba(e))instanceof Aw))return!1;const t=this._repo===e._repo,n=Em(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function Nw(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Pw(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Lm){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Rg)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Ag)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Qm){if(null!=t&&!Fv(t)||null!=n&&!Fv(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Ro(e.getIndex()instanceof oy||e.getIndex()===ay,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function xw(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Dw extends Aw{constructor(e,t){super(e,t,new vy,!1)}get parent(){const e=vm(this._path);return null===e?null:new Dw(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ow{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new dm(e),n=Fw(this.ref,e);return new Ow(this._node.getChild(t),n,Qm)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new Ow(n,Fw(this.ref,t),Qm))))}hasChild(e){const t=new dm(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Mw(e,t){return(e=ba(e))._checkNotDeleted("ref"),void 0!==t?Fw(e._root,t):e._root}function Lw(e,t){(e=ba(e))._checkNotDeleted("refFromURL");const n=Iw(t,e._repo.repoInfo_.nodeAdmin);Kv("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||Sg("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Mw(e,n.path.toString())}function Fw(e,t){var n,r,i,s;return null===pm((e=ba(e))._path)?(n="child",r="path",s=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),$v(n,r,i,s)):$v("child","path",t,!1),new Dw(e._repo,wm(e._path,t))}function Uw(e,t){e=ba(e),Wv("set",e._path),Uv("set",t,e._path,!1);const n=new Lo;return aw(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function qw(e,t){jv("update",t,e._path,!1);const n=new Lo;return function(e,t,n,r){dw(e,"update",{path:t.toString(),value:n});let i=!0;const s=nw(e),o={};if(Mg(n,((n,r)=>{i=!1,o[n]=wv(wm(t,n),sy(r),e.serverSyncTree_,s)})),i)Tg("update() called with empty data.  Don't do anything."),fw(0,r,"ok",void 0);else{const i=ow(e),s=X_(e.serverSyncTree_,t,o,i);Hv(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||kg("update at "+t+" failed: "+n);const a=Z_(e.serverSyncTree_,i,!o),c=a.length>0?mw(e,t):t;Qv(e.eventQueue_,c,a),fw(0,r,n,s)})),Mg(n,(n=>{const r=bw(e,wm(t,n));mw(e,r)})),Qv(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function jw(e){return function(e,t){const n=iv(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((n=>{const r=sy(n).withIndex(t._queryParams.getIndex()),i=ev(e.serverSyncTree_,t._path,r);return Gv(e.eventQueue_,t._path,i),Promise.resolve(r)}),(n=>(dw(e,"get for query "+Zo(t)+" failed: "+n),Promise.reject(new Error(n)))))}((e=ba(e))._repo,e).then((t=>new Ow(t,new Dw(e._repo,e._path),e._queryParams.getIndex())))}class Vw{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new Sw("value",this,new Ow(e.snapshotNode,new Dw(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new kw(this,e,t):null}matches(e){return e instanceof Vw&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Bw{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new kw(this,e,t):null}createEvent(e,t){Ro(null!=e.childName,"Child events should have a childName.");const n=Fw(new Dw(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Sw(e.type,this,new Ow(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Bw&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function $w(e,t,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{lw(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new Cw(n,s||void 0),a="value"===t?new Vw(o):new Bw(t,o);return function(e,t,n){let r;r=".info"===pm(t._path)?nv(e.infoSyncTree_,t,n):nv(e.serverSyncTree_,t,n),Gv(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>lw(e._repo,e,a)}function Ww(e,t,n,r){return $w(e,"value",t,n,r)}function Kw(e,t,n,r){return $w(e,"child_added",t,n,r)}function zw(e,t,n,r){return $w(e,"child_changed",t,n,r)}function Hw(e,t,n,r){return $w(e,"child_moved",t,n,r)}function Gw(e,t,n,r){return $w(e,"child_removed",t,n,r)}function Qw(e,t,n){let r=null;const i=n?new Cw(n):null;"value"===t?r=new Vw(i):t&&(r=new Bw(t,i)),lw(e._repo,e,r)}class Yw{}class Jw extends Yw{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Uv("endAt",this._value,e._path,!0);const t=by(e._queryParams,this._value,this._key);if(xw(t),Pw(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Aw(e._repo,e._path,t,e._orderByCalled)}}class Xw extends Yw{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Uv("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r,i;return e.index_===Lm?("string"==typeof t&&(t=hy(t)),i=by(e,t,n)):(r=null==n?Rg:hy(n),i=by(e,t,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(xw(t),Pw(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Aw(e._repo,e._path,t,e._orderByCalled)}}class Zw extends Yw{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Uv("startAt",this._value,e._path,!0);const t=wy(e._queryParams,this._value,this._key);if(xw(t),Pw(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Aw(e._repo,e._path,t,e._orderByCalled)}}class eb extends Yw{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Uv("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;if(e.index_===Lm)"string"==typeof t&&(t=ly(t)),r=wy(e,t,n);else{let i;i=null==n?Ag:ly(n),r=wy(e,t,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(xw(t),Pw(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Aw(e._repo,e._path,t,e._orderByCalled)}}class tb extends Yw{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Aw(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class nb extends Yw{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Aw(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class rb extends Yw{constructor(e){super(),this._path=e}_apply(e){Nw(e,"orderByChild");const t=new dm(this._path);if(bm(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new oy(t),r=Ty(e._queryParams,n);return Pw(r),new Aw(e._repo,e._path,r,!0)}}class ib extends Yw{_apply(e){Nw(e,"orderByKey");const t=Ty(e._queryParams,Lm);return Pw(t),new Aw(e._repo,e._path,t,!0)}}class sb extends Yw{_apply(e){Nw(e,"orderByPriority");const t=Ty(e._queryParams,Qm);return Pw(t),new Aw(e._repo,e._path,t,!0)}}class ob extends Yw{_apply(e){Nw(e,"orderByValue");const t=Ty(e._queryParams,ay);return Pw(t),new Aw(e._repo,e._path,t,!0)}}class ab extends Yw{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Uv("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Jw(this._value,this._key)._apply(new Zw(this._value,this._key)._apply(e))}}function cb(e,...t){let n=ba(e);for(const e of t)n=e._apply(n);return n}!function(e){Ro(!L_,"__referenceConstructor has already been defined"),L_=e}(Dw),function(e){Ro(!F_,"__referenceConstructor has already been defined"),F_=e}(Dw);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const ub={};function lb(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||Sg("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tg("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=Iw(s,i),u=c.repoInfo;"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${u.namespace}`,c=Iw(s,i),u=c.repoInfo):o=!c.repoInfo.secure;const l=i&&o?new Kg(Kg.OWNER):new Wg(e.name,e.options,t);Kv("Invalid Firebase Database URL",c),bm(c.path)||Sg("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=ub[t.name];i||(i={},ub[t.name]=i);let s=i[e.toURLString()];s&&Sg("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new Zv(e,false,n,r),i[e.toURLString()]=s,s}(u,e,l,new $g(e.name,n));return new hb(h,e)}class hb{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ew(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Dw(this._repo,fm())),this._rootInternal}_delete(){return this._checkNotDeleted("delete"),function(e,t){const n=ub[t];n&&n[e.key]===e||Sg(`Database ${t}(${e.repoInfo_}) has already been deleted.`),hw(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null,Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Sg("Cannot call "+e+" on a deleted database.")}}function db(e,t,n,r={}){(e=ba(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Sg("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Sg('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Kg(Kg.OWNER);else if(r.mockUserToken){const t=Fo(r.mockUserToken,e.app.options.projectId);s=new Kg(t)}!function(e,t,n,r){e.repoInfo_=new Qg(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(i,t,n,s)}function fb(e){var t;(e=ba(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(Xv)}function pb(e,t){bg(e,t)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const gb={".sv":"timestamp"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class mb{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function yb(e,t,n){var r;if(e=ba(e),Wv("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new Lo,o=Ww(e,(()=>{}));return function(e,t,n,r,i,s){dw(e,"transaction on "+t);const o={path:t,update:n,onComplete:r,status:null,order:mg(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=pw(e,t,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(void 0===c)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{qv("transaction failed: Data returned ",c,o.path),o.status=0;const n=Ev(e.transactionQueueTree_,t),r=Sv(n)||[];let i;r.push(o),kv(n,r),"object"==typeof c&&null!==c&&ra(c,".priority")?(i=ia(c,".priority"),Ro(Fv(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(rv(e.serverSyncTree_,t)||ry.EMPTY_NODE).getPriority().val();const s=nw(e),u=sy(c,i),l=bv(u,a,s);o.currentOutputSnapshotRaw=u,o.currentOutputSnapshotResolved=l,o.currentWriteId=ow(e);const h=J_(e.serverSyncTree_,t,l,o.currentWriteId,o.applyLocally);Qv(e.eventQueue_,t,h),gw(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let i=null;t?s.reject(t):(i=new Ow(r,new Dw(e._repo,e._path),Qm),s.resolve(new mb(n,i)))}),o,i),s.promise}!function(e){!function(e){ug=e}(Ha),$a(new Ta("database-exp",((e,{instanceIdentifier:t})=>lb(e.getProvider("app-exp").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/database","0.0.900-exp.6ef484a04",e)}();
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class _b{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Zo(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Xo(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vb{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ra(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const wb=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new _b(t)}}catch(e){}return new vb},bb=wb("localStorage"),Tb=wb("sessionStorage"),Ib=new Da("@firebase/database"),Eb=function(){let e=1;return function(){return e++}}(),Sb=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=Sb.apply(null,r):t+="object"==typeof r?Zo(r):r,t+=" "}return t};let kb=null,Cb=!0;const Rb=function(...e){var t,n;if(!0===Cb&&(Cb=!1,null===kb&&!0===Tb.get("logging_enabled")&&(t=!0,Ro(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Ib.logLevel=ka.VERBOSE,kb=Ib.log.bind(Ib),n&&Tb.set("logging_enabled",!0)):"function"==typeof t?kb=t:(kb=null,Tb.remove("logging_enabled")))),kb){const t=Sb.apply(null,e);kb(t)}},Ab=function(e){return function(...t){Rb(e,...t)}},Nb=function(...e){const t="FIREBASE INTERNAL ERROR: "+Sb(...e);Ib.error(t)},Pb=function(...e){const t="FIREBASE WARNING: "+Sb(...e);Ib.warn(t)},xb="[MIN_NAME]",Db="[MAX_NAME]",Ob=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Zo(t))},Mb=function(e){if("object"!=typeof e||null===e)return Zo(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=Zo(t[r]),n+=":",n+=Mb(e[t[r]]);return n+="}",n},Lb=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Fb(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Ub=function(e){Ro(!function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)}(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()},qb=new RegExp("^-?(0*)\\d{1,10}$"),jb=function(e){if(qb.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Vb=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw Pb("Exception was thrown by user callback.",t),e}),Math.floor(0))}},Bb=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class $b{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Wb(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Kb=/[\[\].#$\u0000-\u001F\u007F]/,zb=function(e,t,n,r){if(!(r&&void 0===n||function(e){return"string"==typeof e&&0!==e.length&&!Kb.test(e)}(n)))throw new Error(ga(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Hb=function(e,t){if(".info"===Wb(t))throw new Error(e+" failed = Can't modify data under /.info/")};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Gb{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Gb(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Qb;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Yb;class Jb{constructor(e,t=Jb.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Ro(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),function(e){if(e.isLeafNode()){const t=e.val();Ro("string"==typeof t||"number"==typeof t||"object"==typeof t&&ra(t,".sv"),"Priority must be a string or number.")}else Ro(e===Qb||e.isEmpty(),"priority of unexpected type.");Ro(e===Qb||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}(this.priorityNode_)}static set __childrenNodeConstructor(e){Yb=e}static get __childrenNodeConstructor(){return Yb}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Jb(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Jb.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return function(e){return e.pieceNum_>=e.pieces_.length}(e)?this:".priority"===Wb(e)?this.priorityNode_:Jb.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Jb.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Wb(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(Ro(".priority"!==n||1===function(e){return e.pieces_.length-e.pieceNum_}(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Jb.__childrenNodeConstructor.EMPTY_NODE.updateChild(function(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new $b(e.pieces_,t)}(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+(("number"==typeof(e=this.priorityNode_.val())?"number:"+Ub(e):"string:"+e)+":"));const n=typeof this.value_;t+=n+":",t+="number"===n?Ub(this.value_):this.value_,this.lazyHash_=function(e){const t=_a(e),n=new la;n.update(t);const r=n.digest();return Po.encodeByteArray(r)}(t)}var e;return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Jb.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Jb.__childrenNodeConstructor?-1:(Ro(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Jb.VALUE_TYPE_ORDER.indexOf(t),i=Jb.VALUE_TYPE_ORDER.indexOf(n);return Ro(r>=0,"Unknown leaf type: "+t),Ro(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Jb.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Xb=new class extends class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Gb(xb,e),r=new Gb(xb,t);return 0!==this.compare(n,r)}minPost(){return Gb.MIN}}{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?function(e,t){if(e===t)return 0;if(e===xb||t===Db)return-1;if(t===xb||e===Db)return 1;{const n=jb(e),r=jb(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}}(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Gb.MIN}maxPost(){return new Gb(Db,new Jb("[PRIORITY-POST]",undefined))}makePost(e,t){const n=undefined(e);return new Gb(t,new Jb("[PRIORITY-POST]",n))}toString(){return".priority"}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Zb{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Xb}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Ro(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Ro(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:xb}hasEnd(){return this.endSet_}getIndexEndValue(){return Ro(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Ro(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Db}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Ro(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Xb}copy(){const e=new Zb;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eT{constructor(e){this._delegate=e}cancel(e){pa("OnDisconnect.cancel",0,1,arguments.length),ma("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){pa("OnDisconnect.remove",0,1,arguments.length),ma("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){pa("OnDisconnect.set",1,2,arguments.length),ma("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){pa("OnDisconnect.setWithPriority",2,3,arguments.length),ma("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(pa("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Pb("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ma("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class tT{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return pa("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nT{constructor(e,t){this._database=e,this._delegate=t}val(){return pa("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return pa("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return pa("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return pa("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return pa("DataSnapshot.child",0,1,arguments.length),e=String(e),zb("DataSnapshot.child","path",e,!1),new nT(this._database,this._delegate.child(e))}hasChild(e){return pa("DataSnapshot.hasChild",1,1,arguments.length),zb("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return pa("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return pa("DataSnapshot.forEach",1,1,arguments.length),ma("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new nT(this._database,t))))}hasChildren(){return pa("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return pa("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return pa("DataSnapshot.ref",0,0,arguments.length),new iT(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class rT{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;pa("Query.on",2,4,arguments.length),ma("Query.on","callback",t,!1);const s=rT.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new nT(this.database,e),n)};o.userCallback=t,o.context=s.context;const a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return Ww(this._delegate,o,a),t;case"child_added":return Kw(this._delegate,o,a),t;case"child_removed":return Gw(this._delegate,o,a),t;case"child_changed":return zw(this._delegate,o,a),t;case"child_moved":return Hw(this._delegate,o,a),t;default:throw new Error(ga("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(pa("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ga(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),ma("Query.off","callback",t,!0),ya("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,Qw(this._delegate,e,r)}else Qw(this._delegate,e)}get(){return jw(this._delegate).then((e=>new nT(this.database,e)))}once(e,t,n,r){pa("Query.once",1,4,arguments.length),ma("Query.once","callback",t,!0);const i=rT.getCancelAndContextArgs_("Query.once",n,r),s=new Lo,o=(e,n)=>{const r=new nT(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;const a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":Ww(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":Kw(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":Gw(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":zw(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":Hw(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(ga("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return pa("Query.limitToFirst",1,1,arguments.length),new rT(this.database,cb(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new tb(e)}(e)))}limitToLast(e){return pa("Query.limitToLast",1,1,arguments.length),new rT(this.database,cb(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new nb(e)}(e)))}orderByChild(e){return pa("Query.orderByChild",1,1,arguments.length),new rT(this.database,cb(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return $v("orderByChild","path",e,!1),new rb(e)}(e)))}orderByKey(){return pa("Query.orderByKey",0,0,arguments.length),new rT(this.database,cb(this._delegate,new ib))}orderByPriority(){return pa("Query.orderByPriority",0,0,arguments.length),new rT(this.database,cb(this._delegate,new sb))}orderByValue(){return pa("Query.orderByValue",0,0,arguments.length),new rT(this.database,cb(this._delegate,new ob))}startAt(e=null,t){return pa("Query.startAt",0,2,arguments.length),new rT(this.database,cb(this._delegate,function(e=null,t){return Bv("startAt","key",t,!0),new Zw(e,t)}(e,t)))}startAfter(e=null,t){return pa("Query.startAfter",0,2,arguments.length),new rT(this.database,cb(this._delegate,function(e,t){return Bv("startAfter","key",t,!0),new eb(e,t)}(e,t)))}endAt(e=null,t){return pa("Query.endAt",0,2,arguments.length),new rT(this.database,cb(this._delegate,function(e,t){return Bv("endAt","key",t,!0),new Jw(e,t)}(e,t)))}endBefore(e=null,t){return pa("Query.endBefore",0,2,arguments.length),new rT(this.database,cb(this._delegate,function(e,t){return Bv("endBefore","key",t,!0),new Xw(e,t)}(e,t)))}equalTo(e,t){return pa("Query.equalTo",1,2,arguments.length),new rT(this.database,cb(this._delegate,function(e,t){return Bv("equalTo","key",t,!0),new ab(e,t)}(e,t)))}toString(){return pa("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return pa("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(pa("Query.isEqual",1,1,arguments.length),!(e instanceof rT)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,ma(e,"cancel",r.cancel,!0),r.context=n,ya(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(ga(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new iT(this.database,new Dw(this._delegate._repo,this._delegate._path))}}class iT extends rT{constructor(e,t){super(e,new Aw(t._repo,t._path,new Zb,!1)),this.database=e,this._delegate=t}getKey(){return pa("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return pa("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new iT(this.database,Fw(this._delegate,e))}getParent(){pa("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new iT(this.database,e):null}getRoot(){return pa("Reference.root",0,0,arguments.length),new iT(this.database,this._delegate.root)}set(e,t){pa("Reference.set",1,2,arguments.length),ma("Reference.set","onComplete",t,!0);const n=Uw(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(pa("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Pb("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Hb("Reference.update",this._delegate._path),ma("Reference.update","onComplete",t,!0);const n=qw(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){pa("Reference.setWithPriority",2,3,arguments.length),ma("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if(Wv("setWithPriority",e._path),Uv("setWithPriority",t,e._path,!1),Vv("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new Lo;return aw(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){pa("Reference.remove",0,1,arguments.length),ma("Reference.remove","onComplete",e,!0);const t=function(e){return Wv("remove",e._path),Uw(e,null)}(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){pa("Reference.transaction",1,3,arguments.length),ma("Reference.transaction","transactionUpdate",e,!1),ma("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(ga(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=yb(this._delegate,e,{applyLocally:n}).then((e=>new tT(e.committed,new nT(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){pa("Reference.setPriority",1,2,arguments.length),ma("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=ba(e),Wv("setPriority",e._path),Vv("setPriority",t,!1);const n=new Lo;return aw(e._repo,wm(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){pa("Reference.push",0,2,arguments.length),ma("Reference.push","onComplete",t,!0);const n=function(e,t){e=ba(e),Wv("push",e._path),Uv("push",t,e._path,!0);const n=tw(e._repo),r=uy(n),i=Fw(e,r),s=Fw(e,r);let o;return o=null!=t?Uw(s,t).then((()=>s)):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),r=n.then((e=>new iT(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const i=new iT(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return Hb("Reference.onDisconnect",this._delegate._path),new eT(new Rw(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class sT{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete()}}useEmulator(e,t,n={}){db(this._delegate,e,t,n)}ref(e){if(pa("database.ref",0,1,arguments.length),e instanceof iT){const t=Lw(this._delegate,e.toString());return new iT(this,t)}{const t=Mw(this._delegate,e);return new iT(this,t)}}refFromURL(e){pa("database.refFromURL",1,1,arguments.length);const t=Lw(this._delegate,e);return new iT(this,t)}goOffline(){return pa("database.goOffline",0,0,arguments.length),function(e){(e=ba(e))._checkNotDeleted("goOffline"),hw(e._repo)}(this._delegate)}goOnline(){return pa("database.goOnline",0,0,arguments.length),fb(this._delegate)}}sT.ServerValue={TIMESTAMP:gb,increment:e=>function(e){return{".sv":{increment:e}}}(e)};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const oT=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,aT="websocket",cT="long_polling";function uT(e,t,n){let r;if(Ro("string"==typeof t,"typeof type must == string"),Ro("object"==typeof n,"typeof params must == object"),t===aT)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==cT)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Fb(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lT{constructor(){this.counters_={}}incrementCounter(e,t=1){ra(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Oo(this.counters_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const hT={};function dT(e){const t=e.toString();return hT[t]||(hT[t]=new lT),hT[t]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class fT{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Vb((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const pT="start";class gT{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ab(e),this.stats_=dT(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),uT(t,cT,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new fT(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new mT(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===pT)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&oT.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){gT.forceAllow_=!0}static forceDisallow(){gT.forceDisallow_=!0}static isAvailable(){return!!gT.forceAllow_||!(gT.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Zo(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=xo(t),r=Lb(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Zo(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class mT{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Eb(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=mT.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Rb("frame writing exception"),e.stack&&Rb(e.stack),Rb(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Rb("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Rb("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let yT="";function _T(e){yT=e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let vT=null;"undefined"!=typeof MozWebSocket?vT=MozWebSocket:"undefined"!=typeof WebSocket&&(vT=WebSocket);class wT{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ab(this.connId),this.stats_=dT(t),this.connURL=wT.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&oT.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),uT(e,aT,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,bb.set("previous_websocket_failure",!0);try{if(Wo());else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new vT(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){wT.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==vT&&!wT.forceDisallow_}static previouslyFailed(){return bb.isInMemoryStorage||!0===bb.get("previous_websocket_failure")}markConnectionHealthy(){bb.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Xo(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Ro(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=Zo(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Lb(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}wT.responsesRequiredToBeHealthy=2,wT.healthyTimeout=3e4;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class bT{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[gT,wT]}initTransports_(e){const t=wT&&wT.isAvailable();let n=t&&!wT.previouslyFailed();if(e.webSocketOnly&&(t||Pb("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[wT];else{const e=this.transports_=[];for(const t of bT.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class TT{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ab("c:"+this.id+":"),this.transportManager_=new bT(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Bb((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ob("t",e),n=Ob("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ob("t",e),n=Ob("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ob("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Nb("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Nb("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Pb("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Bb((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bb((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(bb.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class IT{constructor(e){this.allowedEvents_=e,this.listeners_={},Ro(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){Ro(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ET extends IT{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||qo()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new ET}getInitialEvent(e){return Ro("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ST extends IT{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new ST}getInitialEvent(e){return Ro("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const kT=1e3;class CT extends class{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=CT.nextPersistentConnectionId_++,this.log_=Ab("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=kT,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Wo())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ST.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&ET.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Zo(i)),Ro(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Lo,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Ro(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ro(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;CT.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&ra(e,"w")){const n=ia(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Pb(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||na(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=ta(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Ro(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Zo(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Nb("Unrecognized action received from server: "+Zo(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Ro(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=kT,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=kT,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=kT),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+CT.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){Ro(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?Rb("getToken() completed but was canceled"):(Rb("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new TT(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{Pb(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&Pb(e),a())}}}interrupt(e){Rb("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Rb("Resuming connection for reason: "+e),delete this.interruptReasons_[e],sa(this.interruptReasons_)&&(this.reconnectDelay_=kT,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Mb(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new $b(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Rb("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Rb("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+yT.replace(/\./g,"-")]=1,qo()?e["framework.cordova"]=1:Bo()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ET.getInstance().currentlyOnline();return sa(this.interruptReasons_)&&e}}CT.nextPersistentConnectionId_=0,CT.nextConnectionId_=0;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class RT{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Fb(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var AT=Object.freeze({__proto__:null,forceLongPolling:function(){wT.forceDisallow(),gT.forceAllow()},forceWebSockets:function(){gT.forceDisallow()},isWebSocketsAvailable:function(){return wT.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t=!1){if("undefined"==typeof console)return;let n;t?(e.statsListener_||(e.statsListener_=new RT(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();const r=Object.keys(n).reduce(((e,t)=>Math.max(t.length,e)),0);Fb(n,((e,t)=>{let n=e;for(let t=e.length;t<r+2;t++)n+=" ";console.log(n+t)}))}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){var n,r;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */e.stats_.incrementCounter(t),n=e.statsReporter_,r=t,n.statsToReport_[r]=!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function({app:e,url:t,version:n,customAuthImpl:r,namespace:i,nodeAdmin:s=!1}){_T(n);const o=new Ea("auth-internal",new Ca("database-standalone"));return o.setComponent(new Ta("auth-internal",(()=>r),"PRIVATE")),{instance:new sT(lb(e,o,void 0,t,s),e),namespace:i}}});
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const NT=CT;CT.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},CT.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};const PT=TT,xT=
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=bb.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&bb.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};var DT=Object.freeze({__proto__:null,DataConnection:NT,RealTimeConnection:PT,hijackHash:function(e){const t=CT.prototype.put;return CT.prototype.put=function(n,r,i,s){void 0!==s&&(s=e()),t.call(this,n,r,i,s)},function(){CT.prototype.put=t}},ConnectionTarget:xT,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){}});const OT=sT.ServerValue;!function(e){_T(e.SDK_VERSION),e.INTERNAL.registerComponent(new Ta("database-compat",((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database-exp").getImmediate({identifier:t});return new sT(r,n)}),"PUBLIC").setServiceProps({Reference:iT,Query:rT,Database:sT,DataSnapshot:nT,enableLogging:pb,INTERNAL:AT,ServerValue:OT,TEST_ACCESS:DT}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","0.0.900-exp.6ef484a04")}(oc);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var MT=function(e,t){return(MT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function LT(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var FT,UT="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},qT=qT||{},jT=UT||self;function VT(){}function BT(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function $T(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var WT="closure_uid_"+(1e9*Math.random()>>>0),KT=0;function zT(e,t,n){return e.call.apply(e.bind,arguments)}function HT(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function GT(e,t,n){return(GT=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?zT:HT).apply(null,arguments)}function QT(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function YT(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function JT(){this.s=this.s,this.o=this.o}var XT={};JT.prototype.s=!1,JT.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,WT)&&e[WT]||(e[WT]=++KT)}(this);delete XT[e]}},JT.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var ZT=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},eI=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function tI(e){return Array.prototype.concat.apply([],arguments)}function nI(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function rI(e){return/^[\s\xa0]*$/.test(e)}var iI,sI=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function oI(e,t){return-1!=e.indexOf(t)}function aI(e,t){return e<t?-1:e>t?1:0}e:{var cI=jT.navigator;if(cI){var uI=cI.userAgent;if(uI){iI=uI;break e}}iI=""}function lI(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function hI(e){var t={};for(var n in e)t[n]=e[n];return t}var dI="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fI(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<dI.length;s++)n=dI[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function pI(e){return pI[" "](e),e}pI[" "]=VT;var gI,mI,yI=oI(iI,"Opera"),_I=oI(iI,"Trident")||oI(iI,"MSIE"),vI=oI(iI,"Edge"),wI=vI||_I,bI=oI(iI,"Gecko")&&!(oI(iI.toLowerCase(),"webkit")&&!oI(iI,"Edge"))&&!(oI(iI,"Trident")||oI(iI,"MSIE"))&&!oI(iI,"Edge"),TI=oI(iI.toLowerCase(),"webkit")&&!oI(iI,"Edge");function II(){var e=jT.document;return e?e.documentMode:void 0}e:{var EI="",SI=(mI=iI,bI?/rv:([^\);]+)(\)|;)/.exec(mI):vI?/Edge\/([\d\.]+)/.exec(mI):_I?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(mI):TI?/WebKit\/(\S+)/.exec(mI):yI?/(?:Version)[ \/]?(\S+)/.exec(mI):void 0);if(SI&&(EI=SI?SI[1]:""),_I){var kI=II();if(null!=kI&&kI>parseFloat(EI)){gI=String(kI);break e}}gI=EI}var CI,RI={};function AI(){return function(e){var t=RI;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=sI(String(gI)).split("."),n=sI("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var s=t[i]||"",o=n[i]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==s[0].length&&0==o[0].length)break;e=aI(0==s[1].length?0:parseInt(s[1],10),0==o[1].length?0:parseInt(o[1],10))||aI(0==s[2].length,0==o[2].length)||aI(s[2],o[2]),s=s[3],o=o[3]}while(0==e)}return 0<=e}))}if(jT.document&&_I){var NI=II();CI=NI||(parseInt(gI,10)||void 0)}else CI=void 0;var PI=CI,xI=function(){if(!jT.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{jT.addEventListener("test",VT,t),jT.removeEventListener("test",VT,t)}catch(e){}return e}();function DI(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function OI(e,t){if(DI.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(bI){e:{try{pI(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:MI[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&OI.Z.h.call(this)}}DI.prototype.h=function(){this.defaultPrevented=!0},YT(OI,DI);var MI={2:"touch",3:"pen",4:"mouse"};OI.prototype.h=function(){OI.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var LI="closure_listenable_"+(1e6*Math.random()|0),FI=0;function UI(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++FI,this.ca=this.fa=!1}function qI(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function jI(e){this.src=e,this.g={},this.h=0}function VI(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=ZT(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(qI(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function BI(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}jI.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=BI(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new UI(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var $I="closure_lm_"+(1e6*Math.random()|0),WI={};function KI(e,t,n,r,i){if(r&&r.once)return HI(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)KI(e,t[s],n,r,i);return null}return n=eE(n),e&&e[LI]?e.N(t,n,$T(r)?!!r.capture:!!r,i):zI(e,t,n,!1,r,i)}function zI(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=$T(i)?!!i.capture:!!i,a=XI(e);if(a||(e[$I]=a=new jI(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=JI;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)xI||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(YI(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function HI(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)HI(e,t[s],n,r,i);return null}return n=eE(n),e&&e[LI]?e.O(t,n,$T(r)?!!r.capture:!!r,i):zI(e,t,n,!0,r,i)}function GI(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)GI(e,t[s],n,r,i);else r=$T(r)?!!r.capture:!!r,n=eE(n),e&&e[LI]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=BI(s=e.g[t],n,r,i))&&(qI(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=XI(e))&&(t=e.g[t.toString()],e=-1,t&&(e=BI(t,n,r,i)),(n=-1<e?t[e]:null)&&QI(n))}function QI(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[LI])VI(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(YI(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=XI(t))?(VI(n,e),0==n.h&&(n.src=null,t[$I]=null)):qI(e)}}}function YI(e){return e in WI?WI[e]:WI[e]="on"+e}function JI(e,t){if(e.ca)e=!0;else{t=new OI(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&QI(e),e=n.call(r,t)}return e}function XI(e){return(e=e[$I])instanceof jI?e:null}var ZI="__closure_events_fn_"+(1e9*Math.random()>>>0);function eE(e){return"function"==typeof e?e:(e[ZI]||(e[ZI]=function(t){return e.handleEvent(t)}),e[ZI])}function tE(){JT.call(this),this.i=new jI(this),this.P=this,this.I=null}function nE(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new DI(t,e);else if(t instanceof DI)t.target=t.target||e;else{var i=t;fI(t=new DI(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=rE(o,r,!0,t)&&i}if(i=rE(o=t.g=e,r,!0,t)&&i,i=rE(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=rE(o=t.g=n[s],r,!1,t)&&i}function rE(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&VI(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}YT(tE,JT),tE.prototype[LI]=!0,tE.prototype.removeEventListener=function(e,t,n,r){GI(this,e,t,n,r)},tE.prototype.M=function(){if(tE.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)qI(n[r]);delete t.g[e],t.h--}}this.I=null},tE.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},tE.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var iE=jT.JSON.stringify;function sE(){var e=fE,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var oE,aE=function(){function e(){this.h=this.g=null}return e.prototype.add=function(e,t){var n=cE.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n},e}(),cE=new(function(){function e(e,t){this.i=e,this.j=t,this.h=0,this.g=null}return e.prototype.get=function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e},e}())((function(){return new uE}),(function(e){return e.reset()})),uE=function(){function e(){this.next=this.g=this.h=null}return e.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},e.prototype.reset=function(){this.next=this.g=this.h=null},e}();function lE(e){jT.setTimeout((function(){throw e}),0)}function hE(e,t){oE||function(){var e=jT.Promise.resolve(void 0);oE=function(){e.then(pE)}}(),dE||(oE(),dE=!0),fE.add(e,t)}var dE=!1,fE=new aE;function pE(){for(var e;e=sE();){try{e.h.call(e.g)}catch(e){lE(e)}var t=cE;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}dE=!1}function gE(e,t){tE.call(this),this.h=e||1,this.g=t||jT,this.j=GT(this.kb,this),this.l=Date.now()}function mE(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function yE(e,t,n){if("function"==typeof e)n&&(e=GT(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=GT(e.handleEvent,e)}return 2147483647<Number(t)?-1:jT.setTimeout(e,t||0)}function _E(e){e.g=yE((function(){e.g=null,e.i&&(e.i=!1,_E(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}YT(gE,tE),(FT=gE.prototype).da=!1,FT.S=null,FT.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),nE(this,"tick"),this.da&&(mE(this),this.start()))}},FT.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},FT.M=function(){gE.Z.M.call(this),mE(this),delete this.g};var vE=function(e){function t(t,n){var r=e.call(this)||this;return r.m=t,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}MT(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:_E(this)},t.prototype.M=function(){e.prototype.M.call(this),this.g&&(jT.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},t}(JT);function wE(e){JT.call(this),this.h=e,this.g={}}YT(wE,JT);var bE=[];function TE(e,t,n,r){Array.isArray(n)||(n&&(bE[0]=n.toString()),n=bE);for(var i=0;i<n.length;i++){var s=KI(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function IE(e){lI(e.g,(function(e,t){this.g.hasOwnProperty(t)&&QI(e)}),e),e.g={}}function EE(){this.g=!0}function SE(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return iE(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}wE.prototype.M=function(){wE.Z.M.call(this),IE(this)},wE.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},EE.prototype.Aa=function(){this.g=!1},EE.prototype.info=function(){};var kE={},CE=null;function RE(){return CE=CE||new tE}function AE(e){DI.call(this,kE.Ma,e)}function NE(e){var t=RE();nE(t,new AE(t,e))}function PE(e,t){DI.call(this,kE.STAT_EVENT,e),this.stat=t}function xE(e){var t=RE();nE(t,new PE(t,e))}function DE(e,t){DI.call(this,kE.Na,e),this.size=t}function OE(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return jT.setTimeout((function(){e()}),t)}kE.Ma="serverreachability",YT(AE,DI),kE.STAT_EVENT="statevent",YT(PE,DI),kE.Na="timingevent",YT(DE,DI);var ME={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},LE={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function FE(){}function UE(e){return e.h||(e.h=e.i())}function qE(){}FE.prototype.h=null;var jE,VE={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function BE(){DI.call(this,"d")}function $E(){DI.call(this,"c")}function WE(){}function KE(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new wE(this),this.P=HE,e=wI?125:void 0,this.W=new gE(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new zE}function zE(){this.i=null,this.g="",this.h=!1}YT(BE,DI),YT($E,DI),YT(WE,FE),WE.prototype.g=function(){return new XMLHttpRequest},WE.prototype.i=function(){return{}},jE=new WE;var HE=45e3,GE={},QE={};function YE(e,t,n){e.K=1,e.v=vS(fS(t)),e.s=n,e.U=!0,JE(e,null)}function JE(e,t){e.F=Date.now(),tS(e),e.A=fS(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),xS(n.h,"t",r),e.C=0,n=e.l.H,e.h=new zE,e.g=Dk(e.l,n?t:null,!e.s),0<e.O&&(e.L=new vE(GT(e.Ia,e,e.g),e.O)),TE(e.V,e.g,"readystatechange",e.gb),t=e.H?hI(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),NE(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function XE(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function ZE(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=eS(e,n))==QE){4==t&&(e.o=4,xE(14),i=!1),SE(e.j,e.m,null,"[Incomplete Response]");break}if(r==GE){e.o=4,xE(15),SE(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}SE(e.j,e.m,r,null),oS(e,r)}XE(e)&&r!=QE&&r!=GE&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,xE(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Sk(t),t.L=!0,xE(11))):(SE(e.j,e.m,n,"[Invalid Chunked Response]"),sS(e),iS(e))}function eS(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?QE:(n=Number(t.substring(n,r)),isNaN(n)?GE:(r+=1)+n>t.length?QE:(t=t.substr(r,n),e.C=r+n,t))}function tS(e){e.Y=Date.now()+e.P,nS(e,e.P)}function nS(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=OE(GT(e.eb,e),t)}function rS(e){e.B&&(jT.clearTimeout(e.B),e.B=null)}function iS(e){0==e.l.G||e.I||Rk(e.l,e)}function sS(e){rS(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,mE(e.W),IE(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function oS(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||qS(n.i,e)))if(n.I=e.N,!e.J&&qS(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(s){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;Ck(n),mk(n)}Ek(n),xE(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=OE(GT(n.ab,n),6e3));if(1>=US(n.i)&&n.ka){try{n.ka()}catch(s){}n.ka=void 0}}else Nk(n,11)}else if((e.J||n.g==e)&&Ck(n),!rI(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.U=s[0],s=s[1],2==n.G)if("c"==s[0]){n.J=s[1],n.la=s[2];var o=s[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var a=s[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=e.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(oI(l,"spdy")||oI(l,"quic")||oI(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(jS(h,h.h),h.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.sa=d,_S(r.F,r.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var f=e;if((r=n).oa=xk(r,r.H?r.la:null,r.W),f.J){VS(r.i,f);var p=f,g=r.K;g&&p.setTimeout(g),p.B&&(rS(p),tS(p)),r.g=f}else Ik(r);0<n.l.length&&vk(n)}else"stop"!=s[0]&&"close"!=s[0]||Nk(n,7);else 3==n.G&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?Nk(n,7):gk(n):"noop"!=s[0]&&n.j&&n.j.wa(s),n.A=0)}NE(4)}catch(s){}}function aS(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(BT(e)||"string"==typeof e)eI(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(BT(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(BT(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function cS(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof cS)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function uS(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];lS(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)lS(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function lS(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(FT=KE.prototype).setTimeout=function(e){this.P=e},FT.gb=function(e){e=e.target;var t=this.L;t&&3==lk(e)?t.l():this.Ia(e)},FT.Ia=function(e){try{if(e==this.g)e:{var t=lk(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||wI||this.g&&(this.h.h||this.g.ga()||hk(this.g)))){this.I||4!=t||7==n||NE(8==n||0>=r?3:2),rS(this);var i=this.g.ba();this.N=i;t:if(XE(this)){var s=hk(this.g);e="";var o=s.length,a=4==lk(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){sS(this),iS(this);var c="";break t}this.h.i=new jT.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.splice(0,o),this.h.g+=e,this.C=0,c=this.h.g}else c=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!rI(u)){var h=u;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,xE(12),sS(this),iS(this);break e}SE(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,oS(this,i)}this.U?(ZE(this,t,c),wI&&this.i&&3==t&&(TE(this.V,this.W,"tick",this.fb),this.W.start())):(SE(this.j,this.m,c,null),oS(this,c)),4==t&&sS(this),this.i&&!this.I&&(4==t?Rk(this.l,this):(this.i=!1,tS(this)))}else 400==i&&0<c.indexOf("Unknown SID")?(this.o=3,xE(12)):(this.o=0,xE(13)),sS(this),iS(this)}}}catch(t){}},FT.fb=function(){if(this.g){var e=lk(this.g),t=this.g.ga();this.C<t.length&&(rS(this),ZE(this,e,t),this.i&&4!=e&&tS(this))}},FT.cancel=function(){this.I=!0,sS(this)},FT.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(NE(3),xE(17)),sS(this),this.o=2,iS(this)):nS(this,this.Y-e)},(FT=cS.prototype).R=function(){uS(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},FT.T=function(){return uS(this),this.g.concat()},FT.get=function(e,t){return lS(this.h,e)?this.h[e]:t},FT.set=function(e,t){lS(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},FT.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var hS=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function dS(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof dS){this.g=void 0!==t?t:e.g,pS(this,e.j),this.s=e.s,gS(this,e.i),mS(this,e.m),this.l=e.l,t=e.h;var n=new RS;n.i=t.i,t.g&&(n.g=new cS(t.g),n.h=t.h),yS(this,n),this.o=e.o}else e&&(n=String(e).match(hS))?(this.g=!!t,pS(this,n[1]||"",!0),this.s=wS(n[2]||""),gS(this,n[3]||"",!0),mS(this,n[4]),this.l=wS(n[5]||"",!0),yS(this,n[6]||"",!0),this.o=wS(n[7]||"")):(this.g=!!t,this.h=new RS(null,this.g))}function fS(e){return new dS(e)}function pS(e,t,n){e.j=n?wS(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function gS(e,t,n){e.i=n?wS(t,!0):t}function mS(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function yS(e,t,n){t instanceof RS?(e.h=t,function(e,t){t&&!e.j&&(AS(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(NS(this,t),xS(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=bS(t,kS)),e.h=new RS(t,e.g))}function _S(e,t,n){e.h.set(t,n)}function vS(e){return _S(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function wS(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function bS(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,TS),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function TS(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}dS.prototype.toString=function(){var e=[],t=this.j;t&&e.push(bS(t,IS,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(bS(t,IS,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(bS(n,"/"==n.charAt(0)?SS:ES,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",bS(n,CS)),e.join("")};var IS=/[#\/\?@]/g,ES=/[#\?:]/g,SS=/[#\?]/g,kS=/[#\?@]/g,CS=/#/g;function RS(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function AS(e){e.g||(e.g=new cS,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function NS(e,t){AS(e),t=DS(e,t),lS(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,lS((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&uS(e)))}function PS(e,t){return AS(e),t=DS(e,t),lS(e.g.h,t)}function xS(e,t,n){NS(e,t),0<n.length&&(e.i=null,e.g.set(DS(e,t),nI(n)),e.h+=n.length)}function DS(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(FT=RS.prototype).add=function(e,t){AS(this),this.i=null,e=DS(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},FT.forEach=function(e,t){AS(this),this.g.forEach((function(n,r){eI(n,(function(n){e.call(t,n,r,this)}),this)}),this)},FT.T=function(){AS(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},FT.R=function(e){AS(this);var t=[];if("string"==typeof e)PS(this,e)&&(t=tI(t,this.g.get(DS(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=tI(t,e[n])}return t},FT.set=function(e,t){return AS(this),this.i=null,PS(this,e=DS(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},FT.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},FT.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var OS=function(e,t){this.h=e,this.g=t};function MS(e){this.l=e||LS,jT.PerformanceNavigationTiming?e=0<(e=jT.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(jT.g&&jT.g.Ea&&jT.g.Ea()&&jT.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var LS=10;function FS(e){return!!e.h||!!e.g&&e.g.size>=e.j}function US(e){return e.h?1:e.g?e.g.size:0}function qS(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function jS(e,t){e.g?e.g.add(t):e.h=t}function VS(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function BS(e){var t,n;if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var r=e.i;try{for(var i=LT(e.g.values()),s=i.next();!s.done;s=i.next()){var o=s.value;r=r.concat(o.D)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return nI(e.i)}function $S(){}function WS(){this.g=new $S}function KS(e,t,n){var r=n||"";try{aS(e,(function(e,n){var i=e;$T(e)&&(i=iE(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function zS(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function HS(e){this.l=e.$b||null,this.j=e.ib||!1}function GS(e,t){tE.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=QS,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}MS.prototype.cancel=function(){var e,t;if(this.i=BS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=LT(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}},$S.prototype.stringify=function(e){return jT.JSON.stringify(e,void 0)},$S.prototype.parse=function(e){return jT.JSON.parse(e,void 0)},YT(HS,FE),HS.prototype.g=function(){return new GS(this.l,this.j)},HS.prototype.i=function(e){return function(){return e}}({}),YT(GS,tE);var QS=0;function YS(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function JS(e){e.readyState=4,e.l=null,e.j=null,e.A=null,XS(e)}function XS(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(FT=GS.prototype).open=function(e,t){if(this.readyState!=QS)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,XS(this)},FT.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||jT).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},FT.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,JS(this)),this.readyState=QS},FT.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,XS(this)),this.g&&(this.readyState=3,XS(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==jT.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;YS(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},FT.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?JS(this):XS(this),3==this.readyState&&YS(this)}},FT.Ua=function(e){this.g&&(this.response=this.responseText=e,JS(this))},FT.Ta=function(e){this.g&&(this.response=e,JS(this))},FT.ha=function(){this.g&&JS(this)},FT.setRequestHeader=function(e,t){this.v.append(e,t)},FT.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},FT.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(GS.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var ZS=jT.JSON.parse;function ek(e){tE.call(this),this.headers=new cS,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=tk,this.K=this.L=!1}YT(ek,tE);var tk="",nk=/^https?$/i,rk=["POST","PUT"];function ik(e){return"content-type"==e.toLowerCase()}function sk(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,ok(e),ck(e)}function ok(e){e.D||(e.D=!0,nE(e,"complete"),nE(e,"error"))}function ak(e){if(e.h&&void 0!==qT&&(!e.C[1]||4!=lk(e)||2!=e.ba()))if(e.v&&4==lk(e))yE(e.Fa,0,e);else if(nE(e,"readystatechange"),4==lk(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.H).match(hS)[1]||null;if(!s&&jT.self&&jT.self.location){var o=jT.self.location.protocol;s=o.substr(0,o.length-1)}i=!nk.test(s?s.toLowerCase():"")}t=i}if(t)nE(e,"complete"),nE(e,"success");else{e.m=6;try{var a=2<lk(e)?e.g.statusText:""}catch(e){a=""}e.j=a+" ["+e.ba()+"]",ok(e)}}finally{ck(e)}}}function ck(e,t){if(e.g){uk(e);var n=e.g,r=e.C[0]?VT:null;e.g=null,e.C=null,t||nE(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function uk(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(jT.clearTimeout(e.A),e.A=null)}function lk(e){return e.g?e.g.readyState:0}function hk(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case tk:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function dk(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return lI(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):_S(e,t,n))}function fk(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function pk(e){this.za=0,this.l=[],this.h=new EE,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=fk("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=fk("baseRetryDelayMs",5e3,e),this.$a=fk("retryDelaySeedMs",1e4,e),this.Ya=fk("forwardChannelMaxRetries",2,e),this.ra=fk("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new MS(e&&e.concurrentRequestLimit),this.Ca=new WS,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function gk(e){if(yk(e),3==e.G){var t=e.V++,n=fS(e.F);_S(n,"SID",e.J),_S(n,"RID",t),_S(n,"TYPE","terminate"),bk(e,n),(t=new KE(e,e.h,t,void 0)).K=2,t.v=vS(fS(n)),n=!1,jT.navigator&&jT.navigator.sendBeacon&&(n=jT.navigator.sendBeacon(t.v.toString(),"")),!n&&jT.Image&&((new Image).src=t.v,n=!0),n||(t.g=Dk(t.l,null),t.g.ea(t.v)),t.F=Date.now(),tS(t)}Pk(e)}function mk(e){e.g&&(Sk(e),e.g.cancel(),e.g=null)}function yk(e){mk(e),e.u&&(jT.clearTimeout(e.u),e.u=null),Ck(e),e.i.cancel(),e.m&&("number"==typeof e.m&&jT.clearTimeout(e.m),e.m=null)}function _k(e,t){e.l.push(new OS(e.Za++,t)),3==e.G&&vk(e)}function vk(e){FS(e.i)||e.m||(e.m=!0,hE(e.Ha,e),e.C=0)}function wk(e,t){var n;n=t?t.m:e.V++;var r=fS(e.F);_S(r,"SID",e.J),_S(r,"RID",n),_S(r,"AID",e.U),bk(e,r),e.o&&e.s&&dk(r,e.o,e.s),n=new KE(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Tk(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),jS(e.i,n),YE(n,r,t)}function bk(e,t){e.j&&aS({},(function(e,n){_S(t,n,e)}))}function Tk(e,t,n){n=Math.min(e.l.length,n);var r=e.j?GT(e.j.Oa,e.j,e):null;e:for(var i=e.l,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].h,l=i[c].g;if(0>(u-=s))s=Math.max(0,i[c].h-100),a=!1;else try{KS(l,o,"req"+u+"_")}catch(e){r&&r(l)}}if(a){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function Ik(e){e.g||e.u||(e.Y=1,hE(e.Ga,e),e.A=0)}function Ek(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=OE(GT(e.Ga,e),Ak(e,e.A)),e.A++,!0)}function Sk(e){null!=e.B&&(jT.clearTimeout(e.B),e.B=null)}function kk(e){e.g=new KE(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=fS(e.oa);_S(t,"RID","rpc"),_S(t,"SID",e.J),_S(t,"CI",e.N?"0":"1"),_S(t,"AID",e.U),bk(e,t),_S(t,"TYPE","xmlhttp"),e.o&&e.s&&dk(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=vS(fS(t)),n.s=null,n.U=!0,JE(n,e)}function Ck(e){null!=e.v&&(jT.clearTimeout(e.v),e.v=null)}function Rk(e,t){var n=null;if(e.g==t){Ck(e),Sk(e),e.g=null;var r=2}else{if(!qS(e.i,t))return;n=t.D,VS(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;nE(r=RE(),new DE(r,n,t,i)),vk(e)}else Ik(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(US(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=OE(GT(e.Ha,e,t),Ak(e,e.C)),e.C++,0)))}(e,t)||2==r&&Ek(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Nk(e,5);break;case 4:Nk(e,10);break;case 3:Nk(e,6);break;default:Nk(e,2)}}function Ak(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function Nk(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=GT(e.jb,e);n||(n=new dS("//www.google.com/images/cleardot.gif"),jT.location&&"http"==jT.location.protocol||pS(n,"https"),vS(n)),function(e,t){var n=new EE;if(jT.Image){var r=new Image;r.onload=QT(zS,n,r,"TestLoadImage: loaded",!0,t),r.onerror=QT(zS,n,r,"TestLoadImage: error",!1,t),r.onabort=QT(zS,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=QT(zS,n,r,"TestLoadImage: timeout",!1,t),jT.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else xE(2);e.G=0,e.j&&e.j.va(t),Pk(e),yk(e)}function Pk(e){e.G=0,e.I=-1,e.j&&(0==BS(e.i).length&&0==e.l.length||(e.i.i.length=0,nI(e.l),e.l.length=0),e.j.ua())}function xk(e,t,n){var r=function(e){return e instanceof dS?fS(e):new dS(e,void 0)}(n);if(""!=r.i)t&&gS(r,t+"."+r.i),mS(r,r.m);else{var i=jT.location;r=function(e,t,n,r){var i=new dS(null,void 0);return e&&pS(i,e),t&&gS(i,t),n&&mS(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&lI(e.aa,(function(e,t){_S(r,t,e)})),t=e.D,n=e.sa,t&&n&&_S(r,t,n),_S(r,"VER",e.ma),bk(e,r),r}function Dk(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new ek(new HS({ib:!0})):new ek(e.qa)).L=e.H,t}function Ok(){}function Mk(){if(_I&&!(10<=Number(PI)))throw Error("Environmental error: no available transport.")}function Lk(e,t){tE.call(this),this.g=new pk(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!rI(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!rI(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new qk(this)}function Fk(e){BE.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Uk(){$E.call(this),this.status=1}function qk(e){this.g=e}(FT=ek.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():jE.g(),this.C=this.u?UE(this.u):UE(jE),this.g.onreadystatechange=GT(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void sk(this,e)}e=n||"";var i=new cS(this.headers);r&&aS(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=ik,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=jT.FormData&&e instanceof jT.FormData,!(0<=ZT(rk,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{uk(this),0<this.B&&((this.K=function(e){return _I&&AI()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=GT(this.pa,this)):this.A=yE(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){sk(this,e)}},FT.pa=function(){void 0!==qT&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,nE(this,"timeout"),this.abort(8))},FT.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,nE(this,"complete"),nE(this,"abort"),ck(this))},FT.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ck(this,!0)),ek.Z.M.call(this)},FT.Fa=function(){this.s||(this.F||this.v||this.l?ak(this):this.cb())},FT.cb=function(){ak(this)},FT.ba=function(){try{return 2<lk(this)?this.g.status:-1}catch(e){return-1}},FT.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},FT.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ZS(t)}},FT.Da=function(){return this.m},FT.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(FT=pk.prototype).ma=8,FT.G=1,FT.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},FT.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new KE(this,this.h,e,void 0),n=this.s;if(this.P&&(n?fI(n=hI(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var s=this.l[i];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(r+=s)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Tk(this,t,r),_S(i=fS(this.F),"RID",e),_S(i,"CVER",22),this.D&&_S(i,"X-HTTP-Session-Id",this.D),bk(this,i),this.o&&n&&dk(i,this.o,n),jS(this.i,t),this.Ra&&_S(i,"TYPE","init"),this.ja?(_S(i,"$req",r),_S(i,"SID","null"),t.$=!0,YE(t,i,null)):YE(t,i,r),this.G=2}}else 3==this.G&&(e?wk(this,e):0==this.l.length||FS(this.i)||wk(this))},FT.Ga=function(){if(this.u=null,kk(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=OE(GT(this.bb,this),e)}},FT.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,xE(10),mk(this),kk(this))},FT.ab=function(){null!=this.v&&(this.v=null,mk(this),Ek(this),xE(19))},FT.jb=function(e){e?(this.h.info("Successfully pinged google.com"),xE(2)):(this.h.info("Failed to ping google.com"),xE(1))},(FT=Ok.prototype).xa=function(){},FT.wa=function(){},FT.va=function(){},FT.ua=function(){},FT.Oa=function(){},Mk.prototype.g=function(e,t){return new Lk(e,t)},YT(Lk,tE),Lk.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),hE(GT(e.hb,e,t))),xE(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=xk(e,null,e.W),vk(e)},Lk.prototype.close=function(){gk(this.g)},Lk.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,_k(this.g,t)}else this.v?((t={}).__data__=iE(e),_k(this.g,t)):_k(this.g,e)},Lk.prototype.M=function(){this.g.j=null,delete this.j,gk(this.g),delete this.g,Lk.Z.M.call(this)},YT(Fk,BE),YT(Uk,$E),YT(qk,Ok),qk.prototype.xa=function(){nE(this.g,"a")},qk.prototype.wa=function(e){nE(this.g,new Fk(e))},qk.prototype.va=function(e){nE(this.g,new Uk(e))},qk.prototype.ua=function(){nE(this.g,"b")},Mk.prototype.createWebChannel=Mk.prototype.g,Lk.prototype.send=Lk.prototype.u,Lk.prototype.open=Lk.prototype.m,Lk.prototype.close=Lk.prototype.close,ME.NO_ERROR=0,ME.TIMEOUT=8,ME.HTTP_ERROR=6,LE.COMPLETE="complete",qE.EventType=VE,VE.OPEN="a",VE.CLOSE="b",VE.ERROR="c",VE.MESSAGE="d",tE.prototype.listen=tE.prototype.N,ek.prototype.listenOnce=ek.prototype.O,ek.prototype.getLastError=ek.prototype.La,ek.prototype.getLastErrorCode=ek.prototype.Da,ek.prototype.getStatus=ek.prototype.ba,ek.prototype.getResponseJson=ek.prototype.Qa,ek.prototype.getResponseText=ek.prototype.ga,ek.prototype.send=ek.prototype.ea;var jk=ME,Vk=LE,Bk=kE,$k=10,Wk=11,Kk=HS,zk=qE,Hk=ek;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Gk="8.7.1";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Qk{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.t(e),this.i=e=>t.writeSequenceNumber(e))}t(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.i&&this.i(e),e}}Qk.o=-1;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Yk={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jk extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Xk=new Da("@firebase/firestore");function Zk(){return Xk.logLevel}function eC(e,...t){if(Xk.logLevel<=ka.DEBUG){const n=t.map(rC);Xk.debug(`Firestore (${Gk}): ${e}`,...n)}}function tC(e,...t){if(Xk.logLevel<=ka.ERROR){const n=t.map(rC);Xk.error(`Firestore (${Gk}): ${e}`,...n)}}function nC(e,...t){if(Xk.logLevel<=ka.WARN){const n=t.map(rC);Xk.warn(`Firestore (${Gk}): ${e}`,...n)}}function rC(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function iC(e="Unexpected state"){const t=`FIRESTORE (${Gk}) INTERNAL ASSERTION FAILED: `+e;throw tC(t),new Error(t)}function sC(e,t){e||iC()}function oC(e,t){return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function aC(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cC{static u(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=aC(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function uC(e,t){return e<t?-1:e>t?1:0}function lC(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function hC(e){return e+"\0"}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class dC{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Jk(Yk.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Jk(Yk.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Jk(Yk.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Jk(Yk.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return dC.fromMillis(Date.now())}static fromDate(e){return dC.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new dC(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?uC(this.nanoseconds,e.nanoseconds):uC(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class fC{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fC(e)}static min(){return new fC(new dC(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function pC(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function gC(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function mC(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yC{constructor(e,t,n){void 0===t?t=0:t>e.length&&iC(),void 0===n?n=e.length-t:n>e.length-t&&iC(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===yC.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof yC?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class _C extends yC{construct(e,t,n){return new _C(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Jk(Yk.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new _C(t)}static emptyPath(){return new _C([])}}const vC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wC extends yC{construct(e,t,n){return new wC(e,t,n)}static isValidIdentifier(e){return vC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wC.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new wC(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Jk(Yk.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Jk(Yk.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Jk(Yk.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Jk(Yk.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wC(t)}static emptyPath(){return new wC([])}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bC{constructor(e){this.fields=e,e.sort(wC.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lC(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class TC{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new TC(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new TC(t)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return uC(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}TC.EMPTY_BYTE_STRING=new TC("");const IC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function EC(e){if(sC(!!e),"string"==typeof e){let t=0;const n=IC.exec(e);if(sC(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:SC(e.seconds),nanos:SC(e.nanos)}}function SC(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function kC(e){return"string"==typeof e?TC.fromBase64String(e):TC.fromUint8Array(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function CC(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function RC(e){const t=e.mapValue.fields.__previous_value__;return CC(t)?RC(t):t}function AC(e){const t=EC(e.mapValue.fields.__local_write_time__.timestampValue);return new dC(t.seconds,t.nanos)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function NC(e){return null==e}function PC(e){return 0===e&&1/e==-1/0}function xC(e){return"number"==typeof e&&Number.isInteger(e)&&!PC(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class DC{constructor(e){this.path=e}static fromPath(e){return new DC(_C.fromString(e))}static fromName(e){return new DC(_C.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===_C.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return _C.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DC(new _C(e.slice()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function OC(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?CC(e)?4:10:iC()}function MC(e,t){const n=OC(e);if(n!==OC(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return AC(e).isEqual(AC(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=EC(e.timestampValue),r=EC(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return kC(e.bytesValue).isEqual(kC(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return SC(e.geoPointValue.latitude)===SC(t.geoPointValue.latitude)&&SC(e.geoPointValue.longitude)===SC(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return SC(e.integerValue)===SC(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=SC(e.doubleValue),r=SC(t.doubleValue);return n===r?PC(n)===PC(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return lC(e.arrayValue.values||[],t.arrayValue.values||[],MC);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(pC(n)!==pC(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!MC(n[e],r[e])))return!1;return!0}(e,t);default:return iC()}}function LC(e,t){return void 0!==(e.values||[]).find((e=>MC(e,t)))}function FC(e,t){const n=OC(e),r=OC(t);if(n!==r)return uC(n,r);switch(n){case 0:return 0;case 1:return uC(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=SC(e.integerValue||e.doubleValue),r=SC(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return UC(e.timestampValue,t.timestampValue);case 4:return UC(AC(e),AC(t));case 5:return uC(e.stringValue,t.stringValue);case 6:return function(e,t){const n=kC(e),r=kC(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=uC(n[e],r[e]);if(0!==t)return t}return uC(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=uC(SC(e.latitude),SC(t.latitude));return 0!==n?n:uC(SC(e.longitude),SC(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=FC(n[e],r[e]);if(t)return t}return uC(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=uC(r[e],s[e]);if(0!==t)return t;const o=FC(n[r[e]],i[s[e]]);if(0!==o)return o}return uC(r.length,s.length)}(e.mapValue,t.mapValue);default:throw iC()}}function UC(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return uC(e,t);const n=EC(e),r=EC(t),i=uC(n.seconds,r.seconds);return 0!==i?i:uC(n.nanos,r.nanos)}function qC(e){return jC(e)}function jC(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=EC(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?kC(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,DC.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=jC(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${jC(e.fields[i])}`;return n+"}"}(e.mapValue):iC();var t,n}function VC(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function BC(e){return!!e&&"integerValue"in e}function $C(e){return!!e&&"arrayValue"in e}function WC(e){return!!e&&"nullValue"in e}function KC(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function zC(e){return!!e&&"mapValue"in e}function HC(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return gC(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=HC(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=HC(e.arrayValue.values[n]);return t}return Object.assign({},e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class GC{constructor(e){this.value=e}static empty(){return new GC({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!zC(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=HC(t)}setAll(e){let t=wC.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=HC(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());zC(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return MC(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];zC(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){gC(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new GC(HC(this.value))}}function QC(e){const t=[];return gC(e.fields,((e,n)=>{const r=new wC([e]);if(zC(n)){const e=QC(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new bC(t)
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class YC{constructor(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}static newInvalidDocument(e){return new YC(e,0,fC.min(),GC.empty(),0)}static newFoundDocument(e,t,n){return new YC(e,1,t,n,0)}static newNoDocument(e,t){return new YC(e,2,t,GC.empty(),0)}static newUnknownDocument(e,t){return new YC(e,3,t,GC.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=GC.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=GC.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof YC&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new YC(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class JC{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.h=null}}function XC(e,t=null,n=[],r=[],i=null,s=null,o=null){return new JC(e,t,n,r,i,s,o)}function ZC(e){const t=oC(e);if(null===t.h){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>function(e){return e.field.canonicalString()+e.op.toString()+qC(e.value)}(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),NC(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=dR(t.startAt)),t.endAt&&(e+="|ub:",e+=dR(t.endAt)),t.h=e}return t.h}function eR(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!pR(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!MC(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!mR(e.startAt,t.startAt)&&mR(e.endAt,t.endAt)}function tR(e){return DC.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class nR extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.l(e,t,n):new rR(e,t,n):"array-contains"===t?new aR(e,n):"in"===t?new cR(e,n):"not-in"===t?new uR(e,n):"array-contains-any"===t?new lR(e,n):new nR(e,t,n)}static l(e,t,n){return"in"===t?new iR(e,n):new sR(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.m(FC(t,this.value)):null!==t&&OC(this.value)===OC(t)&&this.m(FC(t,this.value))}m(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return iC()}}g(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class rR extends nR{constructor(e,t,n){super(e,t,n),this.key=DC.fromName(n.referenceValue)}matches(e){const t=DC.comparator(e.key,this.key);return this.m(t)}}class iR extends nR{constructor(e,t){super(e,"in",t),this.keys=oR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sR extends nR{constructor(e,t){super(e,"not-in",t),this.keys=oR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function oR(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>DC.fromName(e.referenceValue)))}class aR extends nR{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $C(t)&&LC(t.arrayValue,this.value)}}class cR extends nR{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&LC(this.value.arrayValue,t)}}class uR extends nR{constructor(e,t){super(e,"not-in",t)}matches(e){if(LC(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!LC(this.value.arrayValue,t)}}class lR extends nR{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$C(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>LC(this.value.arrayValue,e)))}}class hR{constructor(e,t){this.position=e,this.before=t}}function dR(e){return`${e.before?"b":"a"}:${e.position.map((e=>qC(e))).join(",")}`}class fR{constructor(e,t="asc"){this.field=e,this.dir=t}}function pR(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function gR(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?DC.comparator(DC.fromName(o.referenceValue),n.key):FC(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function mR(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!MC(e.position[n],t.position[n]))return!1;return!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yR{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt}}function _R(e,t,n,r,i,s,o,a){return new yR(e,t,n,r,i,s,o,a)}function vR(e){return new yR(e)}function wR(e){return!NC(e.limit)&&"F"===e.limitType}function bR(e){return!NC(e.limit)&&"L"===e.limitType}function TR(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function IR(e){for(const t of e.filters)if(t.g())return t.field;return null}function ER(e){return null!==e.collectionGroup}function SR(e){const t=oC(e);if(null===t.p){t.p=[];const e=IR(t),n=TR(t);if(null!==e&&null===n)e.isKeyField()||t.p.push(new fR(e)),t.p.push(new fR(wC.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.p.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new fR(wC.keyField(),e))}}}return t.p}function kR(e){const t=oC(e);if(!t.T)if("F"===t.limitType)t.T=XC(t.path,t.collectionGroup,SR(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of SR(t)){const t="desc"===n.dir?"asc":"desc";e.push(new fR(n.field,t))}const n=t.endAt?new hR(t.endAt.position,!t.endAt.before):null,r=t.startAt?new hR(t.startAt.position,!t.startAt.before):null;t.T=XC(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.T}function CR(e,t,n){return new yR(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function RR(e,t){return eR(kR(e),kR(t))&&e.limitType===t.limitType}function AR(e){return`${ZC(kR(e))}|lt:${e.limitType}`}function NR(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${qC(t.value)}`;var t})).join(", ")}]`),NC(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: "+dR(e.startAt)),e.endAt&&(t+=", endAt: "+dR(e.endAt)),`Target(${t})`}(kR(e))}; limitType=${e.limitType})`}function PR(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):DC.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!gR(e.startAt,SR(e),t))&&(!e.endAt||!gR(e.endAt,SR(e),t))}(e,t)}function xR(e){return(t,n)=>{let r=!1;for(const i of SR(e)){const e=DR(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function DR(e,t,n){const r=e.field.isKeyField()?DC.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?FC(r,i):iC()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return iC()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function OR(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:PC(t)?"-0":t}}function MR(e){return{integerValue:""+e}}function LR(e,t){return xC(t)?MR(t):OR(e,t)}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class FR{constructor(){this._=void 0}}function UR(e,t,n){return e instanceof VR?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof BR?$R(e,t):e instanceof WR?KR(e,t):function(e,t){const n=jR(e,t),r=HR(n)+HR(e.A);return BC(n)&&BC(e.A)?MR(r):OR(e.R,r)}(e,t)}function qR(e,t,n){return e instanceof BR?$R(e,t):e instanceof WR?KR(e,t):n}function jR(e,t){return e instanceof zR?BC(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class VR extends FR{}class BR extends FR{constructor(e){super(),this.elements=e}}function $R(e,t){const n=GR(t);for(const t of e.elements)n.some((e=>MC(e,t)))||n.push(t);return{arrayValue:{values:n}}}class WR extends FR{constructor(e){super(),this.elements=e}}function KR(e,t){let n=GR(t);for(const t of e.elements)n=n.filter((e=>!MC(e,t)));return{arrayValue:{values:n}}}class zR extends FR{constructor(e,t){super(),this.R=e,this.A=t}}function HR(e){return SC(e.integerValue||e.doubleValue)}function GR(e){return $C(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QR{constructor(e,t){this.field=e,this.transform=t}}class YR{constructor(e,t){this.version=e,this.transformResults=t}}class JR{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new JR}static exists(e){return new JR(void 0,e)}static updateTime(e){return new JR(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function XR(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class ZR{}function eA(e,t,n){e instanceof sA?function(e,t,n){const r=e.value.clone(),i=cA(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof oA?function(e,t,n){if(!XR(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=cA(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(aA(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function tA(e,t,n){e instanceof sA?function(e,t,n){if(!XR(e.precondition,t))return;const r=e.value.clone(),i=uA(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(iA(t),r).setHasLocalMutations()}(e,t,n):e instanceof oA?function(e,t,n){if(!XR(e.precondition,t))return;const r=uA(e.fieldTransforms,n,t),i=t.data;i.setAll(aA(e)),i.setAll(r),t.convertToFoundDocument(iA(t),i).setHasLocalMutations()}(e,t,n):function(e,t){XR(e.precondition,t)&&t.convertToNoDocument(fC.min())}(e,t)}function nA(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=jR(r.transform,e||null);null!=i&&(null==n&&(n=GC.empty()),n.set(r.field,i))}return n||null}function rA(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&lC(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof BR&&t instanceof BR||e instanceof WR&&t instanceof WR?lC(e.elements,t.elements,MC):e instanceof zR&&t instanceof zR?MC(e.A,t.A):e instanceof VR&&t instanceof VR}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function iA(e){return e.isFoundDocument()?e.version:fC.min()}class sA extends ZR{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class oA extends ZR{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function aA(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function cA(e,t,n){const r=new Map;sC(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,qR(o,a,n[i]))}return r}function uA(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,UR(e,s,t))}return r}class lA extends ZR{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class hA extends ZR{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class dA{constructor(e){this.count=e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var fA,pA;function gA(e){switch(e){case Yk.OK:return iC();case Yk.CANCELLED:case Yk.UNKNOWN:case Yk.DEADLINE_EXCEEDED:case Yk.RESOURCE_EXHAUSTED:case Yk.INTERNAL:case Yk.UNAVAILABLE:case Yk.UNAUTHENTICATED:return!1;case Yk.INVALID_ARGUMENT:case Yk.NOT_FOUND:case Yk.ALREADY_EXISTS:case Yk.PERMISSION_DENIED:case Yk.FAILED_PRECONDITION:case Yk.ABORTED:case Yk.OUT_OF_RANGE:case Yk.UNIMPLEMENTED:case Yk.DATA_LOSS:return!0;default:return iC()}}function mA(e){if(void 0===e)return tC("GRPC error has no .code"),Yk.UNKNOWN;switch(e){case fA.OK:return Yk.OK;case fA.CANCELLED:return Yk.CANCELLED;case fA.UNKNOWN:return Yk.UNKNOWN;case fA.DEADLINE_EXCEEDED:return Yk.DEADLINE_EXCEEDED;case fA.RESOURCE_EXHAUSTED:return Yk.RESOURCE_EXHAUSTED;case fA.INTERNAL:return Yk.INTERNAL;case fA.UNAVAILABLE:return Yk.UNAVAILABLE;case fA.UNAUTHENTICATED:return Yk.UNAUTHENTICATED;case fA.INVALID_ARGUMENT:return Yk.INVALID_ARGUMENT;case fA.NOT_FOUND:return Yk.NOT_FOUND;case fA.ALREADY_EXISTS:return Yk.ALREADY_EXISTS;case fA.PERMISSION_DENIED:return Yk.PERMISSION_DENIED;case fA.FAILED_PRECONDITION:return Yk.FAILED_PRECONDITION;case fA.ABORTED:return Yk.ABORTED;case fA.OUT_OF_RANGE:return Yk.OUT_OF_RANGE;case fA.UNIMPLEMENTED:return Yk.UNIMPLEMENTED;case fA.DATA_LOSS:return Yk.DATA_LOSS;default:return iC()}}(pA=fA||(fA={}))[pA.OK=0]="OK",pA[pA.CANCELLED=1]="CANCELLED",pA[pA.UNKNOWN=2]="UNKNOWN",pA[pA.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pA[pA.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pA[pA.NOT_FOUND=5]="NOT_FOUND",pA[pA.ALREADY_EXISTS=6]="ALREADY_EXISTS",pA[pA.PERMISSION_DENIED=7]="PERMISSION_DENIED",pA[pA.UNAUTHENTICATED=16]="UNAUTHENTICATED",pA[pA.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pA[pA.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pA[pA.ABORTED=10]="ABORTED",pA[pA.OUT_OF_RANGE=11]="OUT_OF_RANGE",pA[pA.UNIMPLEMENTED=12]="UNIMPLEMENTED",pA[pA.INTERNAL=13]="INTERNAL",pA[pA.UNAVAILABLE=14]="UNAVAILABLE",pA[pA.DATA_LOSS=15]="DATA_LOSS";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class yA{constructor(e,t){this.comparator=e,this.root=t||vA.EMPTY}insert(e,t){return new yA(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,vA.BLACK,null,null))}remove(e){return new yA(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vA.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _A(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _A(this.root,e,this.comparator,!1)}getReverseIterator(){return new _A(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _A(this.root,e,this.comparator,!0)}}class _A{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vA{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:vA.RED,this.left=null!=r?r:vA.EMPTY,this.right=null!=i?i:vA.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new vA(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return vA.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return vA.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vA.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vA.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw iC();if(this.right.isRed())throw iC();const e=this.left.check();if(e!==this.right.check())throw iC();return e+(this.isRed()?0:1)}}vA.EMPTY=null,vA.RED=!0,vA.BLACK=!1,vA.EMPTY=new class{constructor(){this.size=0}get key(){throw iC()}get value(){throw iC()}get color(){throw iC()}get left(){throw iC()}get right(){throw iC()}copy(e,t,n,r,i){return this}insert(e,t,n){return new vA(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class wA{constructor(e){this.comparator=e,this.data=new yA(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bA(this.data.getIterator())}getIteratorFrom(e){return new bA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof wA))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new wA(this.comparator);return t.data=e,t}}class bA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const TA=new yA(DC.comparator);function IA(){return TA}const EA=new yA(DC.comparator);function SA(){return EA}const kA=new yA(DC.comparator);function CA(){return kA}const RA=new wA(DC.comparator);function AA(...e){let t=RA;for(const n of e)t=t.add(n);return t}const NA=new wA(uC);function PA(){return NA}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xA{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,DA.createSynthesizedTargetChangeForCurrentChange(e,t)),new xA(fC.min(),n,PA(),IA(),AA())}}class DA{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new DA(TC.EMPTY_BYTE_STRING,t,AA(),AA(),AA())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class OA{constructor(e,t,n,r){this.P=e,this.removedTargetIds=t,this.key=n,this.v=r}}class MA{constructor(e,t){this.targetId=e,this.V=t}}class LA{constructor(e,t,n=TC.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class FA{constructor(){this.S=0,this.D=jA(),this.C=TC.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}get current(){return this.N}get resumeToken(){return this.C}get $(){return 0!==this.S}get O(){return this.k}F(e){e.approximateByteSize()>0&&(this.k=!0,this.C=e)}M(){let e=AA(),t=AA(),n=AA();return this.D.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:iC()}})),new DA(this.C,this.N,e,t,n)}L(){this.k=!1,this.D=jA()}B(e,t){this.k=!0,this.D=this.D.insert(e,t)}U(e){this.k=!0,this.D=this.D.remove(e)}q(){this.S+=1}K(){this.S-=1}j(){this.k=!0,this.N=!0}}class UA{constructor(e){this.W=e,this.G=new Map,this.H=IA(),this.J=qA(),this.Y=new wA(uC)}X(e){for(const t of e.P)e.v&&e.v.isFoundDocument()?this.Z(t,e.v):this.tt(t,e.key,e.v);for(const t of e.removedTargetIds)this.tt(t,e.key,e.v)}et(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.st(t)&&n.F(e.resumeToken);break;case 1:n.K(),n.$||n.L(),n.F(e.resumeToken);break;case 2:n.K(),n.$||this.removeTarget(t);break;case 3:this.st(t)&&(n.j(),n.F(e.resumeToken));break;case 4:this.st(t)&&(this.it(t),n.F(e.resumeToken));break;default:iC()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.G.forEach(((e,n)=>{this.st(n)&&t(n)}))}rt(e){const t=e.targetId,n=e.V.count,r=this.ot(t);if(r){const e=r.target;if(tR(e))if(0===n){const n=new DC(e.path);this.tt(t,n,YC.newNoDocument(n,fC.min()))}else sC(1===n);else this.ct(t)!==n&&(this.it(t),this.Y=this.Y.add(t))}}ut(e){const t=new Map;this.G.forEach(((n,r)=>{const i=this.ot(r);if(i){if(n.current&&tR(i.target)){const t=new DC(i.target.path);null!==this.H.get(t)||this.at(r,t)||this.tt(r,t,YC.newNoDocument(t,e))}n.O&&(t.set(r,n.M()),n.L())}}));let n=AA();this.J.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.ot(e);return!t||2===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))}));const r=new xA(e,t,this.Y,this.H,n);return this.H=IA(),this.J=qA(),this.Y=new wA(uC),r}Z(e,t){if(!this.st(e))return;const n=this.at(e,t.key)?2:0;this.nt(e).B(t.key,n),this.H=this.H.insert(t.key,t),this.J=this.J.insert(t.key,this.ht(t.key).add(e))}tt(e,t,n){if(!this.st(e))return;const r=this.nt(e);this.at(e,t)?r.B(t,1):r.U(t),this.J=this.J.insert(t,this.ht(t).delete(e)),n&&(this.H=this.H.insert(t,n))}removeTarget(e){this.G.delete(e)}ct(e){const t=this.nt(e).M();return this.W.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}q(e){this.nt(e).q()}nt(e){let t=this.G.get(e);return t||(t=new FA,this.G.set(e,t)),t}ht(e){let t=this.J.get(e);return t||(t=new wA(uC),this.J=this.J.insert(e,t)),t}st(e){const t=null!==this.ot(e);return t||eC("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.G.get(e);return t&&t.$?null:this.W.lt(e)}it(e){this.G.set(e,new FA),this.W.getRemoteKeysForTarget(e).forEach((t=>{this.tt(e,t,null)}))}at(e,t){return this.W.getRemoteKeysForTarget(e).has(t)}}function qA(){return new yA(DC.comparator)}function jA(){return new yA(DC.comparator)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const VA={asc:"ASCENDING",desc:"DESCENDING"},BA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class $A{constructor(e,t){this.databaseId=e,this.I=t}}function WA(e,t){return e.I?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function KA(e,t){return e.I?t.toBase64():t.toUint8Array()}function zA(e,t){return WA(e,t.toTimestamp())}function HA(e){return sC(!!e),fC.fromTimestamp(function(e){const t=EC(e);return new dC(t.seconds,t.nanos)}(e))}function GA(e,t){return function(e){return new _C(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function QA(e){const t=_C.fromString(e);return sC(vN(t)),t}function YA(e,t){return GA(e.databaseId,t.path)}function JA(e,t){const n=QA(t);if(n.get(1)!==e.databaseId.projectId)throw new Jk(Yk.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Jk(Yk.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new DC(tN(n))}function XA(e,t){return GA(e.databaseId,t)}function ZA(e){const t=QA(e);return 4===t.length?_C.emptyPath():tN(t)}function eN(e){return new _C(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function tN(e){return sC(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function nN(e,t,n){return{name:YA(e,t),fields:n.value.mapValue.fields}}function rN(e,t,n){const r=JA(e,t.name),i=HA(t.updateTime),s=new GC({mapValue:{fields:t.fields}}),o=YC.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function iN(e,t){let n;if(t instanceof sA)n={update:nN(e,t.key,t.value)};else if(t instanceof lA)n={delete:YA(e,t.key)};else if(t instanceof oA)n={update:nN(e,t.key,t.data),updateMask:_N(t.fieldMask)};else{if(!(t instanceof hA))return iC();n={verify:YA(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof VR)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof BR)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof WR)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof zR)return{fieldPath:t.field.canonicalString(),increment:n.A};throw iC()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:zA(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:iC()}(e,t.precondition)),n}function sN(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?JR.updateTime(HA(e.updateTime)):void 0!==e.exists?JR.exists(e.exists):JR.none()}(t.currentDocument):JR.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)sC("REQUEST_TIME"===t.setToServerValue),n=new VR;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new BR(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new WR(e)}else"increment"in t?n=new zR(e,t.increment):iC();const r=wC.fromServerFormat(t.fieldPath);return new QR(r,n)}(e,t))):[];if(t.update){t.update.name;const i=JA(e,t.update.name),s=new GC({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new bC(t.map((e=>wC.fromServerFormat(e))))}(t.updateMask);return new oA(i,s,e,n,r)}return new sA(i,s,n,r)}if(t.delete){const r=JA(e,t.delete);return new lA(r,n)}if(t.verify){const r=JA(e,t.verify);return new hA(r,n)}return iC()}function oN(e,t){return{documents:[XA(e,t.path)]}}function aN(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=XA(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=XA(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(KC(e.value))return{unaryFilter:{field:pN(e.field),op:"IS_NAN"}};if(WC(e.value))return{unaryFilter:{field:pN(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(KC(e.value))return{unaryFilter:{field:pN(e.field),op:"IS_NOT_NAN"}};if(WC(e.value))return{unaryFilter:{field:pN(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pN(e.field),op:fN(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:pN(e.field),direction:dN(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.I||NC(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=lN(t.startAt)),t.endAt&&(n.structuredQuery.endAt=lN(t.endAt)),n}function cN(e){let t=ZA(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){sC(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=uN(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new fR(gN(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,NC(t)?null:t}(n.limit));let c=null;n.startAt&&(c=hN(n.startAt));let u=null;return n.endAt&&(u=hN(n.endAt)),_R(t,i,o,s,a,"F",c,u)}function uN(e){return e?void 0!==e.unaryFilter?[yN(e)]:void 0!==e.fieldFilter?[mN(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>uN(e))).reduce(((e,t)=>e.concat(t))):iC():[]}function lN(e){return{before:e.before,values:e.position}}function hN(e){const t=!!e.before,n=e.values||[];return new hR(n,t)}function dN(e){return VA[e]}function fN(e){return BA[e]}function pN(e){return{fieldPath:e.canonicalString()}}function gN(e){return wC.fromServerFormat(e.fieldPath)}function mN(e){return nR.create(gN(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return iC()}}(e.fieldFilter.op),e.fieldFilter.value)}function yN(e){switch(e.unaryFilter.op){case"IS_NAN":const t=gN(e.unaryFilter.field);return nR.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=gN(e.unaryFilter.field);return nR.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=gN(e.unaryFilter.field);return nR.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=gN(e.unaryFilter.field);return nR.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return iC()}}function _N(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function vN(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function wN(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=TN(t)),t=bN(e.get(n),t);return TN(t)}function bN(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function TN(e){return e+""}function IN(e){const t=e.length;if(sC(t>=2),2===t)return sC(""===e.charAt(0)&&""===e.charAt(1)),_C.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&iC(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:iC()}s=t+2}return new _C(r)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class EN{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class SN{constructor(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}}SN.store="owner",SN.key="owner";class kN{constructor(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}}kN.store="mutationQueues",kN.keyPath="userId";class CN{constructor(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}CN.store="mutations",CN.keyPath="batchId",CN.userMutationsIndex="userMutationsIndex",CN.userMutationsKeyPath=["userId","batchId"];class RN{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,wN(t)]}static key(e,t,n){return[e,wN(t),n]}}RN.store="documentMutations",RN.PLACEHOLDER=new RN;class AN{constructor(e,t){this.path=e,this.readTime=t}}class NN{constructor(e,t){this.path=e,this.version=t}}class PN{constructor(e,t,n,r,i,s){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}PN.store="remoteDocuments",PN.readTimeIndex="readTimeIndex",PN.readTimeIndexPath="readTime",PN.collectionReadTimeIndex="collectionReadTimeIndex",PN.collectionReadTimeIndexPath=["parentPath","readTime"];class xN{constructor(e){this.byteSize=e}}xN.store="remoteDocumentGlobal",xN.key="remoteDocumentGlobalKey";class DN{constructor(e,t,n,r,i,s,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}DN.store="targets",DN.keyPath="targetId",DN.queryTargetsIndexName="queryTargetsIndex",DN.queryTargetsKeyPath=["canonicalId","targetId"];class ON{constructor(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n}}ON.store="targetDocuments",ON.keyPath=["targetId","path"],ON.documentTargetsIndex="documentTargetsIndex",ON.documentTargetsKeyPath=["path","targetId"];class MN{constructor(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}MN.key="targetGlobalKey",MN.store="targetGlobal";class LN{constructor(e,t){this.collectionId=e,this.parent=t}}LN.store="collectionParents",LN.keyPath=["collectionId","parent"];class FN{constructor(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}}FN.store="clientMetadata",FN.keyPath="clientId";class UN{constructor(e,t,n){this.bundleId=e,this.createTime=t,this.version=n}}UN.store="bundles",UN.keyPath="bundleId";class qN{constructor(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n}}qN.store="namedQueries",qN.keyPath="name";const jN=[kN.store,CN.store,RN.store,PN.store,DN.store,SN.store,MN.store,ON.store,FN.store,xN.store,LN.store,UN.store,qN.store],VN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $N{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class WN{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&iC(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new WN(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof WN?t:WN.resolve(t)}catch(e){return WN.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):WN.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):WN.reject(t)}static resolve(e){return new WN(((t,n)=>{t(e)}))}static reject(e){return new WN(((t,n)=>{n(e)}))}static waitFor(e){return new WN(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=WN.resolve(!1);for(const n of e)t=t.next((e=>e?WN.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class KN{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.ft=new $N,this.transaction.oncomplete=()=>{this.ft.resolve()},this.transaction.onabort=()=>{t.error?this.ft.reject(new GN(e,t.error)):this.ft.resolve()},this.transaction.onerror=t=>{const n=ZN(t.target.error);this.ft.reject(new GN(e,n))}}static open(e,t,n,r){try{return new KN(t,e.transaction(r,n))}catch(e){throw new GN(t,e)}}get dt(){return this.ft.promise}abort(e){e&&this.ft.reject(e),this.aborted||(eC("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new YN(t)}}class zN{constructor(e,t,n){this.name=e,this.version=t,this.wt=n,12.2===zN._t(Uo())&&tC("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return eC("SimpleDb","Removing database:",e),JN(window.indexedDB.deleteDatabase(e)).toPromise()}static gt(){if("undefined"==typeof indexedDB)return!1;if(zN.yt())return!0;const e=Uo(),t=zN._t(e),n=0<t&&t<10,r=zN.Et(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static yt(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Tt)}static It(e,t){return e.store(t)}static _t(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static Et(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async At(e){return this.db||(eC("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new GN(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Jk(Yk.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new GN(e,r))},r.onupgradeneeded=e=>{eC("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.wt.Rt(t,r.transaction,e.oldVersion,this.version).next((()=>{eC("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.Pt&&(this.db.onversionchange=e=>this.Pt(e)),this.db}bt(e){this.Pt=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.At(e);const t=KN.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).catch((e=>(t.abort(e),WN.reject(e)))).toPromise();return s.catch((()=>{})),await t.dt,s}catch(e){const t="FirebaseError"!==e.name&&s<3;if(eC("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class HN{constructor(e){this.vt=e,this.Vt=!1,this.St=null}get isDone(){return this.Vt}get Dt(){return this.St}set cursor(e){this.vt=e}done(){this.Vt=!0}Ct(e){this.St=e}delete(){return JN(this.vt.delete())}}class GN extends Jk{constructor(e,t){super(Yk.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function QN(e){return"IndexedDbTransactionError"===e.name}class YN{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(eC("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(eC("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),JN(n)}add(e){return eC("SimpleDb","ADD",this.store.name,e,e),JN(this.store.add(e))}get(e){return JN(this.store.get(e)).next((t=>(void 0===t&&(t=null),eC("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return eC("SimpleDb","DELETE",this.store.name,e),JN(this.store.delete(e))}count(){return eC("SimpleDb","COUNT",this.store.name),JN(this.store.count())}Nt(e,t){const n=this.cursor(this.options(e,t)),r=[];return this.xt(n,((e,t)=>{r.push(t)})).next((()=>r))}kt(e,t){eC("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.$t=!1;const r=this.cursor(n);return this.xt(r,((e,t,n)=>n.delete()))}Ot(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.xt(r,t)}Ft(e){const t=this.cursor({});return new WN(((n,r)=>{t.onerror=e=>{const t=ZN(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}xt(e,t){const n=[];return new WN(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new HN(i),o=t(i.primaryKey,i.value,s);if(o instanceof WN){const e=o.catch((e=>(s.done(),WN.reject(e))));n.push(e)}s.isDone?r():null===s.Dt?i.continue():i.continue(s.Dt)}})).next((()=>WN.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.$t?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function JN(e){return new WN(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=ZN(e.target.error);n(t)}}))}let XN=!1;function ZN(e){const t=zN._t(Uo());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Jk("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return XN||(XN=!0,setTimeout((()=>{throw e}),0)),e}}return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eP extends BN{constructor(e,t){super(),this.Mt=e,this.currentSequenceNumber=t}}function tP(e,t){const n=oC(e);return zN.It(n.Mt,t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nP{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&eA(r,e,n[t])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&tA(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&tA(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach((t=>{const n=e.get(t.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument(fC.min())}))}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),AA())}isEqual(e){return this.batchId===e.batchId&&lC(this.mutations,e.mutations,((e,t)=>rA(e,t)))&&lC(this.baseMutations,e.baseMutations,((e,t)=>rA(e,t)))}}class rP{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){sC(e.mutations.length===n.length);let r=CA();const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new rP(e,t,n,r)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class iP{constructor(e,t,n,r,i=fC.min(),s=fC.min(),o=TC.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new iP(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new iP(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new iP(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class sP{constructor(e){this.Lt=e}}function oP(e,t){if(t.document)return rN(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){const e=DC.fromSegments(t.noDocument.path),n=hP(t.noDocument.readTime),r=YC.newNoDocument(e,n);return t.hasCommittedMutations?r.setHasCommittedMutations():r}if(t.unknownDocument){const e=DC.fromSegments(t.unknownDocument.path),n=hP(t.unknownDocument.version);return YC.newUnknownDocument(e,n)}return iC()}function aP(e,t,n){const r=cP(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){const n=function(e,t){return{name:YA(e,t.key),fields:t.data.value.mapValue.fields,updateTime:WA(e,t.version.toTimestamp())}}(e.Lt,t),s=t.hasCommittedMutations;return new PN(null,null,n,s,r,i)}if(t.isNoDocument()){const e=t.key.path.toArray(),n=lP(t.version),s=t.hasCommittedMutations;return new PN(null,new AN(e,n),null,s,r,i)}if(t.isUnknownDocument()){const e=t.key.path.toArray(),n=lP(t.version);return new PN(new NN(e,n),null,null,!0,r,i)}return iC()}function cP(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function uP(e){const t=new dC(e[0],e[1]);return fC.fromTimestamp(t)}function lP(e){const t=e.toTimestamp();return new EN(t.seconds,t.nanoseconds)}function hP(e){const t=new dC(e.seconds,e.nanoseconds);return fC.fromTimestamp(t)}function dP(e,t){const n=(t.baseMutations||[]).map((t=>sN(e.Lt,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>sN(e.Lt,t))),i=dC.fromMillis(t.localWriteTimeMs);return new nP(t.batchId,i,n,r)}function fP(e){const t=hP(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?hP(e.lastLimboFreeSnapshotVersion):fC.min();let r;var i;return void 0!==e.query.documents?(sC(1===(i=e.query).documents.length),r=kR(vR(ZA(i.documents[0])))):r=function(e){return kR(cN(e))}(e.query),new iP(r,e.targetId,0,e.lastListenSequenceNumber,t,n,TC.fromBase64String(e.resumeToken))}function pP(e,t){const n=lP(t.snapshotVersion),r=lP(t.lastLimboFreeSnapshotVersion);let i;i=tR(t.target)?oN(e.Lt,t.target):aN(e.Lt,t.target);const s=t.resumeToken.toBase64();return new DN(t.targetId,ZC(t.target),n,s,t.sequenceNumber,r,i)}function gP(e){const t=cN({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?CR(t,t.limit,"L"):t}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class mP{getBundleMetadata(e,t){return yP(e).get(t).next((e=>{if(e)return{id:(t=e).bundleId,createTime:hP(t.createTime),version:t.version};var t}))}saveBundleMetadata(e,t){return yP(e).put({bundleId:(n=t).id,createTime:lP(HA(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return _P(e).get(t).next((e=>{if(e)return{name:(t=e).name,query:gP(t.bundledQuery),readTime:hP(t.readTime)};var t}))}saveNamedQuery(e,t){return _P(e).put(function(e){return{name:e.name,readTime:lP(HA(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function yP(e){return tP(e,UN.store)}function _P(e){return tP(e,qN.store)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vP{constructor(){this.Bt=new wP}addToCollectionParentIndex(e,t){return this.Bt.add(t),WN.resolve()}getCollectionParents(e,t){return WN.resolve(this.Bt.getEntries(t))}}class wP{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new wA(_C.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new wA(_C.comparator)).toArray()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bP{constructor(){this.Ut=new wP}addToCollectionParentIndex(e,t){if(!this.Ut.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.Ut.add(t)}));const i={collectionId:n,parent:wN(r)};return TP(e).put(i)}return WN.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[hC(t),""],!1,!0);return TP(e).Nt(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(IN(r.parent))}return n}))}}function TP(e){return tP(e,LN.store)}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const IP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class EP{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new EP(e,EP.DEFAULT_COLLECTION_PERCENTILE,EP.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function SP(e,t,n){const r=e.store(CN.store),i=e.store(RN.store),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Ot({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{sC(1===a)})));const u=[];for(const e of n.mutations){const r=RN.key(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return WN.waitFor(s).next((()=>u))}function kP(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw iC();t=e.noDocument}return JSON.stringify(t).length}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */EP.DEFAULT_COLLECTION_PERCENTILE=10,EP.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,EP.DEFAULT=new EP(41943040,EP.DEFAULT_COLLECTION_PERCENTILE,EP.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),EP.DISABLED=new EP(-1,0,0);class CP{constructor(e,t,n,r){this.userId=e,this.R=t,this.qt=n,this.referenceDelegate=r,this.Kt={}}static jt(e,t,n,r){sC(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new CP(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return AP(e).Ot({index:CN.userMutationsIndex,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=NP(e),s=AP(e);return s.add({}).next((o=>{sC("number"==typeof o);const a=new nP(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>iN(e.Lt,t))),i=n.mutations.map((t=>iN(e.Lt,t)));return new CN(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(this.R,this.userId,a),u=[];let l=new wA(((e,t)=>uC(e.canonicalString(),t.canonicalString())));for(const e of r){const t=RN.key(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,RN.PLACEHOLDER))}return l.forEach((t=>{u.push(this.qt.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Kt[o]=a.keys()})),WN.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return AP(e).get(t).next((e=>e?(sC(e.userId===this.userId),dP(this.R,e)):null))}Qt(e,t){return this.Kt[t]?WN.resolve(this.Kt[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Kt[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return AP(e).Ot({index:CN.userMutationsIndex,range:r},((e,t,r)=>{t.userId===this.userId&&(sC(t.batchId>=n),i=dP(this.R,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return AP(e).Ot({index:CN.userMutationsIndex,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return AP(e).Nt(CN.userMutationsIndex,t).next((e=>e.map((e=>dP(this.R,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=RN.prefixForPath(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return NP(e).Ot({range:r},((n,r,s)=>{const[o,a,c]=n,u=IN(a);if(o===this.userId&&t.path.isEqual(u))return AP(e).get(c).next((e=>{if(!e)throw iC();sC(e.userId===this.userId),i.push(dP(this.R,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new wA(uC);const r=[];return t.forEach((t=>{const i=RN.prefixForPath(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=NP(e).Ot({range:s},((e,r,i)=>{const[s,o,a]=e,c=IN(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),WN.waitFor(r).next((()=>this.Wt(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=RN.prefixForPath(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new wA(uC);return NP(e).Ot({range:s},((e,t,i)=>{const[s,a,c]=e,u=IN(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.Wt(e,o)))}Wt(e,t){const n=[],r=[];return t.forEach((t=>{r.push(AP(e).get(t).next((e=>{if(null===e)throw iC();sC(e.userId===this.userId),n.push(dP(this.R,e))})))})),WN.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return SP(e.Mt,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Gt(t.batchId)})),WN.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Gt(e){delete this.Kt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return WN.resolve();const n=IDBKeyRange.lowerBound(RN.prefixForUser(this.userId)),r=[];return NP(e).Ot({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=IN(e[1]);r.push(t)}else n.done()})).next((()=>{sC(0===r.length)}))}))}containsKey(e,t){return RP(e,this.userId,t)}zt(e){return PP(e).get(this.userId).next((e=>e||new kN(this.userId,-1,"")))}}function RP(e,t,n){const r=RN.prefixForPath(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return NP(e).Ot({range:s,$t:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function AP(e){return tP(e,CN.store)}function NP(e){return tP(e,RN.store)}function PP(e){return tP(e,kN.store)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xP{constructor(e){this.Ht=e}next(){return this.Ht+=2,this.Ht}static Jt(){return new xP(0)}static Yt(){return new xP(-1)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class DP{constructor(e,t){this.referenceDelegate=e,this.R=t}allocateTargetId(e){return this.Xt(e).next((t=>{const n=new xP(t.highestTargetId);return t.highestTargetId=n.next(),this.Zt(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Xt(e).next((e=>fC.fromTimestamp(new dC(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Xt(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Xt(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Zt(e,r))))}addTargetData(e,t){return this.te(e,t).next((()=>this.Xt(e).next((n=>(n.targetCount+=1,this.ee(t,n),this.Zt(e,n))))))}updateTargetData(e,t){return this.te(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>OP(e).delete(t.targetId))).next((()=>this.Xt(e))).next((t=>(sC(t.targetCount>0),t.targetCount-=1,this.Zt(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return OP(e).Ot(((s,o)=>{const a=fP(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>WN.waitFor(i))).next((()=>r))}forEachTarget(e,t){return OP(e).Ot(((e,n)=>{const r=fP(n);t(r)}))}Xt(e){return MP(e).get(MN.key).next((e=>(sC(null!==e),e)))}Zt(e,t){return MP(e).put(MN.key,t)}te(e,t){return OP(e).put(pP(this.R,t))}ee(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Xt(e).next((e=>e.targetCount))}getTargetData(e,t){const n=ZC(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return OP(e).Ot({range:r,index:DN.queryTargetsIndexName},((e,n,r)=>{const s=fP(n);eR(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=LP(e);return t.forEach((t=>{const s=wN(t.path);r.push(i.put(new ON(n,s))),r.push(this.referenceDelegate.addReference(e,n,t))})),WN.waitFor(r)}removeMatchingKeys(e,t,n){const r=LP(e);return WN.forEach(t,(t=>{const i=wN(t.path);return WN.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=LP(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=LP(e);let i=AA();return r.Ot({range:n,$t:!0},((e,t,n)=>{const r=IN(e[1]),s=new DC(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=wN(t.path),r=IDBKeyRange.bound([n],[hC(n)],!1,!0);let i=0;return LP(e).Ot({index:ON.documentTargetsIndex,$t:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}lt(e,t){return OP(e).get(t).next((e=>e?fP(e):null))}}function OP(e){return tP(e,DN.store)}function MP(e){return tP(e,MN.store)}function LP(e){return tP(e,ON.store)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function FP(e){if(e.code!==Yk.FAILED_PRECONDITION||e.message!==VN)throw e;eC("LocalStore","Unexpectedly lost primary lease")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function UP([e,t],[n,r]){const i=uC(e,n);return 0===i?uC(t,r):i}class qP{constructor(e){this.ne=e,this.buffer=new wA(UP),this.se=0}ie(){return++this.se}re(e){const t=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();UP(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class jP{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.oe=!1,this.ce=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(e)}stop(){this.ce&&(this.ce.cancel(),this.ce=null)}get started(){return null!==this.ce}ue(e){const t=this.oe?3e5:6e4;eC("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.ce=null,this.oe=!0;try{await e.collectGarbage(this.garbageCollector)}catch(e){QN(e)?eC("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await FP(e)}await this.ue(e)}))}}class VP{constructor(e,t){this.ae=e,this.params=t}calculateTargetCount(e,t){return this.ae.he(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return WN.resolve(Qk.o);const n=new qP(t);return this.ae.forEachTarget(e,(e=>n.re(e.sequenceNumber))).next((()=>this.ae.le(e,(e=>n.re(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.ae.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.ae.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(eC("LruGarbageCollector","Garbage collection skipped; disabled"),WN.resolve(IP)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(eC("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),IP):this.fe(e,t)))}getCacheSize(e){return this.ae.getCacheSize(e)}fe(e,t){let n,r,i,s,o,a,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(eC("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),Zk()<=ka.DEBUG&&eC("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(c-a)+"ms\n"+`Total Duration: ${c-u}ms`),WN.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BP{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new VP(e,t)}(this,t)}he(e){const t=this.de(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}de(e){let t=0;return this.le(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}le(e,t){return this.we(e,((e,n)=>t(n)))}addReference(e,t,n){return $P(e,n)}removeReference(e,t,n){return $P(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return $P(e,t)}_e(e,t){return function(e,t){let n=!1;return PP(e).Ft((r=>RP(e,r,t).next((e=>(e&&(n=!0),WN.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.we(e,((s,o)=>{if(o<=t){const t=this._e(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s),LP(e).delete([0,wN(s.path)]))))}));r.push(t)}})).next((()=>WN.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return $P(e,t)}we(e,t){const n=LP(e);let r,i=Qk.o;return n.Ot({index:ON.documentTargetsIndex},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==Qk.o&&t(new DC(IN(r)),i),i=o,r=s):i=Qk.o})).next((()=>{i!==Qk.o&&t(new DC(IN(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $P(e,t){return LP(e).put(function(e,t){return new ON(0,wN(e.path),t)}(t,e.currentSequenceNumber))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class WP{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}forEach(e){gC(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return mC(this.inner)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class KP{constructor(){this.changes=new WP((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:fC.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:YC.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?WN.resolve(n.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zP{constructor(e,t){this.R=e,this.qt=t}addEntry(e,t,n){return QP(e).put(YP(t),n)}removeEntry(e,t){const n=QP(e),r=YP(t);return n.delete(r)}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.me(e,n))))}getEntry(e,t){return QP(e).get(YP(t)).next((e=>this.ge(t,e)))}ye(e,t){return QP(e).get(YP(t)).next((e=>({document:this.ge(t,e),size:kP(e)})))}getEntries(e,t){let n=IA();return this.pe(e,t,((e,t)=>{const r=this.ge(e,t);n=n.insert(e,r)})).next((()=>n))}Ee(e,t){let n=IA(),r=new yA(DC.comparator);return this.pe(e,t,((e,t)=>{const i=this.ge(e,t);n=n.insert(e,i),r=r.insert(e,kP(t))})).next((()=>({documents:n,Te:r})))}pe(e,t,n){if(t.isEmpty())return WN.resolve();const r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator();let s=i.getNext();return QP(e).Ot({range:r},((e,t,r)=>{const o=DC.fromSegments(e);for(;s&&DC.comparator(s,o)<0;)n(s,null),s=i.getNext();s&&s.isEqual(o)&&(n(s,t),s=i.hasNext()?i.getNext():null),s?r.Ct(s.path.toArray()):r.done()})).next((()=>{for(;s;)n(s,null),s=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n){let r=IA();const i=t.path.length+1,s={};if(n.isEqual(fC.min())){const e=t.path.toArray();s.range=IDBKeyRange.lowerBound(e)}else{const e=t.path.toArray(),r=cP(n);s.range=IDBKeyRange.lowerBound([e,r],!0),s.index=PN.collectionReadTimeIndex}return QP(e).Ot(s,((e,n,s)=>{if(e.length!==i)return;const o=oP(this.R,n);t.path.isPrefixOf(o.key.path)?PR(t,o)&&(r=r.insert(o.key,o)):s.done()})).next((()=>r))}newChangeBuffer(e){return new HP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return GP(e).get(xN.key).next((e=>(sC(!!e),e)))}me(e,t){return GP(e).put(xN.key,t)}ge(e,t){if(t){const e=oP(this.R,t);if(!e.isNoDocument()||!e.version.isEqual(fC.min()))return e}return YC.newInvalidDocument(e)}}class HP extends KP{constructor(e,t){super(),this.Ie=e,this.trackRemovals=t,this.Ae=new WP((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new wA(((e,t)=>uC(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.Ae.get(i);if(s.document.isValidDocument()){const a=aP(this.Ie.R,s.document,this.getReadTime(i));r=r.add(i.path.popLast());const c=kP(a);n+=c-o,t.push(this.Ie.addEntry(e,i,a))}else if(n-=o,this.trackRemovals){const n=aP(this.Ie.R,YC.newNoDocument(i,fC.min()),this.getReadTime(i));t.push(this.Ie.addEntry(e,i,n))}else t.push(this.Ie.removeEntry(e,i))})),r.forEach((n=>{t.push(this.Ie.qt.addToCollectionParentIndex(e,n))})),t.push(this.Ie.updateMetadata(e,n)),WN.waitFor(t)}getFromCache(e,t){return this.Ie.ye(e,t).next((e=>(this.Ae.set(t,e.size),e.document)))}getAllFromCache(e,t){return this.Ie.Ee(e,t).next((({documents:e,Te:t})=>(t.forEach(((e,t)=>{this.Ae.set(e,t)})),e)))}}function GP(e){return tP(e,xN.store)}function QP(e){return tP(e,PN.store)}function YP(e){return e.path.toArray()}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class JP{constructor(e){this.R=e}Rt(e,t,n,r){sC(n<r&&n>=0&&r<=11);const i=new KN("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(SN.store)}(e),function(e){e.createObjectStore(kN.store,{keyPath:kN.keyPath}),e.createObjectStore(CN.store,{keyPath:CN.keyPath,autoIncrement:!0}).createIndex(CN.userMutationsIndex,CN.userMutationsKeyPath,{unique:!0}),e.createObjectStore(RN.store)}(e),XP(e),function(e){e.createObjectStore(PN.store)}(e));let s=WN.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(ON.store),e.deleteObjectStore(DN.store),e.deleteObjectStore(MN.store)}(e),XP(e)),s=s.next((()=>function(e){const t=e.store(MN.store),n=new MN(0,0,fC.min().toTimestamp(),0);return t.put(MN.key,n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store(CN.store).Nt().next((n=>{e.deleteObjectStore(CN.store),e.createObjectStore(CN.store,{keyPath:CN.keyPath,autoIncrement:!0}).createIndex(CN.userMutationsIndex,CN.userMutationsKeyPath,{unique:!0});const r=t.store(CN.store),i=n.map((e=>r.put(e)));return WN.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore(FN.store,{keyPath:FN.keyPath})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Re(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore(xN.store)}(e),this.Pe(i))))),n<7&&r>=7&&(s=s.next((()=>this.be(i)))),n<8&&r>=8&&(s=s.next((()=>this.ve(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){const t=e.objectStore(PN.store);t.createIndex(PN.readTimeIndex,PN.readTimeIndexPath,{unique:!1}),t.createIndex(PN.collectionReadTimeIndex,PN.collectionReadTimeIndexPath,{unique:!1})}(t)}))),n<10&&r>=10&&(s=s.next((()=>this.Ve(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore(UN.store,{keyPath:UN.keyPath})}(e),function(e){e.createObjectStore(qN.store,{keyPath:qN.keyPath})}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}))),s}Pe(e){let t=0;return e.store(PN.store).Ot(((e,n)=>{t+=kP(n)})).next((()=>{const n=new xN(t);return e.store(xN.store).put(xN.key,n)}))}Re(e){const t=e.store(kN.store),n=e.store(CN.store);return t.Nt().next((t=>WN.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.Nt(CN.userMutationsIndex,r).next((n=>WN.forEach(n,(n=>{sC(n.userId===t.userId);const r=dP(this.R,n);return SP(e,t.userId,r).next((()=>{}))}))))}))))}be(e){const t=e.store(ON.store),n=e.store(PN.store);return e.store(MN.store).get(MN.key).next((e=>{const r=[];return n.Ot(((n,i)=>{const s=new _C(n),o=function(e){return[0,wN(e)]}(s);r.push(t.get(o).next((n=>n?WN.resolve():(n=>t.put(new ON(0,wN(n),e.highestListenSequenceNumber)))(s))))})).next((()=>WN.waitFor(r)))}))}ve(e,t){e.createObjectStore(LN.store,{keyPath:LN.keyPath});const n=t.store(LN.store),r=new wP,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:wN(r)})}};return t.store(PN.store).Ot({$t:!0},((e,t)=>{const n=new _C(e);return i(n.popLast())})).next((()=>t.store(RN.store).Ot({$t:!0},(([e,t,n],r)=>{const s=IN(t);return i(s.popLast())}))))}Ve(e){const t=e.store(DN.store);return t.Ot(((e,n)=>{const r=fP(n),i=pP(this.R,r);return t.put(i)}))}}function XP(e){e.createObjectStore(ON.store,{keyPath:ON.keyPath}).createIndex(ON.documentTargetsIndex,ON.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(DN.store,{keyPath:DN.keyPath}).createIndex(DN.queryTargetsIndexName,DN.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(MN.store)}const ZP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ex{constructor(e,t,n,r,i,s,o,a,c,u){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Se=i,this.window=s,this.document=o,this.De=c,this.Ce=u,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.$e=null,this.Oe=null,this.Fe=Number.NEGATIVE_INFINITY,this.Me=e=>Promise.resolve(),!ex.gt())throw new Jk(Yk.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new BP(this,r),this.Le=t+"main",this.R=new sP(a),this.Be=new zN(this.Le,11,new JP(this.R)),this.Ue=new DP(this.referenceDelegate,this.R),this.qt=new bP,this.qe=function(e,t){return new zP(e,t)}(this.R,this.qt),this.Ke=new mP,this.window&&this.window.localStorage?this.je=this.window.localStorage:(this.je=null,!1===u&&tC("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Qe().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Jk(Yk.FAILED_PRECONDITION,ZP);return this.We(),this.Ge(),this.ze(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ue.getHighestSequenceNumber(e)))})).then((e=>{this.Ne=new Qk(e,this.De)})).then((()=>{this.xe=!0})).catch((e=>(this.Be&&this.Be.close(),Promise.reject(e))))}He(e){return this.Me=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Be.bt((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget((async()=>{this.started&&await this.Qe()})))}Qe(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>nx(e).put(new FN(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next((()=>{if(this.isPrimary)return this.Je(e).next((e=>{e||(this.isPrimary=!1,this.Se.enqueueRetryable((()=>this.Me(!1))))}))})).next((()=>this.Ye(e))).next((t=>this.isPrimary&&!t?this.Xe(e).next((()=>!1)):!!t&&this.Ze(e).next((()=>!0)))))).catch((e=>{if(QN(e))return eC("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return eC("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Se.enqueueRetryable((()=>this.Me(e))),this.isPrimary=e}))}Je(e){return tx(e).get(SN.key).next((e=>WN.resolve(this.tn(e))))}en(e){return nx(e).delete(this.clientId)}async nn(){if(this.isPrimary&&!this.sn(this.Fe,18e5)){this.Fe=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=tP(e,FN.store);return t.Nt().next((e=>{const n=this.rn(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return WN.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.je)for(const t of e)this.je.removeItem(this.on(t.clientId))}}ze(){this.Oe=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Qe().then((()=>this.nn())).then((()=>this.ze()))))}tn(e){return!!e&&e.ownerId===this.clientId}Ye(e){return this.Ce?WN.resolve(!0):tx(e).get(SN.key).next((t=>{if(null!==t&&this.sn(t.leaseTimestampMs,5e3)&&!this.cn(t.ownerId)){if(this.tn(t)&&this.networkEnabled)return!0;if(!this.tn(t)){if(!t.allowTabSynchronization)throw new Jk(Yk.FAILED_PRECONDITION,ZP);return!1}}return!(!this.networkEnabled||!this.inForeground)||nx(e).Nt().next((e=>void 0===this.rn(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&eC("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.xe=!1,this.un(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.an(),this.hn(),await this.Be.runTransaction("shutdown","readwrite",[SN.store,FN.store],(e=>{const t=new eP(e,Qk.o);return this.Xe(t).next((()=>this.en(t)))})),this.Be.close(),this.ln()}rn(e,t){return e.filter((e=>this.sn(e.updateTimeMs,t)&&!this.cn(e.clientId)))}fn(){return this.runTransaction("getActiveClients","readonly",(e=>nx(e).Nt().next((e=>this.rn(e,18e5).map((e=>e.clientId))))))}get started(){return this.xe}getMutationQueue(e){return CP.jt(e,this.R,this.qt,this.referenceDelegate)}getTargetCache(){return this.Ue}getRemoteDocumentCache(){return this.qe}getIndexManager(){return this.qt}getBundleCache(){return this.Ke}runTransaction(e,t,n){eC("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite";let i;return this.Be.runTransaction(e,r,jN,(r=>(i=new eP(r,this.Ne?this.Ne.next():Qk.o),"readwrite-primary"===t?this.Je(i).next((e=>!!e||this.Ye(i))).next((t=>{if(!t)throw tC(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Se.enqueueRetryable((()=>this.Me(!1))),new Jk(Yk.FAILED_PRECONDITION,VN);return n(i)})).next((e=>this.Ze(i).next((()=>e)))):this.dn(i).next((()=>n(i)))))).then((e=>(i.raiseOnCommittedEvent(),e)))}dn(e){return tx(e).get(SN.key).next((e=>{if(null!==e&&this.sn(e.leaseTimestampMs,5e3)&&!this.cn(e.ownerId)&&!this.tn(e)&&!(this.Ce||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Jk(Yk.FAILED_PRECONDITION,ZP)}))}Ze(e){const t=new SN(this.clientId,this.allowTabSynchronization,Date.now());return tx(e).put(SN.key,t)}static gt(){return zN.gt()}Xe(e){const t=tx(e);return t.get(SN.key).next((e=>this.tn(e)?(eC("IndexedDbPersistence","Releasing primary lease."),t.delete(SN.key)):WN.resolve()))}sn(e,t){const n=Date.now();return!(e<n-t||e>n&&(tC(`Detected an update time that is in the future: ${e} > ${n}`),1))}We(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.$e=()=>{this.Se.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Qe())))},this.document.addEventListener("visibilitychange",this.$e),this.inForeground="visible"===this.document.visibilityState)}an(){this.$e&&(this.document.removeEventListener("visibilitychange",this.$e),this.$e=null)}Ge(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ke=()=>{this.un(),!jo()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&this.Se.enterRestrictedMode(!0),this.Se.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ke))}hn(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)}cn(e){var t;try{const n=null!==(null===(t=this.je)||void 0===t?void 0:t.getItem(this.on(e)));return eC("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return tC("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}un(){if(this.je)try{this.je.setItem(this.on(this.clientId),String(Date.now()))}catch(e){tC("Failed to set zombie client id.",e)}}ln(){if(this.je)try{this.je.removeItem(this.on(this.clientId))}catch(e){}}on(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function tx(e){return tP(e,SN.store)}function nx(e){return tP(e,FN.store)}function rx(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class ix{constructor(e,t){this.progress=e,this.wn=t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class sx{constructor(e,t,n){this.qe=e,this._n=t,this.qt=n}mn(e,t){return this._n.getAllMutationBatchesAffectingDocumentKey(e,t).next((n=>this.gn(e,t,n)))}gn(e,t,n){return this.qe.getEntry(e,t).next((e=>{for(const t of n)t.applyToLocalView(e);return e}))}yn(e,t){e.forEach(((e,n)=>{for(const e of t)e.applyToLocalView(n)}))}pn(e,t){return this.qe.getEntries(e,t).next((t=>this.En(e,t).next((()=>t))))}En(e,t){return this._n.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>this.yn(t,e)))}getDocumentsMatchingQuery(e,t,n){return function(e){return DC.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Tn(e,t.path):ER(t)?this.In(e,t,n):this.An(e,t,n)}Tn(e,t){return this.mn(e,new DC(t)).next((e=>{let t=SA();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}In(e,t,n){const r=t.collectionGroup;let i=SA();return this.qt.getCollectionParents(e,r).next((s=>WN.forEach(s,(s=>{const o=function(e,t){return new yR(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.An(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}An(e,t,n){let r,i;return this.qe.getDocumentsMatchingQuery(e,t,n).next((n=>(r=n,this._n.getAllMutationBatchesAffectingQuery(e,t)))).next((t=>(i=t,this.Rn(e,i,r).next((e=>{r=e;for(const e of i)for(const t of e.mutations){const n=t.key;let i=r.get(n);null==i&&(i=YC.newInvalidDocument(n),r=r.insert(n,i)),tA(t,i,e.localWriteTime),i.isFoundDocument()||(r=r.remove(n))}}))))).next((()=>(r.forEach(((e,n)=>{PR(t,n)||(r=r.remove(e))})),r)))}Rn(e,t,n){let r=AA();for(const e of t)for(const t of e.mutations)t instanceof oA&&null===n.get(t.key)&&(r=r.add(t.key));let i=n;return this.qe.getEntries(e,r).next((e=>(e.forEach(((e,t)=>{t.isFoundDocument()&&(i=i.insert(e,t))})),i)))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ox{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pn=n,this.bn=r}static vn(e,t){let n=AA(),r=AA();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new ox(e,t.fromCache,n,r)}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ax{Vn(e){this.Sn=e}getDocumentsMatchingQuery(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(fC.min())?this.Dn(e,t):this.Sn.pn(e,r).next((i=>{const s=this.Cn(t,i);return(wR(t)||bR(t))&&this.Nn(t.limitType,s,r,n)?this.Dn(e,t):(Zk()<=ka.DEBUG&&eC("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),NR(t)),this.Sn.getDocumentsMatchingQuery(e,t,n).next((e=>(s.forEach((t=>{e=e.insert(t.key,t)})),e))))}))}Cn(e,t){let n=new wA(xR(e));return t.forEach(((t,r)=>{PR(e,r)&&(n=n.add(r))})),n}Nn(e,t,n,r){if(n.size!==t.size)return!0;const i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Dn(e,t){return Zk()<=ka.DEBUG&&eC("QueryEngine","Using full collection scan to execute query:",NR(t)),this.Sn.getDocumentsMatchingQuery(e,t,fC.min())}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cx{constructor(e,t,n,r){this.persistence=e,this.xn=t,this.R=r,this.kn=new yA(uC),this.$n=new WP((e=>ZC(e)),eR),this.On=fC.min(),this._n=e.getMutationQueue(n),this.Fn=e.getRemoteDocumentCache(),this.Ue=e.getTargetCache(),this.Mn=new sx(this.Fn,this._n,this.persistence.getIndexManager()),this.Ke=e.getBundleCache(),this.xn.Vn(this.Mn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.kn)))}}function ux(e,t,n,r){return new cx(e,t,n,r)}async function lx(e,t){const n=oC(e);let r=n._n,i=n.Mn;const s=await n.persistence.runTransaction("Handle user change","readonly",(e=>{let s;return n._n.getAllMutationBatches(e).next((o=>(s=o,r=n.persistence.getMutationQueue(t),i=new sx(n.Fn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)))).next((t=>{const n=[],r=[];let o=AA();for(const e of s){n.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return i.pn(e,o).next((e=>({Ln:e,removedBatchIds:n,addedBatchIds:r})))}))}));return n._n=r,n.Mn=i,n.xn.Vn(n.Mn),s}function hx(e){const t=oC(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ue.getLastRemoteSnapshotVersion(e)))}function dx(e,t,n,r,i){let s=AA();return n.forEach((e=>s=s.add(e))),t.getEntries(e,s).next((e=>{let s=IA();return n.forEach(((n,o)=>{const a=e.get(n),c=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(fC.min())?(t.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o,c),s=s.insert(n,o)):eC("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}function fx(e,t){const n=oC(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n._n.getNextMutationBatchAfterBatchId(e,t))))}function px(e,t){const n=oC(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ue.getTargetData(e,t).next((i=>i?(r=i,WN.resolve(r)):n.Ue.allocateTargetId(e).next((i=>(r=new iP(t,i,0,e.currentSequenceNumber),n.Ue.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.kn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(e.targetId,e),n.$n.set(t,e.targetId)),e}))}async function gx(e,t,n){const r=oC(e),i=r.kn.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!QN(e))throw e;eC("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.kn=r.kn.remove(t),r.$n.delete(i.target)}function mx(e,t,n){const r=oC(e);let i=fC.min(),s=AA();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=oC(e),i=r.$n.get(n);return void 0!==i?WN.resolve(r.kn.get(i)):r.Ue.getTargetData(t,n)}(r,e,kR(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ue.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.xn.getDocumentsMatchingQuery(e,t,n?i:fC.min(),n?s:AA()))).next((e=>({documents:e,Bn:s})))))}function yx(e,t){const n=oC(e),r=oC(n.Ue),i=n.kn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.lt(e,t).next((e=>e?e.target:null))))}function _x(e){const t=oC(e);return t.persistence.runTransaction("Get new document changes","readonly",(e=>function(e,t,n){const r=oC(e);let i=IA(),s=cP(n);const o=QP(t),a=IDBKeyRange.lowerBound(s,!0);return o.Ot({index:PN.readTimeIndex,range:a},((e,t)=>{const n=oP(r.R,t);i=i.insert(n.key,n),s=t.readTime})).next((()=>({wn:i,readTime:uP(s)})))}(t.Fn,e,t.On))).then((({wn:e,readTime:n})=>(t.On=n,e)))}async function vx(e,t,n=AA()){const r=await px(e,kR(gP(t.bundledQuery))),i=oC(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=HA(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Ke.saveNamedQuery(e,t);const o=r.withResumeToken(TC.EMPTY_BYTE_STRING,s);return i.kn=i.kn.insert(o.targetId,o),i.Ue.updateTargetData(e,o).next((()=>i.Ue.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Ue.addMatchingKeys(e,n,r.targetId))).next((()=>i.Ke.saveNamedQuery(e,t)))}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wx{constructor(e){this.R=e,this.jn=new Map,this.Qn=new Map}getBundleMetadata(e,t){return WN.resolve(this.jn.get(t))}saveBundleMetadata(e,t){var n;return this.jn.set(t.id,{id:(n=t).id,version:n.version,createTime:HA(n.createTime)}),WN.resolve()}getNamedQuery(e,t){return WN.resolve(this.Qn.get(t))}saveNamedQuery(e,t){return this.Qn.set(t.name,function(e){return{name:e.name,query:gP(e.bundledQuery),readTime:HA(e.readTime)}}(t)),WN.resolve()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bx{constructor(){this.Wn=new wA(Tx.Gn),this.zn=new wA(Tx.Hn)}isEmpty(){return this.Wn.isEmpty()}addReference(e,t){const n=new Tx(e,t);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)}Jn(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Yn(new Tx(e,t))}Xn(e,t){e.forEach((e=>this.removeReference(e,t)))}Zn(e){const t=new DC(new _C([])),n=new Tx(t,e),r=new Tx(t,e+1),i=[];return this.zn.forEachInRange([n,r],(e=>{this.Yn(e),i.push(e.key)})),i}ts(){this.Wn.forEach((e=>this.Yn(e)))}Yn(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)}es(e){const t=new DC(new _C([])),n=new Tx(t,e),r=new Tx(t,e+1);let i=AA();return this.zn.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Tx(e,0),n=this.Wn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Tx{constructor(e,t){this.key=e,this.ns=t}static Gn(e,t){return DC.comparator(e.key,t.key)||uC(e.ns,t.ns)}static Hn(e,t){return uC(e.ns,t.ns)||DC.comparator(e.key,t.key)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ix{constructor(e,t){this.qt=e,this.referenceDelegate=t,this._n=[],this.ss=1,this.rs=new wA(Tx.Gn)}checkEmpty(e){return WN.resolve(0===this._n.length)}addMutationBatch(e,t,n,r){const i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];const s=new nP(i,t,n,r);this._n.push(s);for(const t of r)this.rs=this.rs.add(new Tx(t.key,i)),this.qt.addToCollectionParentIndex(e,t.key.path.popLast());return WN.resolve(s)}lookupMutationBatch(e,t){return WN.resolve(this.os(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.cs(n),i=r<0?0:r;return WN.resolve(this._n.length>i?this._n[i]:null)}getHighestUnacknowledgedBatchId(){return WN.resolve(0===this._n.length?-1:this.ss-1)}getAllMutationBatches(e){return WN.resolve(this._n.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Tx(t,0),r=new Tx(t,Number.POSITIVE_INFINITY),i=[];return this.rs.forEachInRange([n,r],(e=>{const t=this.os(e.ns);i.push(t)})),WN.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new wA(uC);return t.forEach((e=>{const t=new Tx(e,0),r=new Tx(e,Number.POSITIVE_INFINITY);this.rs.forEachInRange([t,r],(e=>{n=n.add(e.ns)}))})),WN.resolve(this.us(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;DC.isDocumentKey(i)||(i=i.child(""));const s=new Tx(new DC(i),0);let o=new wA(uC);return this.rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ns)),!0)}),s),WN.resolve(this.us(o))}us(e){const t=[];return e.forEach((e=>{const n=this.os(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){sC(0===this.hs(t.batchId,"removed")),this._n.shift();let n=this.rs;return WN.forEach(t.mutations,(r=>{const i=new Tx(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.rs=n}))}Gt(e){}containsKey(e,t){const n=new Tx(t,0),r=this.rs.firstAfterOrEqual(n);return WN.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this._n.length,WN.resolve()}hs(e,t){return this.cs(e)}cs(e){return 0===this._n.length?0:e-this._n[0].batchId}os(e){const t=this.cs(e);return t<0||t>=this._n.length?null:this._n[t]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ex{constructor(e,t){this.qt=e,this.ls=t,this.docs=new yA(DC.comparator),this.size=0}addEntry(e,t,n){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ls(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:o,readTime:n}),this.size+=o-s,this.qt.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return WN.resolve(n?n.document.clone():YC.newInvalidDocument(t))}getEntries(e,t){let n=IA();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.clone():YC.newInvalidDocument(e))})),WN.resolve(n)}getDocumentsMatchingQuery(e,t,n){let r=IA();const i=new DC(t.path.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i,readTime:o}}=s.getNext();if(!t.path.isPrefixOf(e.path))break;o.compareTo(n)<=0||PR(t,i)&&(r=r.insert(i.key,i.clone()))}return WN.resolve(r)}fs(e,t){return WN.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Sx(this)}getSize(e){return WN.resolve(this.size)}}class Sx extends KP{constructor(e){super(),this.Ie=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.document.isValidDocument()?t.push(this.Ie.addEntry(e,r.document,this.getReadTime(n))):this.Ie.removeEntry(n)})),WN.waitFor(t)}getFromCache(e,t){return this.Ie.getEntry(e,t)}getAllFromCache(e,t){return this.Ie.getEntries(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class kx{constructor(e){this.persistence=e,this.ds=new WP((e=>ZC(e)),eR),this.lastRemoteSnapshotVersion=fC.min(),this.highestTargetId=0,this.ws=0,this._s=new bx,this.targetCount=0,this.gs=xP.Jt()}forEachTarget(e,t){return this.ds.forEach(((e,n)=>t(n))),WN.resolve()}getLastRemoteSnapshotVersion(e){return WN.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return WN.resolve(this.ws)}allocateTargetId(e){return this.highestTargetId=this.gs.next(),WN.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ws&&(this.ws=t),WN.resolve()}te(e){this.ds.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.gs=new xP(t),this.highestTargetId=t),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)}addTargetData(e,t){return this.te(t),this.targetCount+=1,WN.resolve()}updateTargetData(e,t){return this.te(t),WN.resolve()}removeTargetData(e,t){return this.ds.delete(t.target),this._s.Zn(t.targetId),this.targetCount-=1,WN.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ds.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.ds.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),WN.waitFor(i).next((()=>r))}getTargetCount(e){return WN.resolve(this.targetCount)}getTargetData(e,t){const n=this.ds.get(t)||null;return WN.resolve(n)}addMatchingKeys(e,t,n){return this._s.Jn(t,n),WN.resolve()}removeMatchingKeys(e,t,n){this._s.Xn(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),WN.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._s.Zn(t),WN.resolve()}getMatchingKeysForTargetId(e,t){const n=this._s.es(t);return WN.resolve(n)}containsKey(e,t){return WN.resolve(this._s.containsKey(t))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Cx{constructor(e,t){this.ys={},this.Ne=new Qk(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.Ue=new kx(this),this.qt=new vP,this.qe=function(e,t){return new Ex(e,t)}(this.qt,(e=>this.referenceDelegate.ps(e))),this.R=new sP(t),this.Ke=new wx(this.R)}start(){return Promise.resolve()}shutdown(){return this.xe=!1,Promise.resolve()}get started(){return this.xe}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.qt}getMutationQueue(e){let t=this.ys[e.toKey()];return t||(t=new Ix(this.qt,this.referenceDelegate),this.ys[e.toKey()]=t),t}getTargetCache(){return this.Ue}getRemoteDocumentCache(){return this.qe}getBundleCache(){return this.Ke}runTransaction(e,t,n){eC("MemoryPersistence","Starting transaction:",e);const r=new Rx(this.Ne.next());return this.referenceDelegate.Es(),n(r).next((e=>this.referenceDelegate.Ts(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Is(e,t){return WN.or(Object.values(this.ys).map((n=>()=>n.containsKey(e,t))))}}class Rx extends BN{constructor(e){super(),this.currentSequenceNumber=e}}class Ax{constructor(e){this.persistence=e,this.As=new bx,this.Rs=null}static Ps(e){return new Ax(e)}get bs(){if(this.Rs)return this.Rs;throw iC()}addReference(e,t,n){return this.As.addReference(n,t),this.bs.delete(n.toString()),WN.resolve()}removeReference(e,t,n){return this.As.removeReference(n,t),this.bs.add(n.toString()),WN.resolve()}markPotentiallyOrphaned(e,t){return this.bs.add(t.toString()),WN.resolve()}removeTarget(e,t){this.As.Zn(t.targetId).forEach((e=>this.bs.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.bs.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Es(){this.Rs=new Set}Ts(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return WN.forEach(this.bs,(n=>{const r=DC.fromPath(n);return this.vs(e,r).next((e=>{e||t.removeEntry(r)}))})).next((()=>(this.Rs=null,t.apply(e))))}updateLimboDocument(e,t){return this.vs(e,t).next((e=>{e?this.bs.delete(t.toString()):this.bs.add(t.toString())}))}ps(e){return 0}vs(e,t){return WN.or([()=>WN.resolve(this.As.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Is(e,t)])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Nx{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}function Px(e,t){return`firestore_clients_${e}_${t}`}function xx(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function Dx(e,t){return`firestore_targets_${e}_${t}`}Nx.UNAUTHENTICATED=new Nx(null),Nx.GOOGLE_CREDENTIALS=new Nx("google-credentials-uid"),Nx.FIRST_PARTY=new Nx("first-party-uid");class Ox{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Vs(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new Jk(r.error.code,r.error.message))),s?new Ox(e,t,r.state,i):(tC("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Mx{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Vs(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new Jk(n.error.code,n.error.message))),i?new Mx(e,n.state,r):(tC("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Lx{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Vs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=PA();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=xC(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new Lx(e,i):(tC("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Fx{constructor(e,t){this.clientId=e,this.onlineState=t}static Vs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Fx(t.clientId,t.onlineState):(tC("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Ux{constructor(){this.activeTargetIds=PA()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}Cs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ss(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qx{constructor(e,t,n,r,i){this.window=e,this.Se=t,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.$s=new yA(uC),this.started=!1,this.Os=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Fs=Px(this.persistenceKey,this.Ns),this.Ms=function(e){return`firestore_sequence_number_${e}`}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.persistenceKey),this.$s=this.$s.insert(this.Ns,new Ux),this.Ls=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Bs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Us=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.qs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Ks=function(e){return`firestore_bundle_loaded_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}static gt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.fn();for(const t of e){if(t===this.Ns)continue;const e=this.getItem(Px(this.persistenceKey,t));if(e){const n=Lx.Vs(t,e);n&&(this.$s=this.$s.insert(n.clientId,n))}}this.js();const t=this.storage.getItem(this.qs);if(t){const e=this.Qs(t);e&&this.Ws(e)}for(const e of this.Os)this.ks(e);this.Os=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ms,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.$s)}isActiveQueryTarget(e){let t=!1;return this.$s.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,n){this.zs(e,t,n),this.Hs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(Dx(this.persistenceKey,e));if(n){const r=Mx.Vs(e,n);r&&(t=r.state)}}return this.Js.Ds(e),this.js(),t}removeLocalQueryTarget(e){this.Js.Cs(e),this.js()}isLocalQueryTarget(e){return this.Js.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Dx(this.persistenceKey,e))}updateQueryState(e,t,n){this.Ys(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Hs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Xs(e)}notifyBundleLoaded(){this.Zs()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Fs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return eC("SharedClientState","READ",e,t),t}setItem(e,t){eC("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){eC("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ks(e){const t=e;if(t.storageArea===this.storage){if(eC("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Fs)return void tC("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Ls.test(t.key)){if(null==t.newValue){const e=this.ti(t.key);return this.ei(e,null)}{const e=this.ni(t.key,t.newValue);if(e)return this.ei(e.clientId,e)}}else if(this.Bs.test(t.key)){if(null!==t.newValue){const e=this.si(t.key,t.newValue);if(e)return this.ii(e)}}else if(this.Us.test(t.key)){if(null!==t.newValue){const e=this.ri(t.key,t.newValue);if(e)return this.oi(e)}}else if(t.key===this.qs){if(null!==t.newValue){const e=this.Qs(t.newValue);if(e)return this.Ws(e)}}else if(t.key===this.Ms){const e=function(e){let t=Qk.o;if(null!=e)try{const n=JSON.parse(e);sC("number"==typeof n),t=n}catch(e){tC("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==Qk.o&&this.sequenceNumberHandler(e)}else if(t.key===this.Ks)return this.syncEngine.ci()}else this.Os.push(t)}))}}get Js(){return this.$s.get(this.Ns)}js(){this.setItem(this.Fs,this.Js.Ss())}zs(e,t,n){const r=new Ox(this.currentUser,e,t,n),i=xx(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ss())}Hs(e){const t=xx(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Xs(e){const t={clientId:this.Ns,onlineState:e};this.storage.setItem(this.qs,JSON.stringify(t))}Ys(e,t,n){const r=Dx(this.persistenceKey,e),i=new Mx(e,t,n);this.setItem(r,i.Ss())}Zs(){this.setItem(this.Ks,"value-not-used")}ti(e){const t=this.Ls.exec(e);return t?t[1]:null}ni(e,t){const n=this.ti(e);return Lx.Vs(n,t)}si(e,t){const n=this.Bs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ox.Vs(new Nx(i),r,t)}ri(e,t){const n=this.Us.exec(e),r=Number(n[1]);return Mx.Vs(r,t)}Qs(e){return Fx.Vs(e)}async ii(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.ui(e.batchId,e.state,e.error);eC("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}oi(e){return this.syncEngine.ai(e.targetId,e.state,e.error)}ei(e,t){const n=t?this.$s.insert(e,t):this.$s.remove(e),r=this.Gs(this.$s),i=this.Gs(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.hi(s,o).then((()=>{this.$s=n}))}Ws(e){this.$s.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=PA();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class jx{constructor(){this.li=new Ux,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.li.Ds(e),this.fi[e]||"not-current"}updateQueryState(e,t,n){this.fi[e]=t}removeLocalQueryTarget(e){this.li.Cs(e)}isLocalQueryTarget(e){return this.li.activeTargetIds.has(e)}clearQueryState(e){delete this.fi[e]}getAllActiveQueryTargets(){return this.li.activeTargetIds}isActiveQueryTarget(e){return this.li.activeTargetIds.has(e)}start(){return this.li=new Ux,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Vx{di(e){}shutdown(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Bx{constructor(){this.wi=()=>this._i(),this.mi=()=>this.gi(),this.yi=[],this.pi()}di(e){this.yi.push(e)}shutdown(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)}pi(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)}_i(){eC("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.yi)e(0)}gi(){eC("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.yi)e(1)}static gt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const $x={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Wx{constructor(e){this.Ei=e.Ei,this.Ti=e.Ti}Ii(e){this.Ai=e}Ri(e){this.Pi=e}onMessage(e){this.bi=e}close(){this.Ti()}send(e){this.Ei(e)}vi(){this.Ai()}Vi(e){this.Pi(e)}Si(e){this.bi(e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Kx extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.Di=t+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Ni(e,t,n,r){const i=this.xi(e,t);eC("RestConnection","Sending: ",i,n);const s={};return this.ki(s,r),this.$i(e,i,s,n).then((e=>(eC("RestConnection","Received: ",e),e)),(t=>{throw nC("RestConnection",`${e} failed with error: `,t,"url: ",i,"request:",n),t}))}Oi(e,t,n,r){return this.Ni(e,t,n,r)}ki(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+Gk,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(const n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])}xi(e,t){const n=$x[e];return`${this.Di}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}$i(e,t,n,r){return new Promise(((i,s)=>{const o=new Hk;o.listenOnce(Vk.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case jk.NO_ERROR:const t=o.getResponseJson();eC("Connection","XHR received:",JSON.stringify(t)),i(t);break;case jk.TIMEOUT:eC("Connection",'RPC "'+e+'" timed out'),s(new Jk(Yk.DEADLINE_EXCEEDED,"Request time out"));break;case jk.HTTP_ERROR:const n=o.getStatus();if(eC("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Yk).indexOf(t)>=0?t:Yk.UNKNOWN}(e.status);s(new Jk(t,e.message))}else s(new Jk(Yk.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Jk(Yk.UNAVAILABLE,"Connection failed."));break;default:iC()}}finally{eC("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(r);o.send(t,"POST",a,n,15)}))}Fi(e,t){const n=[this.Di,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new Mk,i=RE(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new Kk({})),this.ki(s.initMessageHeaders,t),qo()||Bo()||Uo().indexOf("Electron/")>=0||$o()||Uo().indexOf("MSAppHost/")>=0||Vo()||(s.httpHeadersOverwriteParam="$httpHeaders");const o=n.join("");eC("Connection","Creating WebChannel: "+o,s);const a=r.createWebChannel(o,s);let c=!1,u=!1;const l=new Wx({Ei:e=>{u?eC("Connection","Not sending because WebChannel is closed:",e):(c||(eC("Connection","Opening WebChannel transport."),a.open(),c=!0),eC("Connection","WebChannel sending:",e),a.send(e))},Ti:()=>a.close()}),h=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return h(a,zk.EventType.OPEN,(()=>{u||eC("Connection","WebChannel transport opened.")})),h(a,zk.EventType.CLOSE,(()=>{u||(u=!0,eC("Connection","WebChannel transport closed"),l.Vi())})),h(a,zk.EventType.ERROR,(e=>{u||(u=!0,nC("Connection","WebChannel transport errored:",e),l.Vi(new Jk(Yk.UNAVAILABLE,"The operation could not be completed")))})),h(a,zk.EventType.MESSAGE,(e=>{var t;if(!u){const n=e.data[0];sC(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){eC("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=fA[e];if(void 0!==t)return mA(t)}(e),n=i.message;void 0===t&&(t=Yk.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),u=!0,l.Vi(new Jk(t,n)),a.close()}else eC("Connection","WebChannel received:",n),l.Si(n)}})),h(i,Bk.STAT_EVENT,(e=>{e.stat===$k?eC("Connection","Detected buffering proxy"):e.stat===Wk&&eC("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.vi()}),0),l}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function zx(){return"undefined"!=typeof window?window:null}function Hx(){return"undefined"!=typeof document?document:null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Gx(e){return new $A(e,!0)}class Qx{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Se=e,this.timerId=t,this.Mi=n,this.Li=r,this.Bi=i,this.Ui=0,this.qi=null,this.Ki=Date.now(),this.reset()}reset(){this.Ui=0}ji(){this.Ui=this.Bi}Qi(e){this.cancel();const t=Math.floor(this.Ui+this.Wi()),n=Math.max(0,Date.now()-this.Ki),r=Math.max(0,t-n);r>0&&eC("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ui} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qi=this.Se.enqueueAfterDelay(this.timerId,r,(()=>(this.Ki=Date.now(),e()))),this.Ui*=this.Li,this.Ui<this.Mi&&(this.Ui=this.Mi),this.Ui>this.Bi&&(this.Ui=this.Bi)}Gi(){null!==this.qi&&(this.qi.skipDelay(),this.qi=null)}cancel(){null!==this.qi&&(this.qi.cancel(),this.qi=null)}Wi(){return(Math.random()-.5)*this.Ui}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Yx{constructor(e,t,n,r,i,s){this.Se=e,this.zi=n,this.Hi=r,this.Ji=i,this.listener=s,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Qx(e,t)}tr(){return 1===this.state||2===this.state||4===this.state}er(){return 2===this.state}start(){3!==this.state?this.auth():this.nr()}async stop(){this.tr()&&await this.close(0)}sr(){this.state=0,this.Zi.reset()}ir(){this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(()=>this.rr())))}cr(e){this.ur(),this.stream.send(e)}async rr(){if(this.er())return this.close(0)}ur(){this.Xi&&(this.Xi.cancel(),this.Xi=null)}async close(e,t){this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():t&&t.code===Yk.RESOURCE_EXHAUSTED?(tC(t.toString()),tC("Using maximum backoff delay to prevent overloading the backend."),this.Zi.ji()):t&&t.code===Yk.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ri(t)}ar(){}auth(){this.state=1;const e=this.hr(this.Yi),t=this.Yi;this.Ji.getToken().then((e=>{this.Yi===t&&this.lr(e)}),(t=>{e((()=>{const e=new Jk(Yk.UNKNOWN,"Fetching auth token failed: "+t.message);return this.dr(e)}))}))}lr(e){const t=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii((()=>{t((()=>(this.state=2,this.listener.Ii())))})),this.stream.Ri((e=>{t((()=>this.dr(e)))})),this.stream.onMessage((e=>{t((()=>this.onMessage(e)))}))}nr(){this.state=4,this.Zi.Qi((async()=>{this.state=0,this.start()}))}dr(e){return eC("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(3,e)}hr(e){return t=>{this.Se.enqueueAndForget((()=>this.Yi===e?t():(eC("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Jx extends Yx{constructor(e,t,n,r,i){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,n,i),this.R=r}wr(e){return this.Hi.Fi("Listen",e)}onMessage(e){this.Zi.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:iC()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.I?(sC(void 0===t||"string"==typeof t),TC.fromBase64String(t||"")):(sC(void 0===t||t instanceof Uint8Array),TC.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Yk.UNKNOWN:mA(e.code);return new Jk(t,e.message||"")}(o);n=new LA(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=JA(e,r.document.name),s=HA(r.document.updateTime),o=new GC({mapValue:{fields:r.document.fields}}),a=YC.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new OA(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=JA(e,r.document),s=r.readTime?HA(r.readTime):fC.min(),o=YC.newNoDocument(i,s),a=r.removedTargetIds||[];n=new OA([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=JA(e,r.document),s=r.removedTargetIds||[];n=new OA([],s,i,null)}else{if(!("filter"in t))return iC();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new dA(r),s=e.targetId;n=new MA(s,i)}}return n}(this.R,e),n=function(e){if(!("targetChange"in e))return fC.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?fC.min():t.readTime?HA(t.readTime):fC.min()}(e);return this.listener._r(t,n)}mr(e){const t={};t.database=eN(this.R),t.addTarget=function(e,t){let n;const r=t.target;return n=tR(r)?{documents:oN(e,r)}:{query:aN(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=KA(e,t.resumeToken):t.snapshotVersion.compareTo(fC.min())>0&&(n.readTime=WA(e,t.snapshotVersion.toTimestamp())),n}(this.R,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return iC()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,e);n&&(t.labels=n),this.cr(t)}gr(e){const t={};t.database=eN(this.R),t.removeTarget=e,this.cr(t)}}class Xx extends Yx{constructor(e,t,n,r,i){super(e,"write_stream_connection_backoff","write_stream_idle",t,n,i),this.R=r,this.yr=!1}get pr(){return this.yr}start(){this.yr=!1,this.lastStreamToken=void 0,super.start()}ar(){this.yr&&this.Er([])}wr(e){return this.Hi.Fi("Write",e)}onMessage(e){if(sC(!!e.streamToken),this.lastStreamToken=e.streamToken,this.yr){this.Zi.reset();const t=function(e,t){return e&&e.length>0?(sC(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?HA(e.updateTime):HA(t);return n.isEqual(fC.min())&&(n=HA(t)),new YR(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=HA(e.commitTime);return this.listener.Tr(n,t)}return sC(!e.writeResults||0===e.writeResults.length),this.yr=!0,this.listener.Ir()}Ar(){const e={};e.database=eN(this.R),this.cr(e)}Er(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>iN(this.R,e)))};this.cr(t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Zx extends class{}{constructor(e,t,n){super(),this.credentials=e,this.Hi=t,this.R=n,this.Rr=!1}Pr(){if(this.Rr)throw new Jk(Yk.FAILED_PRECONDITION,"The client has already been terminated.")}Ni(e,t,n){return this.Pr(),this.credentials.getToken().then((r=>this.Hi.Ni(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Yk.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new Jk(Yk.UNKNOWN,e.toString())}))}Oi(e,t,n){return this.Pr(),this.credentials.getToken().then((r=>this.Hi.Oi(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Yk.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new Jk(Yk.UNKNOWN,e.toString())}))}terminate(){this.Rr=!0}}class eD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.br=0,this.vr=null,this.Vr=!0}Sr(){0===this.br&&(this.Dr("Unknown"),this.vr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.vr=null,this.Cr("Backend didn't respond within 10 seconds."),this.Dr("Offline"),Promise.resolve()))))}Nr(e){"Online"===this.state?this.Dr("Unknown"):(this.br++,this.br>=1&&(this.kr(),this.Cr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Dr("Offline")))}set(e){this.kr(),this.br=0,"Online"===e&&(this.Vr=!1),this.Dr(e)}Dr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Cr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Vr?(tC(t),this.Vr=!1):eC("OnlineStateTracker",t)}kr(){null!==this.vr&&(this.vr.cancel(),this.vr=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class tD{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.$r=[],this.Or=new Map,this.Fr=new Set,this.Mr=[],this.Lr=i,this.Lr.di((e=>{n.enqueueAndForget((async()=>{lD(this)&&(eC("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=oC(e);t.Fr.add(4),await rD(t),t.Br.set("Unknown"),t.Fr.delete(4),await nD(t)}(this))}))})),this.Br=new eD(n,r)}}async function nD(e){if(lD(e))for(const t of e.Mr)await t(!0)}async function rD(e){for(const t of e.Mr)await t(!1)}function iD(e,t){const n=oC(e);n.Or.has(t.targetId)||(n.Or.set(t.targetId,t),uD(n)?cD(n):CD(n).er()&&oD(n,t))}function sD(e,t){const n=oC(e),r=CD(n);n.Or.delete(t),r.er()&&aD(n,t),0===n.Or.size&&(r.er()?r.ir():lD(n)&&n.Br.set("Unknown"))}function oD(e,t){e.Ur.q(t.targetId),CD(e).mr(t)}function aD(e,t){e.Ur.q(t),CD(e).gr(t)}function cD(e){e.Ur=new UA({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.Or.get(t)||null}),CD(e).start(),e.Br.Sr()}function uD(e){return lD(e)&&!CD(e).tr()&&e.Or.size>0}function lD(e){return 0===oC(e).Fr.size}function hD(e){e.Ur=void 0}async function dD(e){e.Or.forEach(((t,n)=>{oD(e,t)}))}async function fD(e,t){hD(e),uD(e)?(e.Br.Nr(t),cD(e)):e.Br.set("Unknown")}async function pD(e,t,n){if(e.Br.set("Online"),t instanceof LA&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Or.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Or.delete(r),e.Ur.removeTarget(r))}(e,t)}catch(n){eC("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await gD(e,n)}else if(t instanceof OA?e.Ur.X(t):t instanceof MA?e.Ur.rt(t):e.Ur.et(t),!n.isEqual(fC.min()))try{const t=await hx(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ur.ut(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Or.get(r);i&&e.Or.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.Or.get(t);if(!n)return;e.Or.set(t,n.withResumeToken(TC.EMPTY_BYTE_STRING,n.snapshotVersion)),aD(e,t);const r=new iP(n.target,t,1,n.sequenceNumber);oD(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){eC("RemoteStore","Failed to raise snapshot:",t),await gD(e,t)}}async function gD(e,t,n){if(!QN(t))throw t;e.Fr.add(1),await rD(e),e.Br.set("Offline"),n||(n=()=>hx(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{eC("RemoteStore","Retrying IndexedDB access"),await n(),e.Fr.delete(1),await nD(e)}))}function mD(e,t){return t().catch((n=>gD(e,n,t)))}async function yD(e){const t=oC(e),n=RD(t);let r=t.$r.length>0?t.$r[t.$r.length-1].batchId:-1;for(;_D(t);)try{const e=await fx(t.localStore,r);if(null===e){0===t.$r.length&&n.ir();break}r=e.batchId,vD(t,e)}catch(e){await gD(t,e)}wD(t)&&bD(t)}function _D(e){return lD(e)&&e.$r.length<10}function vD(e,t){e.$r.push(t);const n=RD(e);n.er()&&n.pr&&n.Er(t.mutations)}function wD(e){return lD(e)&&!RD(e).tr()&&e.$r.length>0}function bD(e){RD(e).start()}async function TD(e){RD(e).Ar()}async function ID(e){const t=RD(e);for(const n of e.$r)t.Er(n.mutations)}async function ED(e,t,n){const r=e.$r.shift(),i=rP.from(r,t,n);await mD(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await yD(e)}async function SD(e,t){t&&RD(e).pr&&await async function(e,t){if(gA(n=t.code)&&n!==Yk.ABORTED){const n=e.$r.shift();RD(e).sr(),await mD(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await yD(e)}var n}(e,t),wD(e)&&bD(e)}async function kD(e,t){const n=oC(e);t?(n.Fr.delete(2),await nD(n)):t||(n.Fr.add(2),await rD(n),n.Br.set("Unknown"))}function CD(e){return e.qr||(e.qr=function(e,t,n){const r=oC(e);return r.Pr(),new Jx(t,r.Hi,r.credentials,r.R,n)
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}(e.datastore,e.asyncQueue,{Ii:dD.bind(null,e),Ri:fD.bind(null,e),_r:pD.bind(null,e)}),e.Mr.push((async t=>{t?(e.qr.sr(),uD(e)?cD(e):e.Br.set("Unknown")):(await e.qr.stop(),hD(e))}))),e.qr}function RD(e){return e.Kr||(e.Kr=function(e,t,n){const r=oC(e);return r.Pr(),new Xx(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:TD.bind(null,e),Ri:SD.bind(null,e),Ir:ID.bind(null,e),Tr:ED.bind(null,e)}),e.Mr.push((async t=>{t?(e.Kr.sr(),await yD(e)):(await e.Kr.stop(),e.$r.length>0&&(eC("RemoteStore",`Stopping write stream with ${e.$r.length} pending writes`),e.$r=[]))}))),e.Kr
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class AD{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new $N,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new AD(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Jk(Yk.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ND(e,t){if(tC("AsyncQueue",`${t}: ${e}`),QN(e))return new Jk(Yk.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class PD{constructor(e){this.comparator=e?(t,n)=>e(t,n)||DC.comparator(t.key,n.key):(e,t)=>DC.comparator(e.key,t.key),this.keyedMap=SA(),this.sortedSet=new yA(this.comparator)}static emptySet(e){return new PD(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof PD))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new PD;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xD{constructor(){this.jr=new yA(DC.comparator)}track(e){const t=e.doc.key,n=this.jr.get(t);n?0!==e.type&&3===n.type?this.jr=this.jr.insert(t,e):3===e.type&&1!==n.type?this.jr=this.jr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.jr=this.jr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.jr=this.jr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.jr=this.jr.remove(t):1===e.type&&2===n.type?this.jr=this.jr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.jr=this.jr.insert(t,{type:2,doc:e.doc}):iC():this.jr=this.jr.insert(t,e)}Qr(){const e=[];return this.jr.inorderTraversal(((t,n)=>{e.push(n)})),e}}class DD{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new DD(e,t,PD.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&RR(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class OD{constructor(){this.Wr=void 0,this.listeners=[]}}class MD{constructor(){this.queries=new WP((e=>AR(e)),RR),this.onlineState="Unknown",this.Gr=new Set}}async function LD(e,t){const n=oC(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new OD),i)try{s.Wr=await n.onListen(r)}catch(e){const n=ND(e,`Initialization of query '${NR(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.zr(n.onlineState),s.Wr&&t.Hr(s.Wr)&&jD(n)}async function FD(e,t){const n=oC(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function UD(e,t){const n=oC(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.Hr(e)&&(r=!0);i.Wr=e}}r&&jD(n)}function qD(e,t,n){const r=oC(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function jD(e){e.Gr.forEach((e=>{e.next()}))}class VD{constructor(e,t,n){this.query=e,this.Jr=t,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}Hr(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new DD(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),t=!0):this.eo(e,this.onlineState)&&(this.no(e),t=!0),this.Xr=e,t}onError(e){this.Jr.error(e)}zr(e){this.onlineState=e;let t=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),t=!0),t}eo(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.so&&n||e.docs.isEmpty()&&"Offline"!==t)}Zr(e){if(e.docChanges.length>0)return!0;const t=this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}no(e){e=DD.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BD{constructor(e,t){this.payload=e,this.byteLength=t}io(){return"metadata"in this.payload}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $D{constructor(e){this.R=e}Un(e){return JA(this.R,e)}qn(e){return e.metadata.exists?rN(this.R,e.document,!1):YC.newNoDocument(this.Un(e.metadata.name),this.Kn(e.metadata.readTime))}Kn(e){return HA(e)}}class WD{constructor(e,t,n){this.ro=e,this.localStore=t,this.R=n,this.queries=[],this.documents=[],this.progress=KD(e)}oo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}co(e){const t=new Map,n=new $D(this.R);for(const r of e)if(r.metadata.queries){const e=n.Un(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||AA()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=oC(e);let s=AA(),o=IA(),a=CA();for(const e of n){const n=t.Un(e.metadata.name);e.document&&(s=s.add(n)),o=o.insert(n,t.qn(e)),a=a.insert(n,t.Kn(e.metadata.readTime))}const c=i.Fn.newChangeBuffer({trackRemovals:!0}),u=await px(i,function(e){return kR(vR(_C.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>dx(e,c,o,fC.min(),a).next((t=>(c.apply(e),t))).next((t=>i.Ue.removeMatchingKeysForTargetId(e,u.targetId).next((()=>i.Ue.addMatchingKeys(e,s,u.targetId))).next((()=>i.Mn.En(e,t))).next((()=>t))))))}(this.localStore,new $D(this.R),this.documents,this.ro.id),t=this.co(this.documents);for(const e of this.queries)await vx(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",new ix(Object.assign({},this.progress),e)}}function KD(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zD{constructor(e){this.key=e}}class HD{constructor(e){this.key=e}}class GD{constructor(e,t){this.query=e,this.uo=t,this.ao=null,this.current=!1,this.ho=AA(),this.mutatedKeys=AA(),this.lo=xR(e),this.fo=new PD(this.lo)}get wo(){return this.uo}_o(e,t){const n=t?t.mo:new xD,r=t?t.fo:this.fo;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a=wR(this.query)&&r.size===this.query.limit?r.last():null,c=bR(this.query)&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=PR(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.yo(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.lo(l,a)>0||c&&this.lo(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),wR(this.query)||bR(this.query))for(;s.size>this.query.limit;){const e=wR(this.query)?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{fo:s,mo:n,Nn:o,mutatedKeys:i}}yo(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;const i=e.mo.Qr();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return iC()}};return n(e)-n(t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.type,t.type)||this.lo(e.doc,t.doc))),this.po(n);const s=t?this.Eo():[],o=0===this.ho.size&&this.current?1:0,a=o!==this.ao;return this.ao=o,0!==i.length||a?{snapshot:new DD(this.query,e.fo,r,i,e.mutatedKeys,0===o,a,!1),To:s}:{To:s}}zr(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({fo:this.fo,mo:new xD,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}}Io(e){return!this.uo.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations}po(e){e&&(e.addedDocuments.forEach((e=>this.uo=this.uo.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.uo=this.uo.delete(e))),this.current=e.current)}Eo(){if(!this.current)return[];const e=this.ho;this.ho=AA(),this.fo.forEach((e=>{this.Io(e.key)&&(this.ho=this.ho.add(e.key))}));const t=[];return e.forEach((e=>{this.ho.has(e)||t.push(new HD(e))})),this.ho.forEach((n=>{e.has(n)||t.push(new zD(n))})),t}Ao(e){this.uo=e.Bn,this.ho=AA();const t=this._o(e.documents);return this.applyChanges(t,!0)}Ro(){return DD.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)}}class QD{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class YD{constructor(e){this.key=e,this.Po=!1}}class JD{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.bo={},this.vo=new WP((e=>AR(e)),RR),this.Vo=new Map,this.So=new Set,this.Do=new yA(DC.comparator),this.Co=new Map,this.No=new bx,this.xo={},this.ko=new Map,this.$o=xP.Yt(),this.onlineState="Unknown",this.Oo=void 0}get isPrimaryClient(){return!0===this.Oo}}async function XD(e,t){const n=EO(e);let r,i;const s=n.vo.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ro();else{const e=await px(n.localStore,kR(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await ZD(n,t,r,"current"===s),n.isPrimaryClient&&iD(n.remoteStore,e)}return i}async function ZD(e,t,n,r){e.Fo=(t,n,r)=>async function(e,t,n,r){let i=t.view._o(n);i.Nn&&(i=await mx(e.localStore,t.query,!1).then((({documents:e})=>t.view._o(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return lO(e,t.targetId,o.To),o.snapshot}(e,t,n,r);const i=await mx(e.localStore,t,!0),s=new GD(t,i.Bn),o=s._o(i.documents),a=DA.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);lO(e,n,c.To);const u=new QD(t,n,s);return e.vo.set(t,u),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),c.snapshot}async function eO(e,t){const n=oC(e),r=n.vo.get(t),i=n.Vo.get(r.targetId);if(i.length>1)return n.Vo.set(r.targetId,i.filter((e=>!RR(e,t)))),void n.vo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await gx(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),sD(n.remoteStore,r.targetId),cO(n,r.targetId)})).catch(FP)):(cO(n,r.targetId),await gx(n.localStore,r.targetId,!0))}async function tO(e,t){const n=oC(e);try{const e=await function(e,t){const n=oC(e),r=t.snapshotVersion;let i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Fn.newChangeBuffer({trackRemovals:!0});i=n.kn;const o=[];t.targetChanges.forEach(((t,s)=>{const a=i.get(s);if(!a)return;o.push(n.Ue.removeMatchingKeys(e,t.removedDocuments,s).next((()=>n.Ue.addMatchingKeys(e,t.addedDocuments,s))));const c=t.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(s,u),function(e,t,n){return sC(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,u,t)&&o.push(n.Ue.updateTargetData(e,u))}}));let a=IA();if(t.documentUpdates.forEach(((r,i)=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(dx(e,s,t.documentUpdates,r,void 0).next((e=>{a=e}))),!r.isEqual(fC.min())){const t=n.Ue.getLastRemoteSnapshotVersion(e).next((t=>n.Ue.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return WN.waitFor(o).next((()=>s.apply(e))).next((()=>n.Mn.En(e,a))).next((()=>a))})).then((e=>(n.kn=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Co.get(t);r&&(sC(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Po=!0:e.modifiedDocuments.size>0?sC(r.Po):e.removedDocuments.size>0&&(sC(r.Po),r.Po=!1))})),await fO(n,e,t)}catch(e){await FP(e)}}function nO(e,t,n){const r=oC(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.vo.forEach(((n,r)=>{const i=r.view.zr(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=oC(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.zr(t)&&(r=!0)})),r&&jD(n)}(r.eventManager,t),e.length&&r.bo._r(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function rO(e,t,n){const r=oC(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Co.get(t),s=i&&i.key;if(s){let e=new yA(DC.comparator);e=e.insert(s,YC.newNoDocument(s,fC.min()));const n=AA().add(s),i=new xA(fC.min(),new Map,new wA(uC),e,n);await tO(r,i),r.Do=r.Do.remove(s),r.Co.delete(t),dO(r)}else await gx(r.localStore,t,!1).then((()=>cO(r,t,n))).catch(FP)}async function iO(e,t){const n=oC(e),r=t.batch.batchId;try{const e=await function(e,t){const n=oC(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Fn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=WN.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);sC(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))}))})),o.next((()=>e._n.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n._n.performConsistencyCheck(e))).next((()=>n.Mn.pn(e,r)))}))}(n.localStore,t);aO(n,r,null),oO(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await fO(n,e)}catch(e){await FP(e)}}async function sO(e,t,n){const r=oC(e);try{const e=await function(e,t){const n=oC(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n._n.lookupMutationBatch(e,t).next((t=>(sC(null!==t),r=t.keys(),n._n.removeMutationBatch(e,t)))).next((()=>n._n.performConsistencyCheck(e))).next((()=>n.Mn.pn(e,r)))}))}(r.localStore,t);aO(r,t,n),oO(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await fO(r,e)}catch(n){await FP(n)}}function oO(e,t){(e.ko.get(t)||[]).forEach((e=>{e.resolve()})),e.ko.delete(t)}function aO(e,t,n){const r=oC(e);let i=r.xo[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function cO(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Vo.get(t))e.vo.delete(r),n&&e.bo.Mo(r,n);e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach((t=>{e.No.containsKey(t)||uO(e,t)}))}function uO(e,t){e.So.delete(t.path.canonicalString());const n=e.Do.get(t);null!==n&&(sD(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),dO(e))}function lO(e,t,n){for(const r of n)r instanceof zD?(e.No.addReference(r.key,t),hO(e,r)):r instanceof HD?(eC("SyncEngine","Document no longer in limbo: "+r.key),e.No.removeReference(r.key,t),e.No.containsKey(r.key)||uO(e,r.key)):iC()}function hO(e,t){const n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(eC("SyncEngine","New document in limbo: "+n),e.So.add(r),dO(e))}function dO(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){const t=e.So.values().next().value;e.So.delete(t);const n=new DC(_C.fromString(t)),r=e.$o.next();e.Co.set(r,new YD(n)),e.Do=e.Do.insert(n,r),iD(e.remoteStore,new iP(kR(vR(n.path)),r,2,Qk.o))}}async function fO(e,t,n){const r=oC(e),i=[],s=[],o=[];r.vo.isEmpty()||(r.vo.forEach(((e,a)=>{o.push(r.Fo(a,t,n).then((e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=ox.vn(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.bo._r(i),await async function(e,t){const n=oC(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>WN.forEach(t,(t=>WN.forEach(t.Pn,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>WN.forEach(t.bn,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!QN(e))throw e;eC("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.kn.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.kn=n.kn.insert(t,i)}}}(r.localStore,s))}async function pO(e,t){const n=oC(e);if(!n.currentUser.isEqual(t)){eC("SyncEngine","User change. New user:",t.toKey());const e=await lx(n.localStore,t);n.currentUser=t,function(e,t){e.ko.forEach((e=>{e.forEach((e=>{e.reject(new Jk(Yk.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.ko.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await fO(n,e.Ln)}}function gO(e,t){const n=oC(e),r=n.Co.get(t);if(r&&r.Po)return AA().add(r.key);{let e=AA();const r=n.Vo.get(t);if(!r)return e;for(const t of r){const r=n.vo.get(t);e=e.unionWith(r.view.wo)}return e}}async function mO(e,t){const n=oC(e),r=await mx(n.localStore,t.query,!0),i=t.view.Ao(r);return n.isPrimaryClient&&lO(n,t.targetId,i.To),i}async function yO(e){const t=oC(e);return _x(t.localStore).then((e=>fO(t,e)))}async function _O(e,t,n,r){const i=oC(e),s=await function(e,t){const n=oC(e),r=oC(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Qt(e,t).next((t=>t?n.Mn.pn(e,t):WN.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await yD(i.remoteStore):"acknowledged"===n||"rejected"===n?(aO(i,t,r||null),oO(i,t),function(e,t){oC(oC(e)._n).Gt(t)}(i.localStore,t)):iC(),await fO(i,s)):eC("SyncEngine","Cannot apply mutation batch with id: "+t)}async function vO(e,t,n){const r=oC(e),i=[],s=[];for(const e of t){let t;const n=r.Vo.get(e);if(n&&0!==n.length){t=await px(r.localStore,kR(n[0]));for(const e of n){const t=r.vo.get(e),n=await mO(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await yx(r.localStore,e);t=await px(r.localStore,n),await ZD(r,wO(n),e,!1)}i.push(t)}return r.bo._r(s),i}function wO(e){return _R(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function bO(e){const t=oC(e);return oC(oC(t.localStore).persistence).fn()}async function TO(e,t,n,r){const i=oC(e);if(i.Oo)eC("SyncEngine","Ignoring unexpected query state notification.");else if(i.Vo.has(t))switch(n){case"current":case"not-current":{const e=await _x(i.localStore),r=xA.createSynthesizedRemoteEventForCurrentChange(t,"current"===n);await fO(i,e,r);break}case"rejected":await gx(i.localStore,t,!0),cO(i,t,r);break;default:iC()}}async function IO(e,t,n){const r=EO(e);if(r.Oo){for(const e of t){if(r.Vo.has(e)){eC("SyncEngine","Adding an already active target "+e);continue}const t=await yx(r.localStore,e),n=await px(r.localStore,t);await ZD(r,wO(t),n.targetId,!1),iD(r.remoteStore,n)}for(const e of n)r.Vo.has(e)&&await gx(r.localStore,e,!1).then((()=>{sD(r.remoteStore,e),cO(r,e)})).catch(FP)}}function EO(e){const t=oC(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=tO.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=gO.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=rO.bind(null,t),t.bo._r=UD.bind(null,t.eventManager),t.bo.Mo=qD.bind(null,t.eventManager),t}function SO(e){const t=oC(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=iO.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=sO.bind(null,t),t}class kO{constructor(){this.synchronizeTabs=!1}async initialize(e){this.R=Gx(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.Uo(e),await this.persistence.start(),this.gcScheduler=this.qo(e),this.localStore=this.Ko(e)}qo(e){return null}Ko(e){return ux(this.persistence,new ax,e.initialUser,this.R)}Uo(e){return new Cx(Ax.Ps,this.R)}Bo(e){return new jx}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class CO extends kO{constructor(e,t,n){super(),this.jo=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await async function(e){const t=oC(e);return t.persistence.runTransaction("Synchronize last document change read time","readonly",(e=>function(e){const t=QP(e);let n=fC.min();return t.Ot({index:PN.readTimeIndex,reverse:!0},((e,t,r)=>{t.readTime&&(n=uP(t.readTime)),r.done()})).next((()=>n))}(e))).then((e=>{t.On=e}))}(this.localStore),await this.jo.initialize(this,e),await SO(this.jo.syncEngine),await yD(this.jo.remoteStore)}Ko(e){return ux(this.persistence,new ax,e.initialUser,this.R)}qo(e){const t=this.persistence.referenceDelegate.garbageCollector;return new jP(t,e.asyncQueue)}Uo(e){const t=rx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?EP.withCacheSize(this.cacheSizeBytes):EP.DEFAULT;return new ex(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,zx(),Hx(),this.R,this.sharedClientState,!!this.forceOwnership)}Bo(e){return new jx}}class RO extends CO{constructor(e,t){super(e,t,!1),this.jo=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.jo.syncEngine;this.sharedClientState instanceof qx&&(this.sharedClientState.syncEngine={ui:_O.bind(null,t),ai:TO.bind(null,t),hi:IO.bind(null,t),fn:bO.bind(null,t),ci:yO.bind(null,t)},await this.sharedClientState.start()),await this.persistence.He((async e=>{await async function(e,t){const n=oC(e);if(EO(n),SO(n),!0===t&&!0!==n.Oo){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await vO(n,e.toArray());n.Oo=!0,await kD(n.remoteStore,!0);for(const e of t)iD(n.remoteStore,e)}else if(!1===t&&!1!==n.Oo){const e=[];let t=Promise.resolve();n.Vo.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(cO(n,i),gx(n.localStore,i,!0)))),sD(n.remoteStore,i)})),await t,await vO(n,e),function(e){const t=oC(e);t.Co.forEach(((e,n)=>{sD(t.remoteStore,n)})),t.No.ts(),t.Co=new Map,t.Do=new yA(DC.comparator)}(n),n.Oo=!1,await kD(n.remoteStore,!1)}}(this.jo.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop())}))}Bo(e){const t=zx();if(!qx.gt(t))throw new Jk(Yk.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=rx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qx(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class AO{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>nO(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=pO.bind(null,this.syncEngine),await kD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new MD}createDatastore(e){const t=Gx(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Kx(r));var r;return function(e,t,n){return new Zx(e,t,n)}(e.credentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>nO(this.syncEngine,e,0),s=Bx.gt()?new Bx:new Vx,new tD(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new JD(e,t,n,r,i,s);return o&&(a.Oo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=oC(e);eC("RemoteStore","RemoteStore shutting down."),t.Fr.add(5),await rD(t),t.Lr.shutdown(),t.Br.set("Unknown")}(this.remoteStore)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function NO(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class PO{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Qo(this.observer.next,e)}error(e){this.observer.error?this.Qo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Wo(){this.muted=!0}Qo(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xO{constructor(e,t){this.Go=e,this.R=t,this.metadata=new $N,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((e=>{e&&e.io()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.payload)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Go.cancel()}async getMetadata(){return this.metadata.promise}async Lo(){return await this.getMetadata(),this.Ho()}async Ho(){const e=await this.Jo();if(null===e)return null;const t=this.zo.decode(e),n=Number(t);isNaN(n)&&this.Yo(`length string (${t}) is not valid number`);const r=await this.Xo(n);return new BD(JSON.parse(r),e.length+n)}Zo(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Jo(){for(;this.Zo()<0&&!await this.tc(););if(0===this.buffer.length)return null;const e=this.Zo();e<0&&this.Yo("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Xo(e){for(;this.buffer.length<e;)await this.tc()&&this.Yo("Reached the end of bundle when more is expected.");const t=this.zo.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Yo(e){throw this.Go.cancel(),new Error(`Invalid bundle format: ${e}`)}async tc(){const e=await this.Go.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class DO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Jk(Yk.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=oC(e),r=eN(n.R)+"/documents",i={documents:t.map((e=>YA(n.R,e)))},s=await n.Oi("BatchGetDocuments",r,i),o=new Map;s.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){sC(!!t.found),t.found.name,t.found.updateTime;const n=JA(e,t.found.name),r=HA(t.found.updateTime),i=new GC({mapValue:{fields:t.found.fields}});return YC.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){sC(!!t.missing),sC(!!t.readTime);const n=JA(e,t.missing),r=HA(t.readTime);return YC.newNoDocument(n,r)}(e,t):iC()}(n.R,e);o.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=o.get(e.toString());sC(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new lA(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=DC.fromPath(t);this.mutations.push(new hA(n,this.precondition(n)))})),await async function(e,t){const n=oC(e),r=eN(n.R)+"/documents",i={writes:t.map((e=>iN(n.R,e)))};await n.Ni("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw iC();t=fC.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Jk(Yk.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?JR.updateTime(t):JR.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(fC.min()))throw new Jk(Yk.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return JR.updateTime(t)}return JR.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class OO{constructor(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Qx(this.asyncQueue,"transaction_retry")}run(){this.ec-=1,this.nc()}nc(){this.Zi.Qi((async()=>{const e=new DO(this.datastore),t=this.sc(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.ic(e)}))))})).catch((e=>{this.ic(e)}))}))}sc(e){try{const t=this.updateFunction(e);return!NC(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ic(e){this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget((()=>(this.nc(),Promise.resolve())))):this.deferred.reject(e)}rc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!gA(t)}return!1}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class MO{constructor(e,t,n){this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=Nx.UNAUTHENTICATED,this.clientId=cC.u(),this.credentialListener=()=>Promise.resolve(),this.credentials.setChangeListener(t,(async e=>{eC("FirestoreClient","Received user=",e.uid),await this.credentialListener(e),this.user=e}))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Jk(Yk.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $N;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.removeChangeListener(),e.resolve()}catch(t){const n=ND(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function LO(e,t){e.asyncQueue.verifyOperationInProgress(),eC("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await lx(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}async function FO(e,t){e.asyncQueue.verifyOperationInProgress();const n=await UO(e);eC("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>async function(e,t){const n=oC(e);n.asyncQueue.verifyOperationInProgress(),eC("RemoteStore","RemoteStore received new credentials");const r=lD(n);n.Fr.add(3),await rD(n),r&&n.Br.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Fr.delete(3),await nD(n)}(t.remoteStore,e))),e.onlineComponents=t}async function UO(e){return e.offlineComponents||(eC("FirestoreClient","Using default OfflineComponentProvider"),await LO(e,new kO)),e.offlineComponents}async function qO(e){return e.onlineComponents||(eC("FirestoreClient","Using default OnlineComponentProvider"),await FO(e,new AO)),e.onlineComponents}function jO(e){return UO(e).then((e=>e.persistence))}function VO(e){return UO(e).then((e=>e.localStore))}function BO(e){return qO(e).then((e=>e.remoteStore))}function $O(e){return qO(e).then((e=>e.syncEngine))}async function WO(e){const t=await qO(e),n=t.eventManager;return n.onListen=XD.bind(null,t.syncEngine),n.onUnlisten=eO.bind(null,t.syncEngine),n}function KO(e,t,n={}){const r=new $N;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new PO({next:s=>{t.enqueueAndForget((()=>FD(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Jk(Yk.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Jk(Yk.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new VD(vR(n.path),s,{includeMetadataChanges:!0,so:!0});return LD(e,o)}(await WO(e),e.asyncQueue,t,n,r))),r.promise}function zO(e,t,n={}){const r=new $N;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new PO({next:n=>{t.enqueueAndForget((()=>FD(e,o))),n.fromCache&&"server"===r.source?i.reject(new Jk(Yk.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new VD(n,s,{includeMetadataChanges:!0,so:!0});return LD(e,o)}(await WO(e),e.asyncQueue,t,n,r))),r.promise}function HO(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?(new TextEncoder).encode(e):e,function(e,t){return new xO(e,t)}(function(e,t){if(e instanceof Uint8Array)return NO(e,t);if(e instanceof ArrayBuffer)return NO(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,Gx(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=oC(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=oC(e),r=HA(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Ke.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),void n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r));n._updateProgress(KD(r));const i=new WD(r,e.localStore,t.R);let s=await t.Lo();for(;s;){const e=await i.oo(s);e&&n._updateProgress(e),s=await t.Lo()}const o=await i.complete();await fO(e,o.wn,void 0),await function(e,t){const n=oC(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Ke.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress)}catch(e){nC("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */)(r,t,n).then((()=>{r.sharedClientState.notifyBundleLoaded()}))}(await $O(e),i,r)}))}class GO{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class QO{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof QO&&e.projectId===this.projectId&&e.database===this.database}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const YO=new Map;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class JO{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}}class XO{constructor(){this.changeListener=null}getToken(){return Promise.resolve(null)}invalidateToken(){}setChangeListener(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(Nx.UNAUTHENTICATED)))}removeChangeListener(){this.changeListener=null}}class ZO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}setChangeListener(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}removeChangeListener(){this.changeListener=null}}class eM{constructor(e){this.currentUser=Nx.UNAUTHENTICATED,this.oc=new $N,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=()=>{this.cc++,this.currentUser=this.ac(),this.oc.resolve(),this.changeListener&&this.asyncQueue.enqueueRetryable((()=>this.changeListener(this.currentUser)))};const t=e=>{eC("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.uc)};e.onInit((e=>t(e))),setTimeout((()=>{if(!this.auth){const n=e.getImmediate({optional:!0});n?t(n):(eC("FirebaseCredentialsProvider","Auth not yet detected"),this.oc.resolve())}}),0)}getToken(){const e=this.cc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.cc!==e?(eC("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(sC("string"==typeof t.accessToken),new JO(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}setChangeListener(e,t){this.asyncQueue=e,this.asyncQueue.enqueueRetryable((async()=>{await this.oc.promise,await t(this.currentUser),this.changeListener=t}))}removeChangeListener(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=()=>Promise.resolve()}ac(){const e=this.auth&&this.auth.getUid();return sC(null===e||"string"==typeof e),new Nx(e)}}class tM{constructor(e,t,n){this.hc=e,this.lc=t,this.fc=n,this.type="FirstParty",this.user=Nx.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.lc},t=this.hc.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.fc&&(e["X-Goog-Iam-Authorization-Token"]=this.fc),e}}class nM{constructor(e,t,n){this.hc=e,this.lc=t,this.fc=n}getToken(){return Promise.resolve(new tM(this.hc,this.lc,this.fc))}setChangeListener(e,t){e.enqueueRetryable((()=>t(Nx.FIRST_PARTY)))}removeChangeListener(){}invalidateToken(){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function rM(e,t,n){if(!n)throw new Jk(Yk.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function iM(e){if(!DC.isDocumentKey(e))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function sM(e){if(DC.isDocumentKey(e))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function oM(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){if(e.constructor){const t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":iC()}function aM(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Jk(Yk.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=oM(e);throw new Jk(Yk.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function cM(e,t){if(t<=0)throw new Jk(Yk.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uM{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Jk(Yk.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Jk(Yk.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Jk(Yk.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lM{constructor(e,t){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uM({}),this._settingsFrozen=!1,e instanceof QO?(this._databaseId=e,this._credentials=new XO):(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Jk(Yk.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new QO(e.options.projectId)}(e),this._credentials=new eM(t))}get app(){if(!this._app)throw new Jk(Yk.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Jk(Yk.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uM(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new XO;switch(e.type){case"gapi":const t=e.client;return sC(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new nM(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Jk(Yk.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=YO.get(e);t&&(eC("ComponentProvider","Removing Datastore"),YO.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class hM{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fM(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hM(this.firestore,e,this._key)}}class dM{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new dM(this.firestore,e,this._query)}}class fM extends dM{constructor(e,t,n){super(e,t,vR(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hM(this.firestore,null,new DC(e))}withConverter(e){return new fM(this.firestore,e,this._path)}}function pM(e,t,...n){if(e=ba(e),rM("collection","path",t),e instanceof lM){const r=_C.fromString(t,...n);return sM(r),new fM(e,null,r)}{if(!(e instanceof hM||e instanceof fM))throw new Jk(Yk.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=_C.fromString(e.path,...n).child(_C.fromString(t));return sM(r),new fM(e.firestore,null,r)}}function gM(e,t,...n){if(e=ba(e),1===arguments.length&&(t=cC.u()),rM("doc","path",t),e instanceof lM){const r=_C.fromString(t,...n);return iM(r),new hM(e,null,new DC(r))}{if(!(e instanceof hM||e instanceof fM))throw new Jk(Yk.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_C.fromString(t,...n));return iM(r),new hM(e.firestore,e instanceof fM?e.converter:null,new DC(r))}}function mM(e,t){return e=ba(e),t=ba(t),(e instanceof hM||e instanceof fM)&&(t instanceof hM||t instanceof fM)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function yM(e,t){return e=ba(e),t=ba(t),e instanceof dM&&t instanceof dM&&e.firestore===t.firestore&&RR(e._query,t._query)&&e.converter===t.converter
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class _M{constructor(){this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.gc=null,this.yc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Qx(this,"async_queue_retry"),this.Ic=()=>{const e=Hx();e&&eC("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Zi.Gi()};const e=Hx();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}get isShuttingDown(){return this._c}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ac(),this.Rc(e)}enterRestrictedMode(e){if(!this._c){this._c=!0,this.Ec=e||!1;const t=Hx();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ic)}}enqueue(e){if(this.Ac(),this._c)return new Promise((()=>{}));const t=new $N;return this.Rc((()=>this._c&&this.Ec?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.wc.push(e),this.Pc())))}async Pc(){if(0!==this.wc.length){try{await this.wc[0](),this.wc.shift(),this.Zi.reset()}catch(e){if(!QN(e))throw e;eC("AsyncQueue","Operation failed with retryable error: "+e)}this.wc.length>0&&this.Zi.Qi((()=>this.Pc()))}}Rc(e){const t=this.dc.then((()=>(this.yc=!0,e().catch((e=>{throw this.gc=e,this.yc=!1,tC("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)),e})).then((e=>(this.yc=!1,e))))));return this.dc=t,t}enqueueAfterDelay(e,t,n){this.Ac(),this.Tc.indexOf(e)>-1&&(t=0);const r=AD.createAndSchedule(this,e,t,n,(e=>this.bc(e)));return this.mc.push(r),r}Ac(){this.gc&&iC()}verifyOperationInProgress(){}async vc(){let e;do{e=this.dc,await e}while(e!==this.dc)}Vc(e){for(const t of this.mc)if(t.timerId===e)return!0;return!1}Sc(e){return this.vc().then((()=>{this.mc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.mc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.vc()}))}Dc(e){this.Tc.push(e)}bc(e){const t=this.mc.indexOf(e);this.mc.splice(t,1)}}function vM(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}class wM{constructor(){this._progressObserver={},this._taskCompletionResolver=new $N,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bM extends lM{constructor(e,t){super(e,t),this.type="firestore",this._queue=new _M,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||IM(this),this._firestoreClient.terminate()}}function TM(e){return e._firestoreClient||IM(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function IM(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new GO(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new MO(e._credentials,e._queue,r)}function EM(e,t,n){const r=new $N;return e.asyncQueue.enqueue((async()=>{try{await LO(e,n),await FO(e,t),r.resolve()}catch(e){if(!function(e){return"FirebaseError"===e.name?e.code===Yk.FAILED_PRECONDITION||e.code===Yk.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(e))throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.reject(e)}})).then((()=>r.promise))}function SM(e){return function(e){const t=new $N;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=oC(e);lD(n.remoteStore)||eC("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=oC(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t._n.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.ko.get(e)||[];r.push(t),n.ko.set(e,r)}catch(e){const n=ND(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await $O(e),t))),t.promise}(TM(e=aM(e,bM)))}function kM(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await jO(e),n=await BO(e);return t.setNetworkEnabled(!0),function(e){const t=oC(e);return t.Fr.delete(0),nD(t)}(n)}))}(TM(e=aM(e,bM)))}function CM(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await jO(e),n=await BO(e);return t.setNetworkEnabled(!1),async function(e){const t=oC(e);t.Fr.add(0),await rD(t),t.Br.set("Offline")}(n)}))}(TM(e=aM(e,bM)))}function RM(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=oC(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Ke.getNamedQuery(e,t)))}(await VO(e),t)))}(TM(e=aM(e,bM)),t).then((t=>t?new dM(e,null,t.query):null))}function AM(e){if(e._initialized||e._terminated)throw new Jk(Yk.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class NM{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Jk(Yk.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wC(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class PM{constructor(e){this._byteString=e}static fromBase64String(e){try{return new PM(TC.fromBase64String(e))}catch(e){throw new Jk(Yk.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new PM(TC.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xM{constructor(e){this._methodName=e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class DM{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Jk(Yk.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Jk(Yk.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return uC(this._lat,e._lat)||uC(this._long,e._long)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const OM=/^__.*__$/;class MM{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new oA(e,this.data,this.fieldMask,t,this.fieldTransforms):new sA(e,this.data,t,this.fieldTransforms)}}class LM{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new oA(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FM(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw iC()}}class UM{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Nc(){return this.settings.Nc}xc(e){return new UM(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}kc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.xc({path:n,$c:!1});return r.Oc(e),r}Fc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.xc({path:n,$c:!1});return r.Cc(),r}Mc(e){return this.xc({path:void 0,$c:!0})}Lc(e){return iL(e,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.Uc)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Cc(){if(this.path)for(let e=0;e<this.path.length;e++)this.Oc(this.path.get(e))}Oc(e){if(0===e.length)throw this.Lc("Document fields must not be empty");if(FM(this.Nc)&&OM.test(e))throw this.Lc('Document fields cannot begin and end with "__"')}}class qM{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.R=n||Gx(e)}qc(e,t,n,r=!1){return new UM({Nc:e,methodName:t,Uc:n,path:wC.emptyPath(),$c:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)}}function jM(e){const t=e._freezeSettings(),n=Gx(e._databaseId);return new qM(e._databaseId,!!t.ignoreUndefinedProperties,n)}function VM(e,t,n,r,i,s={}){const o=e.qc(s.merge||s.mergeFields?2:0,t,n,i);eL("Data must be an object, but it was:",o,r);const a=XM(r,o);let c,u;if(s.merge)c=new bC(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=tL(t,r,n);if(!o.contains(i))throw new Jk(Yk.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);sL(e,i)||e.push(i)}c=new bC(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new MM(new GC(a),c,u)}class BM extends xM{_toFieldTransform(e){if(2!==e.Nc)throw 1===e.Nc?e.Lc(`${this._methodName}() can only appear at the top level of your update data`):e.Lc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof BM}}function $M(e,t,n){return new UM({Nc:3,Uc:t.settings.Uc,methodName:e._methodName,$c:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}class WM extends xM{_toFieldTransform(e){return new QR(e.path,new VR)}isEqual(e){return e instanceof WM}}class KM extends xM{constructor(e,t){super(e),this.Kc=t}_toFieldTransform(e){const t=$M(this,e,!0),n=this.Kc.map((e=>JM(e,t))),r=new BR(n);return new QR(e.path,r)}isEqual(e){return this===e}}class zM extends xM{constructor(e,t){super(e),this.Kc=t}_toFieldTransform(e){const t=$M(this,e,!0),n=this.Kc.map((e=>JM(e,t))),r=new WR(n);return new QR(e.path,r)}isEqual(e){return this===e}}class HM extends xM{constructor(e,t){super(e),this.jc=t}_toFieldTransform(e){const t=new zR(e.R,LR(e.R,this.jc));return new QR(e.path,t)}isEqual(e){return this===e}}function GM(e,t,n,r){const i=e.qc(1,t,n);eL("Data must be an object, but it was:",i,r);const s=[],o=GC.empty();gC(r,((e,r)=>{const a=rL(t,e,n);r=ba(r);const c=i.Fc(a);if(r instanceof BM)s.push(a);else{const e=JM(r,c);null!=e&&(s.push(a),o.set(a,e))}}));const a=new bC(s);return new LM(o,a,i.fieldTransforms)}function QM(e,t,n,r,i,s){const o=e.qc(1,t,n),a=[tL(t,r,n)],c=[i];if(s.length%2!=0)throw new Jk(Yk.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(tL(t,s[e])),c.push(s[e+1]);const u=[],l=GC.empty();for(let e=a.length-1;e>=0;--e)if(!sL(u,a[e])){const t=a[e];let n=c[e];n=ba(n);const r=o.Fc(t);if(n instanceof BM)u.push(t);else{const e=JM(n,r);null!=e&&(u.push(t),l.set(t,e))}}const h=new bC(u);return new LM(l,h,o.fieldTransforms)}function YM(e,t,n,r=!1){return JM(n,e.qc(r?4:3,t))}function JM(e,t){if(ZM(e=ba(e)))return eL("Unsupported field value:",t,e),XM(e,t);if(e instanceof xM)return function(e,t){if(!FM(t.Nc))throw t.Lc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Lc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.$c&&4!==t.Nc)throw t.Lc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=JM(i,t.Mc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=ba(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return LR(t.R,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=dC.fromDate(e);return{timestampValue:WA(t.R,n)}}if(e instanceof dC){const n=new dC(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:WA(t.R,n)}}if(e instanceof DM)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof PM)return{bytesValue:KA(t.R,e._byteString)};if(e instanceof hM){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Lc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:GA(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Lc(`Unsupported field value: ${oM(e)}`)}(e,t)}function XM(e,t){const n={};return mC(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):gC(e,((e,r)=>{const i=JM(r,t.kc(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function ZM(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof dC||e instanceof DM||e instanceof PM||e instanceof hM||e instanceof xM)}function eL(e,t,n){if(!ZM(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=oM(n);throw"an object"===r?t.Lc(e+" a custom object"):t.Lc(e+" "+r)}}function tL(e,t,n){if((t=ba(t))instanceof NM)return t._internalPath;if("string"==typeof t)return rL(e,t);throw iL("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}const nL=new RegExp("[~\\*/\\[\\]]");function rL(e,t,n){if(t.search(nL)>=0)throw iL(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new NM(...t.split("."))._internalPath}catch(r){throw iL(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function iL(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Jk(Yk.INVALID_ARGUMENT,a+e+c)}function sL(e,t){return e.some((e=>e.isEqual(t)))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class oL{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new hM(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new aL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(cL("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class aL extends oL{data(){return super.data()}}function cL(e,t){return"string"==typeof t?rL(e,t):t instanceof NM?t._internalPath:t._delegate._internalPath}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uL{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lL extends oL{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new hL(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(cL("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class hL extends lL{data(e={}){return super.data(e)}}class dL{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new uL(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new hL(this._firestore,this._userDataWriter,n.key,n,new uL(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Jk(Yk.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>({type:"added",doc:new hL(e._firestore,e._userDataWriter,n.doc.key,n.doc,new uL(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++})))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new hL(e._firestore,e._userDataWriter,t.doc.key,t.doc,new uL(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:fL(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function fL(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return iC()}}function pL(e,t){return e instanceof lL&&t instanceof lL?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof dL&&t instanceof dL&&e._firestore===t._firestore&&yM(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function gL(e){if(bR(e)&&0===e.explicitOrderBy.length)throw new Jk(Yk.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mL{}function yL(e,...t){for(const n of t)e=n._apply(e);return e}class _L extends mL{constructor(e,t,n){super(),this.Qc=e,this.Wc=t,this.Gc=n,this.type="where"}_apply(e){const t=jM(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Jk(Yk.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){SL(o,s);const t=[];for(const n of o)t.push(EL(r,e,n));a={arrayValue:{values:t}}}else a=EL(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||SL(o,s),a=YM(n,"where",o,"in"===s||"not-in"===s);const c=nR.create(i,s,a);return function(e,t){if(t.g()){const n=IR(e);if(null!==n&&!n.isEqual(t.field))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=TR(e);null!==r&&kL(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Jk(Yk.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Jk(Yk.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.Qc,this.Wc,this.Gc);return new dM(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new yR(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}class vL extends mL{constructor(e,t){super(),this.Qc=e,this.zc=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Jk(Yk.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Jk(Yk.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new fR(t,n);return function(e,t){if(null===TR(e)){const n=IR(e);null!==n&&kL(e,n,t.field)}}(e,r),r}(e._query,this.Qc,this.zc);return new dM(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new yR(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class wL extends mL{constructor(e,t,n){super(),this.type=e,this.Hc=t,this.Jc=n}_apply(e){return new dM(e.firestore,e.converter,CR(e._query,this.Hc,this.Jc))}}class bL extends mL{constructor(e,t,n){super(),this.type=e,this.Yc=t,this.Xc=n}_apply(e){const t=IL(e,this.type,this.Yc,this.Xc);return new dM(e.firestore,e.converter,function(e,t){return new yR(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class TL extends mL{constructor(e,t,n){super(),this.type=e,this.Yc=t,this.Xc=n}_apply(e){const t=IL(e,this.type,this.Yc,this.Xc);return new dM(e.firestore,e.converter,function(e,t){return new yR(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function IL(e,t,n,r){if(n[0]=ba(n[0]),n[0]instanceof oL)return function(e,t,n,r,i){if(!r)throw new Jk(Yk.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of SR(e))if(n.field.isKeyField())s.push(VC(t,r.key));else{const e=r.data.field(n.field);if(CC(e))throw new Jk(Yk.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new hR(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=jM(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new Jk(Yk.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!ER(e)&&-1!==c.indexOf("/"))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(_C.fromString(c));if(!DC.isDocumentKey(n))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new DC(n);a.push(VC(t,i))}else{const e=YM(n,r,c);a.push(e)}}return new hR(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function EL(e,t,n){if("string"==typeof(n=ba(n))){if(""===n)throw new Jk(Yk.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ER(t)&&-1!==n.indexOf("/"))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(_C.fromString(n));if(!DC.isDocumentKey(r))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return VC(e,new DC(r))}if(n instanceof hM)return VC(e,n._key);throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${oM(n)}.`)}function SL(e,t){if(!Array.isArray(e)||0===e.length)throw new Jk(Yk.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new Jk(Yk.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function kL(e,t,n){if(!n.isEqual(t))throw new Jk(Yk.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class CL{convertValue(e,t="none"){switch(OC(e)){case 0:return null;case 1:return e.booleanValue;case 2:return SC(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(kC(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw iC()}}convertObject(e,t){const n={};return gC(e.fields,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new DM(SC(e.latitude),SC(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=RC(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(AC(e));default:return null}}convertTimestamp(e){const t=EC(e);return new dC(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=_C.fromString(e);sC(vN(n));const r=new QO(n.get(1),n.get(3)),i=new DC(n.popFirst(5));return r.isEqual(t)||tC(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function RL(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class AL extends CL{constructor(e){super(),this.firestore=e}convertBytes(e){return new PM(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hM(this.firestore,null,t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class NL{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=jM(e)}set(e,t,n){this._verifyNotCommitted();const r=PL(e,this._firestore),i=RL(r.converter,t,n),s=VM(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,JR.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=PL(e,this._firestore);let s;return s="string"==typeof(t=ba(t))||t instanceof NM?QM(this._dataReader,"WriteBatch.update",i._key,t,n,r):GM(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,JR.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=PL(e,this._firestore);return this._mutations=this._mutations.concat(new lA(t._key,JR.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Jk(Yk.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function PL(e,t){if((e=ba(e)).firestore!==t)throw new Jk(Yk.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xL extends CL{constructor(e){super(),this.firestore=e}convertBytes(e){return new PM(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hM(this.firestore,null,t)}}function DL(e){e=aM(e,hM);const t=aM(e.firestore,bM),n=TM(t),r=new xL(t);return function(e,t){const n=new $N;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=oC(e);return n.persistence.runTransaction("read document","readonly",(e=>n.Mn.mn(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new Jk(Yk.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=ND(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await VO(e),t,n))),n.promise}(n,e._key).then((n=>new lL(t,r,e._key,n,new uL(null!==n&&n.hasLocalMutations,!0),e.converter)))}function OL(e){e=aM(e,dM);const t=aM(e.firestore,bM),n=TM(t),r=new xL(t);return function(e,t){const n=new $N;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await mx(e,t,!0),i=new GD(t,r.Bn),s=i._o(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=ND(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await VO(e),t,n))),n.promise}(n,e._query).then((n=>new dL(t,r,e,n)))}function ML(e,t,n,...r){e=aM(e,hM);const i=aM(e.firestore,bM),s=jM(i);let o;return o="string"==typeof(t=ba(t))||t instanceof NM?QM(s,"updateDoc",e._key,t,n,r):GM(s,"updateDoc",e._key,t),UL(i,[o.toMutation(e._key,JR.exists(!0))])}function LL(e,...t){var n,r,i;e=ba(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||vM(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(vM(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof hM)u=aM(e.firestore,bM),l=vR(e._key.path),c={next:n=>{t[o]&&t[o](qL(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=aM(e,dM);u=aM(n.firestore,bM),l=n._query;const r=new xL(u);c={next:e=>{t[o]&&t[o](new dL(u,r,n,e))},error:t[o+1],complete:t[o+2]},gL(e._query)}return function(e,t,n,r){const i=new PO(r),s=new VD(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>LD(await WO(e),s))),()=>{i.Wo(),e.asyncQueue.enqueueAndForget((async()=>FD(await WO(e),s)))}}(TM(u),l,a,c)}function FL(e,t){return function(e,t){const n=new PO(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){oC(e).Gr.add(t),t.next()}(await WO(e),n))),()=>{n.Wo(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){oC(e).Gr.delete(t)}(await WO(e),n)))}}(TM(e=aM(e,bM)),vM(t)?t:{next:t})}function UL(e,t){return function(e,t){const n=new $N;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=SO(e);try{const e=await function(e,t){const n=oC(e),r=dC.now(),i=t.reduce(((e,t)=>e.add(t.key)),AA());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>n.Mn.pn(e,i).next((i=>{s=i;const o=[];for(const e of t){const t=nA(e,s.get(e.key));null!=t&&o.push(new oA(e.key,t,QC(t.value.mapValue),JR.exists(!0)))}return n._n.addMutationBatch(e,r,o,t)})))).then((e=>(e.applyToLocalDocumentSet(s),{batchId:e.batchId,changes:s})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.xo[e.currentUser.toKey()];r||(r=new yA(uC)),r=r.insert(t,n),e.xo[e.currentUser.toKey()]=r}(r,e.batchId,n),await fO(r,e.changes),await yD(r.remoteStore)}catch(e){const t=ND(e,"Failed to persist write");n.reject(t)}}(await $O(e),t,n))),n.promise}(TM(e),t)}function qL(e,t,n){const r=n.docs.get(t._key),i=new xL(e);return new lL(e,i,t._key,r,new uL(n.hasPendingWrites,n.fromCache),t.converter)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class jL extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=jM(e)}get(e){const t=PL(e,this._firestore),n=new AL(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return iC();const r=e[0];if(r.isFoundDocument())return new oL(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new oL(this._firestore,n,t._key,null,t.converter);throw iC()}))}set(e,t,n){const r=PL(e,this._firestore),i=RL(r.converter,t,n),s=VM(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=PL(e,this._firestore);let s;return s="string"==typeof(t=ba(t))||t instanceof NM?QM(this._dataReader,"Transaction.update",i._key,t,n,r):GM(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=PL(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=PL(e,this._firestore),n=new xL(this._firestore);return super.get(e).then((e=>new lL(this._firestore,n,t._key,e._document,new uL(!1,!1),t.converter)))}}function VL(e,t){return function(e,t){const n=new $N;return e.asyncQueue.enqueueAndForget((async()=>{const r=await function(e){return qO(e).then((e=>e.datastore))}(e);new OO(e.asyncQueue,r,t,n).run()})),n.promise}(TM(e),(n=>t(new jL(e,n))))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Gk="9.0.0-beta.7",$a(new Ta("firestore-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=new bM(n,e.getProvider("auth-internal"));return t=Object.assign({useFetchStreams:!1},t),r._setSettings(t),r}),"PUBLIC")),Ja("@firebase/firestore","0.0.900-exp.6ef484a04",undefined);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const BL="(default)";class $L{constructor(e,t){this.projectId=e,this.database=t||BL}get isDefaultDatabase(){return this.database===BL}isEqual(e){return e instanceof $L&&e.projectId===this.projectId&&e.database===this.database}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let WL="8.7.1";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const KL=new Da("@firebase/firestore");function zL(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function HL(e="Unexpected state"){const t=`FIRESTORE (${WL}) INTERNAL ASSERTION FAILED: `+e;throw function(e,...t){if(KL.logLevel<=ka.ERROR){const n=t.map(zL);KL.error(`Firestore (${WL}): ${e}`,...n)}}(t),new Error(t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const GL="invalid-argument",QL="failed-precondition",YL="unimplemented";class JL extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const XL="__name__";class ZL{constructor(e,t,n){void 0===t?t=0:t>e.length&&HL(),void 0===n?n=e.length-t:n>e.length-t&&HL(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ZL.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ZL?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class eF extends ZL{construct(e,t,n){return new eF(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new JL(GL,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new eF(t)}static emptyPath(){return new eF([])}}const tF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nF extends ZL{construct(e,t,n){return new nF(e,t,n)}static isValidIdentifier(e){return tF.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nF.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===XL}static keyField(){return new nF([XL])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new JL(GL,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new JL(GL,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new JL(GL,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new JL(GL,"Unterminated ` in path: "+e);return new nF(t)}static emptyPath(){return new nF([])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rF{constructor(e){this.path=e}static fromPath(e){return new rF(eF.fromString(e))}static fromName(e){return new rF(eF.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===eF.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return eF.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rF(new eF(e.slice()))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function iF(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new JL(GL,`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function sF(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new JL(GL,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){if(e.constructor){const t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":HL()}(e);throw new JL(GL,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function oF(){if("undefined"==typeof Uint8Array)throw new JL(YL,"Uint8Arrays are not available in this environment.")}function aF(){if("undefined"==typeof atob)throw new JL(YL,"Blobs are unavailable in Firestore in this environment.")}class cF{constructor(e){this._delegate=e}static fromBase64String(e){return aF(),new cF(PM.fromBase64String(e))}static fromUint8Array(e){return oF(),new cF(PM.fromUint8Array(e))}toBase64(){return aF(),this._delegate.toBase64()}toUint8Array(){return oF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function uF(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,["next","error","complete"])}class lF{enableIndexedDbPersistence(e,t){return function(e,t){AM(e=aM(e,bM));const n=TM(e),r=e._freezeSettings(),i=new AO;return EM(n,i,new CO(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){AM(e=aM(e,bM));const t=TM(e),n=e._freezeSettings(),r=new AO;return EM(t,r,new RO(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new Jk(Yk.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new $N;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!zN.gt())return Promise.resolve();const t=e+"main";await zN.delete(t)}(rx(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}(e._delegate)}}class hF{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof $L||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||function(e,...t){if(KL.logLevel<=ka.WARN){const n=t.map(zL);KL.warn(`Firestore (${WL}): ${e}`,...n)}}("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function(e,t,n,r={}){const i=(e=aM(e,lM))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&nC("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){const t=Fo(r.mockUserToken),n=r.mockUserToken.sub||r.mockUserToken.user_id;if(!n)throw new Jk(Yk.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");e._credentials=new ZO(new JO(t,new Nx(n)))}}(this._delegate,e,t,n)}enableNetwork(){return kM(this._delegate)}disableNetwork(){return CM(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,function(e,t,n,r){if(!0===t&&!0===r)throw new JL(GL,`${e} and ${n} cannot be used together.`)}("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore"),this._appCompat._removeServiceInstance("firestore-exp")),this._delegate._delete()}waitForPendingWrites(){return SM(this._delegate)}onSnapshotsInSync(e){return FL(this._delegate,e)}get app(){if(!this._appCompat)throw new JL(QL,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new SF(this,pM(this._delegate,e))}catch(e){throw yF(e,"collection()","Firestore.collection()")}}doc(e){try{return new mF(this,gM(this._delegate,e))}catch(e){throw yF(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new TF(this,function(e,t){if(e=aM(e,lM),rM("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Jk(Yk.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new dM(e,null,function(e){return new yR(_C.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw yF(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return VL(this._delegate,(t=>e(new fF(this,t))))}batch(){return TM(this._delegate),new pF(new NL(this._delegate,(e=>UL(this._delegate,e))))}loadBundle(e){throw new JL(QL,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')}namedQuery(e){throw new JL(QL,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')}}class dF extends CL{constructor(e){super(),this.firestore=e}convertBytes(e){return new cF(new PM(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return mF.forKey(t,this.firestore,null)}}class fF{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new dF(e)}get(e){const t=kF(e);return this._delegate.get(t).then((e=>new wF(this._firestore,new lL(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=kF(e);return n?(iF("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=kF(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=kF(e);return this._delegate.delete(t),this}}class pF{constructor(e){this._delegate=e}set(e,t,n){const r=kF(e);return n?(iF("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=kF(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=kF(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class gF{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new hL(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new bF(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=gF.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new gF(e,new dF(e),t),r.set(t,i)),i}}gF.INSTANCES=new WeakMap;class mF{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new dF(e)}static forPath(e,t,n){if(e.length%2!=0)throw new JL(GL,`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new mF(t,new hM(t._delegate,n,new rF(e)))}static forKey(e,t,n){return new mF(t,new hM(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new SF(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new SF(this.firestore,pM(this._delegate,e))}catch(e){throw yF(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=ba(e))instanceof hM&&mM(this._delegate,e)}set(e,t){t=iF("DocumentReference.set",t);try{return function(e,t,n){e=aM(e,hM);const r=aM(e.firestore,bM),i=RL(e.converter,t,n);return UL(r,[VM(jM(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,JR.none())])}(this._delegate,e,t)}catch(e){throw yF(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?ML(this._delegate,e):ML(this._delegate,e,t,...n)}catch(e){throw yF(e,"updateDoc()","DocumentReference.update()")}}delete(){return function(e){return UL(aM(e.firestore,bM),[new lA(e._key,JR.none())])}(this._delegate)}onSnapshot(...e){const t=_F(e),n=vF(e,(e=>new wF(this.firestore,new lL(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return LL(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?DL(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=aM(e,hM);const t=aM(e.firestore,bM);return KO(TM(t),e._key,{source:"server"}).then((n=>qL(t,e,n)))}(this._delegate):function(e){e=aM(e,hM);const t=aM(e.firestore,bM);return KO(TM(t),e._key).then((n=>qL(t,e,n)))}(this._delegate),t.then((e=>new wF(this.firestore,new lL(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new mF(this.firestore,e?this._delegate.withConverter(gF.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function yF(e,t,n){return e.message=e.message.replace(t,n),e}function _F(e){for(const t of e)if("object"==typeof t&&!uF(t))return t;return{}}function vF(e,t){var n,r;let i;return i=uF(e[0])?e[0]:uF(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class wF{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new mF(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return pL(this._delegate,e._delegate)}}class bF extends wF{data(e){return this._delegate.data(e)}}class TF{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new dF(e)}where(e,t,n){try{return new TF(this.firestore,yL(this._delegate,function(e,t,n){const r=t,i=cL("where",e);return new _L(i,r,n)}(e,t,n)))}catch(e){throw yF(e,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new TF(this.firestore,yL(this._delegate,function(e,t="asc"){const n=t,r=cL("orderBy",e);return new vL(r,n)}(e,t)))}catch(e){throw yF(e,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new TF(this.firestore,yL(this._delegate,function(e){return cM("limit",e),new wL("limit",e,"F")}(e)))}catch(e){throw yF(e,"limit()","Query.limit()")}}limitToLast(e){try{return new TF(this.firestore,yL(this._delegate,function(e){return cM("limitToLast",e),new wL("limitToLast",e,"L")}(e)))}catch(e){throw yF(e,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new TF(this.firestore,yL(this._delegate,function(...e){return new bL("startAt",e,!0)}(...e)))}catch(e){throw yF(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new TF(this.firestore,yL(this._delegate,function(...e){return new bL("startAfter",e,!1)}(...e)))}catch(e){throw yF(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new TF(this.firestore,yL(this._delegate,function(...e){return new TL("endBefore",e,!0)}(...e)))}catch(e){throw yF(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new TF(this.firestore,yL(this._delegate,function(...e){return new TL("endAt",e,!1)}(...e)))}catch(e){throw yF(e,"endAt()","Query.endAt()")}}isEqual(e){return yM(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?OL(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=aM(e,dM);const t=aM(e.firestore,bM),n=TM(t),r=new xL(t);return zO(n,e._query,{source:"server"}).then((n=>new dL(t,r,e,n)))}(this._delegate):function(e){e=aM(e,dM);const t=aM(e.firestore,bM),n=TM(t),r=new xL(t);return gL(e._query),zO(n,e._query).then((n=>new dL(t,r,e,n)))}(this._delegate),t.then((e=>new EF(this.firestore,new dL(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(...e){const t=_F(e),n=vF(e,(e=>new EF(this.firestore,new dL(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return LL(this._delegate,t,n)}withConverter(e){return new TF(this.firestore,e?this._delegate.withConverter(gF.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class IF{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new bF(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class EF{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new TF(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new bF(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new IF(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new bF(this._firestore,n))}))}isEqual(e){return pL(this._delegate,e._delegate)}}class SF extends TF{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new mF(this.firestore,e):null}doc(e){try{return new mF(this.firestore,void 0===e?gM(this._delegate):gM(this._delegate,e))}catch(e){throw yF(e,"doc()","CollectionReference.doc()")}}add(e){return function(e,t){const n=aM(e.firestore,bM),r=gM(e),i=RL(e.converter,t);return UL(n,[VM(jM(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,JR.exists(!1))]).then((()=>r))}(this._delegate,e).then((e=>new mF(this.firestore,e)))}isEqual(e){return mM(this._delegate,e._delegate)}withConverter(e){return new SF(this.firestore,e?this._delegate.withConverter(gF.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function kF(e){return sF(e,hM)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function CF(e){return function(e,t){const n=TM(e=aM(e,bM)),r=new wM;return HO(n,e._databaseId,t,r),r}(this._delegate,e)}function RF(e){return RM(this._delegate,e).then((e=>e?new TF(this,e):null))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class AF{constructor(...e){this._delegate=new NM(...e)}static documentId(){return new AF(nF.keyField().canonicalString())}isEqual(e){return(e=ba(e))instanceof NM&&this._delegate._internalPath.isEqual(e._internalPath)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class NF{constructor(e){this._delegate=e}static serverTimestamp(){const e=new WM("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new NF(e)}static delete(){const e=new BM("deleteField");return e._methodName="FieldValue.delete",new NF(e)}static arrayUnion(...e){const t=function(...e){return new KM("arrayUnion",e)}(...e);return t._methodName="FieldValue.arrayUnion",new NF(t)}static arrayRemove(...e){const t=function(...e){return new zM("arrayRemove",e)}(...e);return t._methodName="FieldValue.arrayRemove",new NF(t)}static increment(e){const t=function(e){return new HM("increment",e)}(e);return t._methodName="FieldValue.increment",new NF(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const PF={Firestore:hF,GeoPoint:DM,Timestamp:dC,Blob:cF,Transaction:fF,WriteBatch:pF,DocumentReference:mF,DocumentSnapshot:wF,Query:TF,QueryDocumentSnapshot:bF,QuerySnapshot:EF,CollectionReference:SF,FieldPath:AF,FieldValue:NF,setLogLevel:function(e){var t;t=e,KL.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){!function(e){WL=e}(e.SDK_VERSION),function(e,t){e.INTERNAL.registerComponent(new Ta("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore-exp").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},PF)))}(e,((e,t)=>new hF(e,t,new lF))),e.registerVersion("@firebase/firestore-compat","0.0.900-exp.6ef484a04")}(oc),function(e){e.prototype.loadBundle=CF,e.prototype.namedQuery=RF}(hF);function xF(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function DF(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>DF(e)));if("function"==typeof e||"object"==typeof e)return xF(e,(e=>DF(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function OF(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>OF(e))):"function"==typeof e||"object"==typeof e?xF(e,(e=>OF(e))):e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const MF="functions-exp",LF={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class FF extends Go{constructor(e,t,n){super(`functions-exp/${e}`,t||""),this.details=n}}class UF{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||n.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(){if(this.appCheck){return(await this.appCheck.getToken()).token}return null}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken()}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const qF="us-central1";function jF(e){return new Promise(((t,n)=>{setTimeout((()=>{n(new FF("deadline-exceeded","deadline-exceeded"))}),e)}))}class VF{constructor(e,t,n,r,i="us-central1",s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new UF(t,n,r),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(i);this.customDomain=e.origin,this.region=qF}catch(e){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function BF(e,t,n){return r=>async function(e,t,n,r){const i=e._url(t),s={data:n=DF(n)},o={},a=await e.contextProvider.getContext();a.authToken&&(o.Authorization="Bearer "+a.authToken);a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken);null!==a.appCheckToken&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const c=r.timeout||7e4,u=await Promise.race([$F(i,s,o,e.fetchImpl),jF(c),e.cancelAllRequests]);if(!u)throw new FF("cancelled","Firebase Functions instance was deleted.");const l=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!LF[t])return new FF("internal","internal");r=LF[t],i=t}const s=e.message;"string"==typeof s&&(i=s),n=e.details,void 0!==n&&(n=OF(n))}}catch(e){}return"ok"===r?null:new FF(r,i,n)}(u.status,u.json);if(l)throw l;if(!u.json)throw new FF("internal","Response is not valid JSON object.");let h=u.json.data;void 0===h&&(h=u.json.result);if(void 0===h)throw new FF("internal","Response is missing data field.");return{data:OF(h)}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,r,n||{})}async function $F(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}function WF(e,t,n){!function(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}(ba(e),t,n)}var KF;KF=fetch.bind(self),$a(new Ta(MF,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("messaging"),s=e.getProvider("app-check-internal");return new VF(n,r,i,s,t,KF)}),"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/functions-exp","0.0.900-exp.6ef484a04");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class zF{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return function(e,t,n){return BF(ba(e),t,n)}(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new Go("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new Go("functions","Port missing in origin provided to useFunctionsEmulator()");return WF(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return WF(this._delegate,e,t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const HF=(e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions-exp").getImmediate({identifier:null!=t?t:"us-central1"});return new zF(n,r)};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
!function(){const e={Functions:zF};oc.INTERNAL.registerComponent(new Ta("functions-compat",HF,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),oc.registerVersion("@firebase/functions-compat","0.0.900-exp.6ef484a04");
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const GF=new Qo("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const QF="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",YF="google.c.a.c_id";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
   * in compliance with the License. You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software distributed under the License
   * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
   * or implied. See the License for the specific language governing permissions and limitations under
   * the License.
   */
var JF;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function XF(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ZF(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(JF||(JF={}));const eU="fcm_token_details_db",tU="fcm_token_object_Store";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const nU="firebase-messaging-store";let rU=null;function iU(){return rU||(rU=bc("firebase-messaging-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(nU)}}))),rU}async function sU(e){const t=aU(e),n=await iU(),r=await n.transaction(nU).objectStore(nU).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB&&!(await indexedDB.databases()).map((e=>e.name)).includes(eU))return null;let t=null;return(await bc(eU,5,(async n=>{var r;if(n.oldVersion<2)return;if(!n.objectStoreNames.contains(tU))return;const i=n.transaction.objectStore(tU),s=await i.index("fcmSenderId").get(e);if(await i.clear(),s)if(2===n.oldVersion){const e=s;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(r=e.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:XF(e.vapidKey)}}}else if(3===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:XF(e.auth),p256dh:XF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:XF(e.vapidKey)}}}else if(4===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:XF(e.auth),p256dh:XF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:XF(e.vapidKey)}}}}))).close(),await Tc(eU),await Tc("fcm_vapid_details_db"),await Tc("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await oU(e,t),t}}async function oU(e,t){const n=aU(e),r=(await iU()).transaction(nU,"readwrite");return await r.objectStore(nU).put(t,n),await r.complete,t}function aU({appConfig:e}){return e.appId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function cU(e,t){const n={method:"DELETE",headers:await lU(e)};try{const r=await fetch(`${uU(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw GF.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw GF.create("token-unsubscribe-failed",{errorInfo:e})}}function uU({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function lU({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function hU({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==QF&&(i.web.applicationPubKey=r),i}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function dU(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ZF(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:XF(t.getKey("auth")),p256dh:XF(t.getKey("p256dh"))},r=await sU(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await lU(e),r=hU(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${uU(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw GF.create("token-update-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw GF.create("token-update-failed",{errorInfo:e})}if(!s.token)throw GF.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await oU(e.firebaseDependencies,r),n}catch(t){throw await fU(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await cU(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return pU(e.firebaseDependencies,n)}return pU(e.firebaseDependencies,n)}async function fU(e){const t=await sU(e.firebaseDependencies);t&&(await cU(e.firebaseDependencies,t.token),await async function(e){const t=aU(e),n=(await iU()).transaction(nU,"readwrite");await n.objectStore(nU).delete(t),await n.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function pU(e,t){const n={token:await async function(e,t){const n=await lU(e),r=hU(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(uU(e.appConfig),i);s=await t.json()}catch(e){throw GF.create("token-subscribe-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw GF.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw GF.create("token-subscribe-no-token");return s.token}(e,t),createTime:Date.now(),subscriptionOptions:t};return await oU(e,n),n.token}function gU(e){const t={from:e.from,collapseKey:e.collapse_key};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){if(!t.fcmOptions)return;e.fcmOptions={};const n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);const r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t,e),t}function mU(e){return GF.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yU{constructor(e,t,n){this.onBackgroundMessageHandler=null,this.onMessageHandler=null;const r=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){if(!e||!e.options)throw mU("App Configuration Object");if(!e.name)throw mU("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw mU(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function _U(e,t,n){const r=function(e){switch(e){case JF.NOTIFICATION_CLICKED:return"notification_open";case JF.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n["google.c.a.c_id"],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function vU(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===JF.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(gU(n)):e.onMessageHandler.next(gU(n)));const r=n.data;(function(e){return"object"==typeof e&&!!e&&YF in e})(r)&&"1"===r["google.c.a.e"]&&await _U(e,n.messageType,r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function wU(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch((()=>{}))}catch(e){throw GF.create("failed-service-worker-registration",{browserErrorMessage:e.message})}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function bU(e,t){if(!navigator)throw GF.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw GF.create("permission-blocked");return await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=QF)}(e,null==t?void 0:t.vapidKey),await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){if(t||e.swRegistration||await wU(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw GF.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),dU(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function TU(e){return async function(e){if(!navigator)throw GF.create("only-available-in-window");return e.swRegistration||await wU(e),fU(e)}(e=ba(e))}function IU(e,t){return function(e,t){if(!navigator)throw GF.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=ba(e),t)}$a(new Ta("messaging-exp",(e=>{(
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(){return await zo()&&"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})().then((e=>{if(!e)throw GF.create("unsupported-browser")})).catch((e=>{throw GF.create("indexed-db-unsupported")}));const t=new yU(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>vU(t,e))),t}),"PUBLIC"));
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const EU=new Qo("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const SU="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",kU="FCM_MSG";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
   * in compliance with the License. You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software distributed under the License
   * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
   * or implied. See the License for the specific language governing permissions and limitations under
   * the License.
   */
var CU;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function RU(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function AU(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(CU||(CU={}));const NU="fcm_token_details_db",PU="fcm_token_object_Store";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const xU="firebase-messaging-store";let DU=null;function OU(){return DU||(DU=bc("firebase-messaging-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(xU)}}))),DU}async function MU(e){const t=FU(e),n=await OU(),r=await n.transaction(xU).objectStore(xU).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB&&!(await indexedDB.databases()).map((e=>e.name)).includes(NU))return null;let t=null;return(await bc(NU,5,(async n=>{var r;if(n.oldVersion<2)return;if(!n.objectStoreNames.contains(PU))return;const i=n.transaction.objectStore(PU),s=await i.index("fcmSenderId").get(e);if(await i.clear(),s)if(2===n.oldVersion){const e=s;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(r=e.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:RU(e.vapidKey)}}}else if(3===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:RU(e.auth),p256dh:RU(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:RU(e.vapidKey)}}}else if(4===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:RU(e.auth),p256dh:RU(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:RU(e.vapidKey)}}}}))).close(),await Tc(NU),await Tc("fcm_vapid_details_db"),await Tc("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await LU(e,t),t}}async function LU(e,t){const n=FU(e),r=(await OU()).transaction(xU,"readwrite");return await r.objectStore(xU).put(t,n),await r.complete,t}function FU({appConfig:e}){return e.appId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function UU(e,t){const n={method:"DELETE",headers:await jU(e)};try{const r=await fetch(`${qU(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw EU.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw EU.create("token-unsubscribe-failed",{errorInfo:e})}}function qU({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function jU({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function VU({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==SU&&(i.web.applicationPubKey=r),i}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function BU(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:AU(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:RU(t.getKey("auth")),p256dh:RU(t.getKey("p256dh"))},r=await MU(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await jU(e),r=VU(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${qU(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw EU.create("token-update-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw EU.create("token-update-failed",{errorInfo:e})}if(!s.token)throw EU.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await LU(e.firebaseDependencies,r),n}catch(t){throw await $U(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await UU(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return WU(e.firebaseDependencies,n)}return WU(e.firebaseDependencies,n)}async function $U(e){const t=await MU(e.firebaseDependencies);t&&(await UU(e.firebaseDependencies,t.token),await async function(e){const t=FU(e),n=(await OU()).transaction(xU,"readwrite");await n.objectStore(xU).delete(t),await n.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function WU(e,t){const n={token:await async function(e,t){const n=await jU(e),r=VU(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(qU(e.appConfig),i);s=await t.json()}catch(e){throw EU.create("token-subscribe-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw EU.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw EU.create("token-subscribe-no-token");return s.token}(e,t),createTime:Date.now(),subscriptionOptions:t};return await LU(e,n),n.token}async function KU(e,t){const n=function({data:e}){if(!e)return null;try{return e.json()}catch(e){return null}}(e);if(!n)return;const r=await HU();if(function(e){return e.some((e=>"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")))}(r))return function(e,t){t.isFirebaseMessaging=!0,t.messageType=CU.PUSH_RECEIVED;for(const n of e)n.postMessage(t)}(r,n);if(n.notification&&await function(e){var t;const{actions:n}=e,{maxActions:r}=Notification;n&&r&&n.length>r&&console.warn(`This browser only supports ${r} actions. The remaining actions will not be displayed.`);return self.registration.showNotification(null!==(t=e.title)&&void 0!==t?t:"",e)}(function(e){const t=Object.assign({},e.notification);return t.data={[kU]:e},t}(n)),t&&t.onBackgroundMessageHandler){const e=function(e){const t={from:e.from,collapseKey:e.collapse_key};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i)}(t,e),function(e,t){t.data&&(e.data=t.data)}(t,e),function(e,t){if(!t.fcmOptions)return;e.fcmOptions={};const n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);const r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t,e),t}(n);"function"==typeof t.onBackgroundMessageHandler?t.onBackgroundMessageHandler(e):t.onBackgroundMessageHandler.next(e)}}async function zU(e){var t,n;const r=null===(n=null===(t=e.notification)||void 0===t?void 0:t.data)||void 0===n?void 0:n.FCM_MSG;if(!r)return;if(e.action)return;e.stopImmediatePropagation(),e.notification.close();const i=function(e){var t,n,r;const i=null!==(n=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==n?n:null===(r=e.notification)||void 0===r?void 0:r.click_action;if(i)return i;return function(e){return"object"==typeof e&&!!e&&"google.c.a.c_id"in e}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.data)?self.location.origin:null}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(r);if(!i)return;const s=new URL(i,self.location.href),o=new URL(self.location.origin);if(s.host!==o.host)return;let a=await async function(e){const t=await HU();for(const n of t){const t=new URL(n.url,self.location.href);if(e.host===t.host)return n}return null}(s);return a?a=await a.focus():(a=await self.clients.openWindow(i),await function(e){return new Promise((t=>{setTimeout(t,e)}))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(3e3)),a?(r.messageType=CU.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,a.postMessage(r)):void 0}function HU(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function GU(e){return EU.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QU{constructor(e,t,n){this.onBackgroundMessageHandler=null,this.onMessageHandler=null;const r=function(e){if(!e||!e.options)throw GU("App Configuration Object");if(!e.name)throw GU("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw GU(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function YU(e,t){
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return function(e,t){if(void 0!==self.document)throw EU.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,()=>{e.onBackgroundMessageHandler=null}}(e=ba(e),t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */$a(new Ta("messaging-sw-exp",(e=>{(
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(){return await zo()&&"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})().then((e=>{if(!e)throw EU.create("unsupported-browser")})).catch((e=>{throw EU.create("indexed-db-unsupported")}));const t=new QU(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",(e=>{e.waitUntil(KU(e,t))})),self.addEventListener("pushsubscriptionchange",(e=>{e.waitUntil(async function(e,t){var n,r;const{newSubscription:i}=e;if(!i)return void await $U(t);const s=await MU(t.firebaseDependencies);await $U(t),t.vapidKey=null!==(r=null===(n=null==s?void 0:s.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==r?r:SU,await BU(t)}(e,t))})),self.addEventListener("notificationclick",(e=>{e.waitUntil(zU(e))})),t}),"PUBLIC"));
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class JU{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return async function(e,t){return bU(e=ba(e),t)}(this._delegate,e)}async deleteToken(){return TU(this._delegate)}onMessage(e){return IU(this._delegate,e)}onBackgroundMessage(e){return YU(this._delegate,e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const XU=e=>navigator?new JU(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-exp").getImmediate()):new JU(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-sw-exp").getImmediate());
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var ZU;oc.INTERNAL.registerComponent(new Ta("messaging-compat",XU,"PUBLIC")),oc.registerVersion("@firebase/messaging-compat","0.0.900-exp.6ef484a04"),function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(ZU||(ZU={}));
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const eq="firebasestorage.googleapis.com";class tq extends Go{constructor(e,t){super(nq(e),`Firebase Storage: ${t} (${nq(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,tq.prototype)}_codeEquals(e){return nq(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function nq(e){return"storage/"+e}function rq(){return new tq("unknown","An unknown error occurred, please check the error payload for server response.")}function iq(){return new tq("canceled","User canceled the upload/download.")}function sq(){return new tq("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function oq(e){return new tq("invalid-argument",e)}function aq(){return new tq("app-deleted","The Firebase app was deleted.")}function cq(e,t){return new tq("invalid-format","String does not match format '"+e+"': "+t)}function uq(e){throw new tq("internal-error","Internal error: "+e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lq{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=ZU.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=ZU.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=ZU.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw uq("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw uq("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw uq("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponseText(){if(!this.sent_)throw uq("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class hq{createConnection(){return new lq}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class dq{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=dq.makeFromUrl(e,t)}catch(t){return new dq(e,"")}if(""===n.path)return n;throw new tq("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===eq?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<a.length;t++){const r=a[t],i=r.regex.exec(e);if(i){const e=i[r.indices.bucket];let t=i[r.indices.path];t||(t=""),n=new dq(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new tq("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class fq{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function pq(e){return"string"==typeof e||e instanceof String}function gq(e){return mq()&&e instanceof Blob}function mq(){return"undefined"!=typeof Blob}function yq(e,t,n,r){if(r<t)throw oq(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw oq(`Invalid value for '${e}'. Expected ${n} or less.`)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function _q(e,t){const n=t.match(/^(\w+):\/\/.+/);let r=t;return null==(null==n?void 0:n[1])&&(r=`https://${t}`),`${r}/v0${e}`}function vq(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wq{constructor(e,t,n,r,i,s,o,a,c,u,l){this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=this;function t(t,n){const r=e.resolve_,i=e.reject_,s=n.connection;if(n.wasSuccessCode)try{const t=e.callback_(s,s.getResponseText());!
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){return void 0!==e}(t)?r():r(t)}catch(e){i(e)}else if(null!==s){const t=rq();t.serverResponse=s.getResponseText(),e.errorCallback_?i(e.errorCallback_(s,t)):i(t)}else if(n.canceled){i(e.appDelete_?aq():iq())}else{i(new tq("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}}this.canceled_?t(0,new bq(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=!1,o=0;function a(){return 2===o}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function l(t){i=setTimeout((()=>{i=null,e(h,a())}),t)}function h(e,...t){if(c)return;if(e)return void u.call(null,e,...t);if(a()||s)return void u.call(null,e,...t);let n;r<64&&(r*=2),1===o?(o=2,n=0):n=1e3*(r+Math.random()),l(n)}let d=!1;function f(e){d||(d=!0,c||(null!==i?(e||(o=2),clearTimeout(i),l(0)):e||(o=1)))}return l(0),setTimeout((()=>{s=!0,f(!0)}),n),f}((function(t,n){if(n)return void t(!1,new bq(!1,null,!0));const r=e.pool_.createConnection();function i(t){const n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)}e.pendingConnection_=r,null!==e.progressCallback_&&r.addUploadProgressListener(i),r.send(e.url_,e.method_,e.body_,e.headers_).then((()=>{null!==e.progressCallback_&&r.removeUploadProgressListener(i),e.pendingConnection_=null;const n=r.getErrorCode()===ZU.NO_ERROR,s=r.getStatus();if(!n||e.isRetryStatusCode_(s)){const e=r.getErrorCode()===ZU.ABORT;return void t(!1,new bq(!1,null,e))}const o=-1!==e.successCodes_.indexOf(s);t(!0,new bq(o,r))}))}),t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class bq{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Tq(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Iq(...e){const t=Tq();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(mq())return new Blob(e);throw new tq("unsupported-environment","This browser doesn't seem to support creating Blobs")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Eq="raw",Sq="base64",kq="base64url",Cq="data_url";class Rq{constructor(e,t){this.data=e,this.contentType=t||null}}function Aq(e,t){switch(e){case Eq:return new Rq(Nq(t));case Sq:case kq:return new Rq(Pq(e,t));case Cq:return new Rq(function(e){const t=new xq(e);return t.base64?Pq(Sq,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw cq(Cq,"Malformed data URL.")}return Nq(t)}(t.rest)}(t),new xq(t).contentType)}throw rq()}function Nq(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Pq(e,t){switch(e){case Sq:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw cq(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case kq:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw cq(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw cq(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class xq{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw cq(Cq,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}class Dq{constructor(e,t){let n=0,r="";gq(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(gq(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.data_,e,t);return null===n?null:new Dq(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Dq(n,!0)}}static getBlob(...e){if(mq()){const t=e.map((e=>e instanceof Dq?e.data_:e));return new Dq(Iq.apply(null,t))}{const t=e.map((e=>pq(e)?Aq(Eq,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new Dq(r,!0)}}uploadData(){return this.data_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Oq(e){let t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Mq(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Lq(e,t){return t}class Fq{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||Lq}}let Uq=null;function qq(){if(Uq)return Uq;const e=[];e.push(new Fq("bucket")),e.push(new Fq("generation")),e.push(new Fq("metageneration")),e.push(new Fq("name","fullPath",!0));const t=new Fq("name");t.xform=function(e,t){return function(e){return!pq(e)||e.length<2?e:Mq(e)}(t)},e.push(t);const n=new Fq("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Fq("timeCreated")),e.push(new Fq("updated")),e.push(new Fq("md5Hash",null,!0)),e.push(new Fq("cacheControl",null,!0)),e.push(new Fq("contentDisposition",null,!0)),e.push(new Fq("contentEncoding",null,!0)),e.push(new Fq("contentLanguage",null,!0)),e.push(new Fq("contentType",null,!0)),e.push(new Fq("metadata","customMetadata",!0)),Uq=e,Uq}function jq(e,t,n){const r={type:"file"},i=n.length;for(let e=0;e<i;e++){const i=n[e];r[i.local]=i.xform(r,t[i.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new dq(n,r);return t._makeStorageReference(i)}})}(r,e),r}function Vq(e,t,n){const r=Oq(t);if(null===r)return null;return jq(e,r,n)}function Bq(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function $q(e,t,n){const r=Oq(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(const i of n.prefixes){const n=i.replace(/\/$/,""),s=e._makeStorageReference(new dq(t,n));r.prefixes.push(s)}if(n.items)for(const i of n.items){const n=e._makeStorageReference(new dq(t,i.name));r.items.push(n)}return r}(e,t,r)}class Wq{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Kq(e){if(!e)throw rq()}function zq(e,t){return function(n,r){const i=Vq(e,r,t);return Kq(null!==i),i}}function Hq(e,t){return function(n,r){const i=Vq(e,r,t);return Kq(null!==i),function(e,t,n){const r=Oq(t);if(null===r)return null;if(!pq(r.downloadTokens))return null;const i=r.downloadTokens;if(0===i.length)return null;const s=encodeURIComponent;return i.split(",").map((t=>{const r=e.bucket,i=e.fullPath;return _q("/b/"+s(r)+"/o/"+s(i),n)+vq({alt:"media",token:t})}))[0]}(i,r,e.host)}}function Gq(e){return function(t,n){let r;var i;return 401===t.getStatus()?r=t.getResponseText().includes("Firebase App Check token is invalid")?new tq("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new tq("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new tq("quota-exceeded","Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):r=403===t.getStatus()?function(e){return new tq("unauthorized","User does not have permission to access '"+e+"'.")}(e.path):n,r.serverResponse=n.serverResponse,r}}function Qq(e){const t=Gq(e);return function(n,r){let i=t(n,r);return 404===n.getStatus()&&(i=function(e){return new tq("object-not-found","Object '"+e+"' does not exist.")}(e.path)),i.serverResponse=r.serverResponse,i}}function Yq(e,t,n){const r=_q(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,s=new Wq(r,"GET",zq(e,n),i);return s.errorHandler=Qq(t),s}function Jq(e,t,n,r,i){const s={};t.isRoot?s.prefix="":s.prefix=t.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=_q(t.bucketOnlyServerUrl(),e.host),a=e.maxOperationRetryTime,c=new Wq(o,"GET",function(e,t){return function(n,r){const i=$q(e,t,r);return Kq(null!==i),i}}(e,t.bucket),a);return c.urlParams=s,c.errorHandler=Gq(t),c}function Xq(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}class Zq{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function ej(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){Kq(!1)}return Kq(!!n&&-1!==(t||["active"]).indexOf(n)),n}const tj=262144;function nj(e,t,n,r,i,s,o,a){const c=new Zq(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new tq("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");const u=c.total-c.current;let l=u;i>0&&(l=Math.min(l,i));const h=c.current,d=h+l,f={"X-Goog-Upload-Command":l===u?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},p=r.slice(h,d);if(null===p)throw sq();const g=t.maxUploadRetryTime,m=new Wq(n,"POST",(function(e,n){const i=ej(e,["active","final"]),o=c.current+l,a=r.size();let u;return u="final"===i?zq(t,s)(e,n):null,new Zq(o,a,"final"===i,u)}),g);return m.headers=f,m.body=p.uploadData(),m.progressCallback=a||null,m.errorHandler=Gq(e),m}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const rj="running",ij="paused",sj="success",oj="canceled",aj="error";function cj(e){switch(e){case"running":case"pausing":case"canceling":return rj;case"paused":return ij;case"success":return sj;case"canceled":return oj;case"error":default:return aj}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uj{constructor(e,t,n){if(function(e){return"function"==typeof e}(e)||null!=t||null!=n)this.next=e,this.error=t,this.complete=n;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function lj(e){return(...t)=>{Promise.resolve().then((()=>e(...t)))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hj{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=qq(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{this._request=void 0,this._chunkMultiplier=1,e._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=e,this._transition("error"))},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals("canceled")?this.completeTransitions_():(this._error=e,this._transition("error"))},this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o=Xq(t,r,i),a={name:o.fullPath},c=_q(s,e.host),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=Bq(o,n),h=e.maxUploadRetryTime,d=new Wq(c,"POST",(function(e){let t;ej(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){Kq(!1)}return Kq(pq(t)),t}),h);return d.urlParams=a,d.headers=u,d.body=l,d.errorHandler=Gq(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=e.maxUploadRetryTime,s=new Wq(n,"POST",(function(e){const t=ej(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){Kq(!1)}n||Kq(!1);const i=Number(n);return Kq(!isNaN(i)),new Zq(i,r.size(),"final"===t)}),i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=Gq(t),s}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,t,n);this._request=i,i.getPromise().then((e=>{e=e,this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=tj*this._chunkMultiplier,t=new Zq(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let s;try{s=nj(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const o=this._ref.storage._makeRequest(s,r,i);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){tj*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=Yq(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=Xq(t,r,i),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Bq(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=Dq.getBlob(u,r,l);if(null===h)throw sq();const d={name:c.fullPath},f=_q(s,e.host),p=e.maxUploadRetryTime,g=new Wq(f,"POST",zq(e,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=Gq(t),g}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=iq(),this._state=e,this._notifyObservers();break;case"error":case"success":this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=cj(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new uj(t,n,r);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(cj(this._state)){case sj:lj(this._resolve.bind(null,this.snapshot))();break;case oj:case aj:lj(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(cj(this._state)){case rj:case ij:e.next&&lj(e.next.bind(e,this.snapshot))();break;case sj:e.complete&&lj(e.complete.bind(e))();break;case oj:case aj:e.error&&lj(e.error.bind(e,this._error))();break;default:e.error&&lj(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class dj{constructor(e,t){this._service=e,this._location=t instanceof dq?t:dq.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new dj(e,t)}get root(){const e=new dq(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Mq(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new dq(this._location.bucket,e);return new dj(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new tq("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function fj(e){const t={prefixes:[],items:[]};return pj(e,t).then((()=>t))}async function pj(e,t,n){const r={pageToken:n},i=await gj(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await pj(e,t,i.nextPageToken)}async function gj(e,t){null!=t&&"number"==typeof t.maxResults&&yq("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=Jq(e.storage,e._location,"/",n.pageToken,n.maxResults);return(await e.storage.makeRequestWithTokens(r)).getPromise()}async function mj(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=_q(t.fullServerUrl(),e.host),s=Bq(n,r),o=e.maxOperationRetryTime,a=new Wq(i,"PATCH",zq(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=Qq(t),a}(e.storage,e._location,t,qq());return(await e.storage.makeRequestWithTokens(n)).getPromise()}async function yj(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=_q(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,s=new Wq(r,"GET",Hq(e,n),i);return s.errorHandler=Qq(t),s}(e.storage,e._location,qq());return(await e.storage.makeRequestWithTokens(t)).getPromise().then((e=>{if(null===e)throw new tq("no-download-url","The given file does not have any download URLs.");return e}))}async function _j(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=_q(t.fullServerUrl(),e.host),r=e.maxOperationRetryTime,i=new Wq(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=Qq(t),i}(e.storage,e._location);return(await e.storage.makeRequestWithTokens(t)).getPromise()}function vj(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new dq(e._location.bucket,n);return new dj(e.storage,r)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function wj(e,t){if(e instanceof Ij){const n=e;if(null==n._bucket)throw new tq("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");const r=new dj(n,n._bucket);return null!=t?wj(r,t):r}if(void 0!==t){if(t.includes(".."))throw oq('`path` param cannot contain ".."');return vj(e,t)}return e}function bj(e,t){if(t&&function(e){return/^[A-Za-z]+:\/\//.test(e)}(t)){if(e instanceof Ij)return new dj(e,t);throw oq("To use ref(service, url), the first argument must be a Storage instance.")}return wj(e,t)}function Tj(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:dq.makeFromBucketSpec(n,e)}class Ij{constructor(e,t,n,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=eq,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?dq.makeFromBucketSpec(i,this._host):Tj(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=dq.makeFromBucketSpec(this._url,e):this._bucket=Tj(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yq("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yq("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear(),Promise.resolve()}_makeStorageReference(e){return new dj(this,e)}_makeRequest(e,t,n){if(this._deleted)return new fq(aq());{const r=function(e,t,n,r,i,s){const o=vq(e.urlParams),a=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new wq(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i)}(e,this._appId,t,n,this._pool,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((()=>this._requests.delete(r)),(()=>this._requests.delete(r))),r}}async makeRequestWithTokens(e){const[t,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n)}}function Ej(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new hj(e,new Dq(t),n)}(e=ba(e),t,n)}function Sj(e){return async function(e){e._throwIfRoot("getMetadata");const t=Yq(e.storage,e._location,qq());return(await e.storage.makeRequestWithTokens(t)).getPromise()}(e=ba(e))}function kj(e,t){return bj(e=ba(e),t)}function Cj(e,{instanceIdentifier:t}){const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new Ij(n,r,i,new hq,t,Ha)}$a(new Ta("storage-exp",Cj,"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/storage","0.0.900-exp.6ef484a04");class Rj extends Go{constructor(e,t){super(Aj(e),`Firebase Storage: ${t} (${Aj(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rj.prototype)}_codeEquals(e){return Aj(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function Aj(e){return"storage/"+e}function Nj(e){return new Rj("invalid-argument",e)}function Pj(e,t){return new Rj("invalid-format","String does not match format '"+e+"': "+t)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const xj={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Dj{constructor(e,t){this.data=e,this.contentType=t||null}}function Oj(e,t){switch(e){case xj.RAW:return new Dj(Mj(t));case xj.BASE64:case xj.BASE64URL:return new Dj(Lj(e,t));case xj.DATA_URL:return new Dj(function(e){const t=new Fj(e);return t.base64?Lj(xj.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw Pj(xj.DATA_URL,"Malformed data URL.")}return Mj(t)}(t.rest)}(t),new Fj(t).contentType)}throw new Rj("unknown","An unknown error occurred, please check the error payload for server response.")}function Mj(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Lj(e,t){switch(e){case xj.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw Pj(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case xj.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw Pj(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw Pj(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class Fj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Pj(xj.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}const Uj={STATE_CHANGED:"state_changed"},qj={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class jj{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Vj{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new jj(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new jj(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"==typeof t?e=>t(new jj(e,this,this._ref)):{next:t.next?e=>t.next(new jj(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Bj{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new $j(e,this._service)))}get items(){return this._delegate.items.map((e=>new $j(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *  http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $j{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function(e,t){return vj(e,t)}(this._delegate,e);return new $j(t,this.storage)}get root(){return new $j(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new $j(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new Vj(Ej(this._delegate,e,t),this)}putString(e,t=Eq,n){this._throwIfRoot("putString");const r=Oj(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new Vj(new hj(this._delegate,new Dq(r.data,!0),i),this)}listAll(){return function(e){return fj(e=ba(e))}(this._delegate).then((e=>new Bj(e,this.storage)))}list(e){return function(e,t){return gj(e=ba(e),t)}(this._delegate,e||void 0).then((e=>new Bj(e,this.storage)))}getMetadata(){return Sj(this._delegate)}updateMetadata(e){return function(e,t){return mj(e=ba(e),t)}(this._delegate,e)}getDownloadURL(){return function(e){return yj(e=ba(e))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function(e){return _j(e=ba(e))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw function(e){return new Rj("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Wj(e){return/^[A-Za-z]+:\/\//.test(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Kj{constructor(e,t){this.app=e,this._delegate=t,this.INTERNAL={delete:()=>this._delegate._delete()}}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Wj(e))throw Nj("ref() expected a child path but got a URL, use refFromURL instead.");return new $j(kj(this._delegate,e),this)}refFromURL(e){if(!Wj(e))throw Nj("refFromURL() expected a full URL but got a child path, use ref() instead.");try{dq.makeFromUrl(e,this._delegate.host)}catch(e){throw Nj("refFromUrl() expected a valid full URL but got an invalid one.")}return new $j(kj(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t){!function(e,t,n){e.host=`http://${t}:${n}`}(this._delegate,e,t)}}function zj(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage-exp").getImmediate({identifier:t});return new Kj(n,r)}!function(e){const t={TaskState:qj,TaskEvent:Uj,StringFormat:xj,Storage:Kj,Reference:$j};e.INTERNAL.registerComponent(new Ta("storage",zj,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.0.900-exp.6ef484a04")}(oc);const Hj="0.0.900-exp.6ef484a04",Gj=Hj,Qj="FB-PERF-TRACE-MEASURE",Yj="_wt_",Jj="_fcp",Xj="_fid",Zj="@firebase/performance/config",eV="@firebase/performance/configexpire",tV="Performance",nV=new Qo("performance",tV,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"Performance can only be initialized once."}),rV=new Da(tV);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let iV,sV,oV,aV;rV.logLevel=ka.INFO;class cV{constructor(e){if(this.window=e,!e)throw nV.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Ko()||(rV.info("IndexedDB is not supported by current browswer"),!1):(rV.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver((e=>{for(const n of e.getEntries())t(n)})).observe({entryTypes:[e]})}static getInstance(){return void 0===iV&&(iV=new cV(sV)),iV}}function uV(){return oV}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function lV(e,t){const n=e.length-t.length;if(n<0||n>1)throw nV.create("invalid String merger input");const r=[];for(let n=0;n<e.length;n++)r.push(e.charAt(n)),t.length>n&&r.push(t.charAt(n));return r.join("")}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hV{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=lV("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=lV("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===aV&&(aV=new hV),aV}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var dV;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(dV||(dV={}));const fV=["firebase_","google_","ga_"],pV=new RegExp("^[a-zA-Z]\\w*$");function gV(){const e=cV.getInstance().navigator;return"serviceWorker"in e?e.serviceWorker.controller?2:3:1}function mV(){switch(cV.getInstance().document.visibilityState){case"visible":return dV.VISIBLE;case"hidden":return dV.HIDDEN;default:return dV.UNKNOWN}}function yV(){const e=cV.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function _V(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.appId;if(!n)throw nV.create("no app id");return n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const vV="0.0.1",wV=!0,bV="FIREBASE_INSTALLATIONS_AUTH";function TV(e,t){const n=function(){const e=cV.getInstance().localStorage;if(!e)return;const t=e.getItem(eV);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;const r=e.getItem(Zj);if(!r)return;try{return JSON.parse(r)}catch(e){return}}();return n?(EV(n),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then((e=>{})),t}(e.installations).then((n=>{const r=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!n)throw nV.create("no project id");return n}(e.app),i=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!n)throw nV.create("no api key");return n}(e.app),s=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${i}`,{method:"POST",headers:{Authorization:`${bV} ${n}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:n,app_id:_V(e.app),app_version:Gj,sdk_version:vV})});return fetch(s).then((e=>{if(e.ok)return e.json();throw nV.create("RC response not ok")}))})).catch((()=>{rV.info(IV)}))}(e,t).then(EV).then((e=>function(e){const t=cV.getInstance().localStorage;if(!e||!t)return;t.setItem(Zj,JSON.stringify(e)),t.setItem(eV,String(Date.now()+60*hV.getInstance().configTimeToLive*60*1e3))}(e)),(()=>{}))}const IV="Could not fetch config, will use default configs";function EV(e){if(!e)return e;const t=hV.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=wV,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=SV(t.tracesSamplingRate),t.logNetworkAfterSampling=SV(t.networkRequestsSamplingRate),e}function SV(e){return Math.random()<=e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let kV,CV=1;function RV(e){return CV=2,kV=kV||function(e){return function(){const e=cV.getInstance().document;return new Promise((t=>{if(e&&"complete"!==e.readyState){const n=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()}))}().then((()=>function(e){const t=e.getId();return t.then((e=>{oV=e})),t}(e.installations))).then((t=>TV(e,t))).then((()=>AV()),(()=>AV()))}(e),kV}function AV(){CV=3}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const NV=1e4;let PV,xV=3,DV=[],OV=!1;function MV(e){setTimeout((()=>{if(0!==xV)return DV.length?void function(){const e=DV.splice(0,1e3),t=e.map((e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)})));(function(e,t){return function(e){const t=hV.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then((e=>(e.ok||rV.info("Call to Firebase backend failed."),e.json()))).then((e=>{const n=Number(e.nextRequestWaitMillis);let r=NV;isNaN(n)||(r=Math.max(n,r));const i=e.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(DV=[...t,...DV],rV.info("Retry transport request later.")),xV=3,MV(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:hV.getInstance().logSource,log_event:t},e).catch((()=>{DV=[...e,...DV],xV--,rV.info(`Tries left: ${xV}.`),MV(NV)}))}():MV(NV)}),e)}function LV(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw nV.create("invalid cc log");DV=[...DV,e]}({message:e(...t),eventTime:Date.now()})}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function FV(e,t){PV||(PV=LV(jV)),PV(e,t)}function UV(e){const t=hV.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&cV.getInstance().requiredApisAvailable()&&(e.isAuto&&mV()!==dV.VISIBLE||(3===CV?qV(e):RV(e.performanceController).then((()=>qV(e)),(()=>qV(e)))))}function qV(e){if(!uV())return;const t=hV.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&setTimeout((()=>FV(e,1)),0)}function jV(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:VV(e.performanceController.app),network_request_metric:t};return JSON.stringify(n)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);const r={application_info:VV(e.performanceController.app),trace_metric:t};return JSON.stringify(r)}(e)}function VV(e){return{google_app_id:_V(e),app_instance_id:uV(),web_app_info:{sdk_version:Gj,page_url:cV.getInstance().getUrl(),service_worker_status:gV(),visibility_state:mV(),effective_connection_type:yV()},application_process_state:0}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const BV=["_fp",Jj,Xj];
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class $V{constructor(e,t,n=!1,r){this.performanceController=e,this.name=t,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=cV.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`FB-PERF-TRACE-MEASURE-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw nV.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw nV.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),UV(this)}record(e,t,n){if(e<=0)throw nV.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw nV.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const e of Object.keys(n.metrics))isNaN(Number(n.metrics[e]))||(this.counters[e]=Number(Math.floor(n.metrics[e])));UV(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(!function(e,t){return!(0===e.length||e.length>100)&&(t&&t.startsWith(Yj)&&BV.indexOf(e)>-1||!e.startsWith("_"))}(e,this.name))throw nV.create("invalid custom metric name",{customMetricName:e});this.counters[e]=function(e){const t=Math.floor(e);return t<e&&rV.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(t)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const n=function(e){return!(0===e.length||e.length>40)&&(!fV.some((t=>e.startsWith(t)))&&!!e.match(pV))}(e),r=function(e){return 0!==e.length&&e.length<=100}(t);if(n&&r)this.customAttributes[e]=t;else{if(!n)throw nV.create("invalid attribute name",{attributeName:e});if(!r)throw nV.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n,r){const i=cV.getInstance().getUrl();if(!i)return;const s=new $V(e,Yj+i,!0),o=Math.floor(1e3*cV.getInstance().getTimeOrigin());s.setStartTime(o),t&&t[0]&&(s.setDuration(Math.floor(1e3*t[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(n){const e=n.find((e=>"first-paint"===e.name));e&&e.startTime&&s.putMetric("_fp",Math.floor(1e3*e.startTime));const t=n.find((e=>"first-contentful-paint"===e.name));t&&t.startTime&&s.putMetric(Jj,Math.floor(1e3*t.startTime)),r&&s.putMetric(Xj,Math.floor(1e3*r))}UV(s)}static createUserTimingTrace(e,t){UV(new $V(e,t,!1,t))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function WV(e,t){const n=t;if(!n||void 0===n.responseStart)return;const r=cV.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(e){const t=hV.getInstance();if(!t.instrumentationEnabled)return;const n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout((()=>FV(e,0)),0)}({performanceController:e,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function KV(e){uV()&&(setTimeout((()=>function(e){const t=cV.getInstance(),n=t.getEntriesByType("navigation"),r=t.getEntriesByType("paint");if(t.onFirstInputDelay){let i=setTimeout((()=>{$V.createOobTrace(e,n,r),i=void 0}),5e3);t.onFirstInputDelay((t=>{i&&(clearTimeout(i),$V.createOobTrace(e,n,r,t))}))}else $V.createOobTrace(e,n,r)}(e)),0),setTimeout((()=>function(e){const t=cV.getInstance(),n=t.getEntriesByType("resource");for(const t of n)WV(e,t);t.setupObserver("resource",(t=>WV(e,t)))}(e)),0),setTimeout((()=>function(e){const t=cV.getInstance(),n=t.getEntriesByType("measure");for(const t of n)zV(e,t);t.setupObserver("measure",(t=>zV(e,t)))}(e)),0))}function zV(e,t){const n=t.name;n.substring(0,Qj.length)!==Qj&&$V.createUserTimingTrace(e,n)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class HV{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),cV.getInstance().requiredApisAvailable()?zo().then((e=>{e&&(OV||(MV(5500),OV=!0),RV(this).then((()=>KV(this)),(()=>KV(this))),this.initialized=!0)})).catch((e=>{rV.info(`Environment doesn't support IndexedDB: ${e}`)})):rV.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){hV.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return hV.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){hV.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return hV.getInstance().dataCollectionEnabled}}$a(new Ta("performance-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("installations-exp-internal").getImmediate();if("[DEFAULT]"!==n.name)throw nV.create("FB not default");if("undefined"==typeof window)throw nV.create("no window");!function(e){sV=e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(window);const i=new HV(n,r);return i._init(t),i}),"PUBLIC")),Ja("@firebase/performance-exp",Hj);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class GV{constructor(e,t){this.app=e,this._delegate=t}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return function(e,t){return e=ba(e),new $V(e,t)}(this._delegate,e)}}function QV(e){const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("performance-exp").getImmediate();return new GV(t,n)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var YV;(YV=oc).INTERNAL.registerComponent(new Ta("performance-compat",QV,"PUBLIC")),YV.registerVersion("@firebase/performance-compat","0.0.900-exp.6ef484a04");const JV="@firebase/remote-config-exp";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class XV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ZV=new Qo("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const eB=["1","true","t","yes","y","on"];class tB{constructor(e,t=""){this._source=e,this._value=t}asString(){return this._value}asBoolean(){return"static"!==this._source&&eB.indexOf(this._value.toLowerCase())>=0}asNumber(){if("static"===this._source)return 0;let e=Number(this._value);return isNaN(e)&&(e=0),e}getSource(){return this._source}}async function nB(e){const t=ba(e),[n,r]=await Promise.all([t._storage.getLastSuccessfulFetchResponse(),t._storage.getActiveConfigEtag()]);return!!(n&&n.config&&n.eTag&&n.eTag!==r)&&(await Promise.all([t._storageCache.setActiveConfig(n.config),t._storage.setActiveConfigEtag(n.eTag)]),!0)}function rB(e){const t=ba(e);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then((()=>{t._isInitializationComplete=!0}))),t._initializePromise}async function iB(e){const t=ba(e),n=new XV;setTimeout((async()=>{n.abort()}),t.settings.fetchTimeoutMillis);try{await t._client.fetch({cacheMaxAgeMillis:t.settings.minimumFetchIntervalMillis,signal:n}),await t._storageCache.setLastFetchStatus("success")}catch(e){const n=function(e,t){return e instanceof Go&&-1!==e.code.indexOf(t)}(e,"fetch-throttle")?"throttle":"failure";throw await t._storageCache.setLastFetchStatus(n),e}}function sB(e){const t=ba(e);return function(e={},t={}){return Object.keys(Object.assign(Object.assign({},e),t))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t._storageCache.getActiveConfig(),t.defaultConfig).reduce(((t,n)=>(t[n]=oB(e,n),t)),{})}function oB(e,t){const n=ba(e);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${t}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&void 0!==r[t]?new tB("remote",r[t]):n.defaultConfig&&void 0!==n.defaultConfig[t]?new tB("default",String(n.defaultConfig[t])):(n._logger.debug(`Returning static value for key "${t}". Define a default or remote value if this is unintentional.`),new tB("static"))}class aB{constructor(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,r=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[t,n]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(n&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return n;e.eTag=n&&n.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===r.status&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function cB(e=navigator){return e.languages&&e.languages[0]||e.language}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uB{constructor(e,t,n,r,i,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}async fetch(e){const[t,n]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),r=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,i={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:n,app_id:this.appId,language_code:cB()},o={method:"POST",headers:i,body:JSON.stringify(s)},a=fetch(r,o),c=new Promise(((t,n)=>{e.signal.addEventListener((()=>{const e=new Error("The operation was aborted.");e.name="AbortError",n(e)}))}));let u;try{await Promise.race([a,c]),u=await a}catch(e){let t="fetch-client-network";throw"AbortError"===e.name&&(t="fetch-timeout"),ZV.create(t,{originalErrorMessage:e.message})}let l=u.status;const h=u.headers.get("ETag")||void 0;let d,f;if(200===u.status){let e;try{e=await u.json()}catch(e){throw ZV.create("fetch-client-parse",{originalErrorMessage:e.message})}d=e.entries,f=e.state}if("INSTANCE_STATE_UNSPECIFIED"===f?l=500:"NO_CHANGE"===f?l=304:"NO_TEMPLATE"!==f&&"EMPTY_CONFIG"!==f||(d={}),304!==l&&200!==l)throw ZV.create("fetch-status",{httpStatus:l});return{status:l,eTag:h,config:d}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lB{constructor(e,t){this.client=e,this.storage=t}async fetch(e){const t=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)}async attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(ZV.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(e.signal,t);try{const t=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),t}catch(t){if(!function(e){if(!(e instanceof Go&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t))throw t;const r={throttleEndTimeMillis:Date.now()+wa(n),backoffCount:n+1};return await this.storage.setThrottleMetadata(r),this.attemptFetch(e,r)}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hB{constructor(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function dB(e,t){const n=e.target.error||void 0;return ZV.create(t,{originalErrorMessage:n&&n.message})}const fB="app_namespace_store";class pB{constructor(e,t,n,r=function(){return new Promise(((e,t)=>{const n=indexedDB.open("firebase_remote_config",1);n.onerror=e=>{t(dB(e,"storage-open"))},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{const t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(fB,{keyPath:"compositeKey"})}}}))}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([fB],"readonly").objectStore(fB),s=this.createCompositeKey(e);try{const e=i.get(s);e.onerror=e=>{r(dB(e,"storage-get"))},e.onsuccess=e=>{const t=e.target.result;n(t?t.value:void 0)}}catch(e){r(ZV.create("storage-get",{originalErrorMessage:e&&e.message}))}}))}async set(e,t){const n=await this.openDbPromise;return new Promise(((r,i)=>{const s=n.transaction([fB],"readwrite").objectStore(fB),o=this.createCompositeKey(e);try{const e=s.put({compositeKey:o,value:t});e.onerror=e=>{i(dB(e,"storage-set"))},e.onsuccess=()=>{r()}}catch(e){i(ZV.create("storage-set",{originalErrorMessage:e&&e.message}))}}))}async delete(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([fB],"readwrite").objectStore(fB),s=this.createCompositeKey(e);try{const e=i.delete(s);e.onerror=e=>{r(dB(e,"storage-delete"))},e.onsuccess=()=>{n()}}catch(e){r(ZV.create("storage-delete",{originalErrorMessage:e&&e.message}))}}))}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class gB{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await t;i&&(this.lastSuccessfulFetchTimestampMillis=i);const s=await n;s&&(this.activeConfig=s)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */$a(new Ta("remote-config-exp",(function(e,{instanceIdentifier:t}){const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("installations-exp-internal").getImmediate();if("undefined"==typeof window)throw ZV.create("registration-window");const{projectId:i,apiKey:s,appId:o}=n.options;if(!i)throw ZV.create("registration-project-id");if(!s)throw ZV.create("registration-api-key");if(!o)throw ZV.create("registration-app-id");t=t||"firebase";const a=new pB(o,n.name,t),c=new gB(a),u=new Da(JV);u.logLevel=ka.ERROR;const l=new uB(r,Ha,t,i,s,o),h=new lB(l,a),d=new aB(h,a,c,u),f=new hB(n,d,c,a,u);return rB(f),f}),"PUBLIC").setMultipleInstances(!0)),Ja(JV,"0.0.900-exp.6ef484a04");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class mB{constructor(e,t){this.app=e,this._delegate=t}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return nB(this._delegate)}ensureInitialized(){return rB(this._delegate)}fetch(){return iB(this._delegate)}fetchAndActivate(){
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e){return e=ba(e),await iB(e),nB(e)}(this._delegate)}getAll(){return sB(this._delegate)}getBoolean(e){return function(e,t){return oB(ba(e),t).asBoolean()}(this._delegate,e)}getNumber(e){return function(e,t){return oB(ba(e),t).asNumber()}(this._delegate,e)}getString(e){return function(e,t){return oB(ba(e),t).asString()}(this._delegate,e)}getValue(e){return oB(this._delegate,e)}setLogLevel(e){!function(e,t){const n=ba(e);switch(t){case"debug":n._logger.logLevel=ka.DEBUG;break;case"silent":n._logger.logLevel=ka.SILENT;break;default:n._logger.logLevel=ka.ERROR}}(this._delegate,e)}}function yB(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("remote-config-exp").getImmediate({identifier:t});return new mB(n,r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return function(e){e.INTERNAL.registerComponent(new Ta("remoteConfig-compat",yB,"PUBLIC").setMultipleInstances(!0)),e.registerVersion("@firebase/remote-config-compat","0.0.900-exp.6ef484a04")}(oc),
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),oc.registerVersion("firebase-exp","9.0.0-beta.7","compat-cdn"),oc}));
